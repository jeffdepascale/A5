//A5, Copyright (c) 2012, Jeff dePascale http://www.a5js.com(function(a){var d=null,g=null,c=function(n,k,p){var s,q,o,m;if(!n){return null}p=p||false;if(typeof n==="object"){return n}s=n.split(".");m=a;if(s.length===1&&k&&k[n]){return k[n]}for(q=0,o=s.length;q<o;q++){m=m[s[q]];if(m===undefined){if(g){try{var t=g(n,k);if(t){return t}}catch(r){return null}}else{return null}}}if(p||m.namespace!==undefined){return m}return null},b=function(m,q,p){var s=typeof q==="boolean",o=s?q:false,r,k=(s?p:q)||{},r=m.split("."),t=r.pop(),n;if(!m.match(/^[A-Za-z0-9.]*$/)){return j.ThrowError(100,null,{namespace:m})}n=r.length?f(r):a;if(n[t]!==undefined){return n[t]}return n[t]=o?new k():k},f=function(o){var n=a,m,k;for(m=0,k=o.length;m<k;m++){if(!n[o[m]]){n[o[m]]={}}n=n[o[m]]}return n},e=function(){d={};for(var k in a){d[k]=""}},h=function(k){if(!d){j.ThrowError(101)}else{var n=[],m;for(m in a){if(d[m]===undefined){n.push(m)}}if(k===true){e()}return n}};var j=a.a5={version:function(){return"0.5.{BUILD_NUMBER}"},buildDate:function(){return"{BUILD_DATE}"},GetNamespace:c,SetNamespace:b,TrackGlobalStrays:e,GetGlobalStrays:h,_a5_destroyedObj:{},_a5_destroyedObjFunc:function(){var k=arguments.callee.caller,m="Destroyed method called from";if(k._a5_methodName!==undefined){throw m+" method '"+k.getName()+"' in class '"+k.getClass().className()+"'"}else{throw m+" function '"+k.toString()+"'"}},_a5_classCreateHandler:function(){return classCreateHandler},CreateGlobals:function(){a.Create=j.Create;a.Package=j.Package;a.GetNamespace=j.GetNamespace;a.SetNamespace=j.SetNamespace;a.ThrowError=j.ThrowError},RegisterNamespaceResolver:function(k){g=k}};j.SetNamespace("a5.core.reflection",true,function(){var k={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},m=function(n,p,q,o){o=o||p[q];o._a5_ownerInstance=p;o._a5_ownerClass=n;o._a5_methodName=q;o.getName=k.getName;o.getClass=k.getClass;o.getClassInstance=k.getClassInstance;o.getAttributes=k.getAttributes};return{setReflection:m}});j.SetNamespace("a5.core.attributes",true,function(){var o=function(r,u){var y=Array.prototype.slice.call(u),v,H,G,F,E,z,w={},p=false;if(!y.length){return j.ThrowError(305)}v=typeof y[y.length-1]==="function"?y.pop():null;if(v!==null&&typeof v!=="function"){return j.ThrowError(300)}if(!y.length){return j.ThrowError(301)}for(H=0,E=y.length;H<E;H++){var x=y[H];if(Object.prototype.toString.call(x)!=="[object Array]"){return j.ThrowError(302)}for(G=0,F=x.length;G<F;G++){var C=x[G],z=typeof C;if(G==0){var I=false,D=null;if(z!=="string"){if(z==="function"){D=C}else{I=true}}else{var s=j.GetNamespace(C,r.imports());if(!s){s=j.GetNamespace(C+"Attribute",r.imports())}if(s){D=x[G]=s}else{I=true}}if(!I&&(!D.isA5||!D.doesExtend(j.Attribute))){I=true}else{if(!I&&D.doesExtend(j.AspectAttribute)){p=true}}if(I){return j.ThrowError(303)}}else{if(z!=="object"||Object.prototype.toString.call(C)==="[object Array]"){return j.ThrowError(304)}}}}for(H=0,E=y.length;H<E;H++){var q=y[H],B=[];for(var G=1,F=q.length;G<F;G++){B.push(q[G])}y[H]=[q[0],B];w[q[0].className()]=B}if(!p){if(!v){v=function(){}}v._a5_attributes=w;return v}w.wrappedMethod=v;var A=function(){var N,J,L,V=[],R=this,N,P=0;if(v){for(var J in A){v[J]=A[J]}}L=A.caller;do{if(L.getClassInstance!==undefined){N=L}else{L=L.caller}}while(L!==null&&!N);for(var O=0,M=y.length;O<M;O++){var U=y[O][0],T=U.instance(true),S=y[O][1];V.push({cls:T,props:S})}var Q=function(Y,X,W){K(P,Y,X,W)},K=function(X,ac,ae,Y){if(ac){if(Object.prototype.toString.call(ac)!=="[object Array]"){ac=[ac]}}else{ac=[]}if(!Y){Y=ac}if(X>=V.length){if(ae){return ac[0]}else{return t(ac,Y)}}var ab,ae=ae||false,aa=false,Z=false,ad=function(af){Q.call(this,af||ac,ae,Y)};var W=new j.AspectCallArguments(V[X].props,ac,R,A,ad,N,Y);ab=V[X].cls.around(W);if(ab===j.AspectAttribute.NOT_IMPLEMENTED){ab=V[X].cls[(ae?"after":"before")](W)}else{aa=true}if(ab!==null&&ab!==undefined){switch(ab){case j.AspectAttribute.NOT_IMPLEMENTED:case j.Attribute.SUCCESS:ab=ac;break;case j.Attribute.ASYNC:Z=true;break;case j.Attribute.RETURN_NULL:ab=null;break;case j.Attribute.FAILURE:return}}else{return j.ThrowError(308,null,{prop:J,method:aa?"around":(ae?"after":"before")})}P=X+1;if(!Z){return K(P,ab,ae,ac,Y)}},t=function(X,W){P=0;var Y=v?v.apply(R,X):undefined;if(Y!==undefined){Y=[Y]}else{Y=X}return K(0,Y,true,W)};return K(P,Array.prototype.slice.call(arguments))};A._a5_attributes=w;return A},n=function(){for(i=0,l=j.Attribute._extenderRef.length;i<l;i++){new j.Attribute._extenderRef[i]()}},k=function(y,w){var x=w.split("|");for(var u=0,s=x.length;u<s;u++){var p=x[u],q=p.charAt(0)==="*",z=p.charAt(p.length-1)==="*",v=y.indexOf(p),t=v!==-1;if(t){return true}if(q&&y.indexOf(p.substr(1))===0){return true}if(z&&y.indexOf(p.substr(0,p.length-1))>-1){return true}}return false},m=function(F,r){var t=F.getMethods(),D=Array.prototype.slice;for(var A=0,u=t.length;A<u;A++){var E=t[A],p=F[E],s=[];for(var y=0,v=r.length;y<v;y++){var C=D.call(r[y]);if(C.length>1){var z=C[C.length-1],q=false,x=true,w=z.include,B=z.exclude;if(w!==undefined){q=true;if(typeof w==="object"){x=E.match(w).length>0}else{x=k(E,w)}}if(B!==undefined){q=true;if(typeof B==="object"){x=E.match(B)}else{x=k(E,B)}}if(q){C.pop()}if(x){s.push(C)}}else{s.push(C)}}if(s.length){s.push(p);F[E]=j.core.attributes.createAttribute(F,s);j.core.reflection.setReflection(F.constructor,F,E,F[E])}}};return{createAttribute:o,applyClassAttribs:m}});j.SetNamespace("a5.core.classBuilder",true,function(){var E=[],y=false,A=[],p=[],q,o="_a5_constructFromCreate",v="_a5_baseConstruct",n="_a5_interfaceTest",r={},D=function(G,F){var H,I;if(typeof G==="string"){H=j.GetNamespace(G);if(H===null){return j.ThrowError(207,null,{className:G})}}else{H=G}if(typeof H!=="function"){return j.ThrowError(207,null,{className:G})}return new H(o,F)},t=function(H,K,L){var J=H.replace(/\./g,"_");if(r[J]){var F=r[J];for(var I=0,G=F.length;I<G;I++){if(!F[I][K]){F[I][K]=L}}}},B=function(F,I,K,G,H,J){if(J){I.Properties=function(L){K.constructor._a5_protoProps=L};I.PrivateProperties=function(L){K.constructor._a5_protoPrivateProps=L;return function(M){return M._a5_privatePropsRef[K.namespace()]}}}I.Attributes=function(){return j.core.attributes.createAttribute.call(K,I,arguments)};K.Override={};K.Final={};F.call(I,K,G,H);j.core.mixins.prepareMixins(K);x(K);for(q in K){if(q!=="Attributes"&&({}).hasOwnProperty.call(K,q)&&typeof K[q]==="function"&&(H._a5_namespace==="a5.Object"||j.core.classProxyObj.instance[q]===undefined)){if(q===K.className()){K.constructor._a5_instanceConst=K[q];j.core.reflection.setReflection(H,K,q,K.constructor._a5_instanceConst);delete K[q]}else{j.core.reflection.setReflection(H,K,q)}}}delete K.Final;delete K.Override;delete I.Attributes;if(J){delete I.Properties;delete I.PrivateProperties}},x=function(H){var I=H.superclass(),F=H.constructor._a5_mixedMethods;if(!I){I={}}for(q in H){if(H.hasOwnProperty(q)&&typeof H[q]==="function"){if(q!=="Final"&&q!=="Override"&&q!=="constructor"&&q!=="prototype"&&q!=="dealloc"&&q!=="_a5_initialized"){if(I[q]&&I[q].toString().indexOf("[native code]")===-1){if(I[q].Final==true){return j.ThrowError(201,null,{prop:q,namespace:H.namespace()})}return j.ThrowError(200,null,{prop:q,namespace:H.namespace()})}else{var G=F[q];if(F[q]!==undefined&&G!==H[q]){return j.ThrowError(220,null,{prop:q,namespace:H.namespace()})}}}}}for(q in H.Override){if(I[q]===undefined&&F[q]===undefined){return j.ThrowError(202,null,{prop:q,namespace:H.namespace()})}if(I[q]&&I[q].Final!==undefined&&I[q].Final===true||F[q]&&F[q].Final!==undefined&&F[q].Final===true){return j.ThrowError(203,null,{prop:q,namespace:H.namespace()})}H[q]=H.Override[q]}for(q in H.Final){H[q]=H.Final[q];H[q].Final=true}},C=function(J){var ac,P,F,K,I,S,M,G,Q=null,L=false,aa=false,N=false,W=false,V=false,R=function(){var af=k(ac,J),ah={pkg:J,imports:ac,clsName:P,cls:F,base:K,attribs:Q,type:I,proto:S,implement:M,mixins:G,staticMethods:L,isInterface:N,isMixin:aa,enumDeclaration:W,isProto:V},ag=j.core.verifiers.validateClassDependencies(K,af,G,M,N,aa);if(ag===true){m(ah)}else{E.push({pkg:ah,reason:ag.reason,reasonNM:ag.reasonNM})}R=O=ab=Y=ad=H=X=U=ae=Z=T=null},O=function(){ac=Array.prototype.slice.call(arguments);return{Prototype:U,Static:ad,Mixin:ae,Mix:Z,Extends:ab,Implements:Y,Interface:H,Class:X}},ab=function(af){K=af;return{Prototype:U,Static:ad,Import:O,Mix:Z,Implements:Y,Interface:H,Class:X}},Z=function(){G=Array.prototype.slice.call(arguments);return{Prototype:U,Static:ad,Extends:ab,Implements:Y,Interface:H,Class:X}},Y=function(af){M=Array.prototype.slice.call(arguments);return{Prototype:U,Static:ad,Mix:Z,Import:O,Extends:ab,Class:X}},ad=function(af,ag){if(typeof af==="string"){P=af;L=ag;R()}else{L=af;return{Prototype:U,Implements:Y,Mix:Z,Mixin:ae,Import:O,Extends:ab,Class:X}}},H=function(ag,af){P=ag;F=af;N=true;R()},ae=function(){aa=true;var ag=Array.prototype.slice.call(arguments);P=ag[0];for(var ah=1,af=ag.length;ah<af;ah++){switch(typeof ag[ah]){case"string":I=ag[ah];break;case"object":if(Object.prototype.toString.call(ag[ah])==="[object Array]"){if(!Q){Q=[]}Q.push(ag[ah])}break;case"function":F=ag[ah];break}}R()},T=function(af,ag){P=af;W=ag;R()},X=function(){var ag=Array.prototype.slice.call(arguments);P=ag[0];for(var ah=1,af=ag.length;ah<af;ah++){switch(typeof ag[ah]){case"string":I=ag[ah];break;case"object":if(Object.prototype.toString.call(ag[ah])==="[object Array]"){if(!Q){Q=[]}Q.push(ag[ah])}break;case"function":F=ag[ah];break}}R()},U=function(){V=true;var ag=Array.prototype.slice.call(arguments);P=ag[0];for(var ah=1,af=ag.length;ah<af;ah++){switch(typeof ag[ah]){case"string":I=ag[ah];break;case"object":if(Object.prototype.toString.call(ag[ah])==="[object Array]"){if(!Q){Q=[]}Q.push(ag[ah])}break;case"function":S=ag[ah];break}}R()};j.SetNamespace(J);return{Enum:T,Static:ad,Import:O,Extends:ab,Mixin:ae,Mix:Z,Implements:Y,Class:X,Prototype:U,Interface:H}},z=function(M,G){if(!this._a5_initialized){if(this.constructor.isInterface()){return j.ThrowError(208,null,{nm:ref.namespace()})}if(this.constructor.isAbstract()&&M!==v){return j.ThrowError(216,null,{nm:this.constructor.namespace()})}this._a5_initialized=true;if(M!==v&&this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return j.ThrowError(217,null,{nm:this.constructor.namespace()})}this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;var O=this,F=this,I=M||[],P=[],K,J,H,L;this._a5_privatePropsRef={};if(M!==v&&typeof this.constructor._a5_instanceConst!=="function"){return j.ThrowError(218,null,{clsName:this.className()})}while(F!==null){var N=F.constructor;if(N._a5_attribs){j.core.attributes.applyClassAttribs(this,N._a5_attribs)}if(N._a5_protoPrivateProps!==undefined){this._a5_privatePropsRef[F.namespace()]={};N._a5_protoPrivateProps.call(this._a5_privatePropsRef[F.namespace()])}if(N._a5_protoProps!==undefined){P.unshift(N._a5_protoProps)}F=N.superclass&&N.superclass().constructor.namespace?N.superclass():null}j.core.mixins.initializeMixins(this);for(J=0,H=P.length;J<H;J++){P[J].call(this)}if(M!==v){if(M==o){this.constructor._a5_instanceConst.apply(this,G)}else{this.constructor._a5_instanceConst.apply(this,arguments)}}j.core.mixins.mixinsReady(this)}},w=function(Q,L,T,H,O,X,aa,F,S){if(O){if(L&&!L.isInterface()){return j.ThrowError('Interface "'+Q+'" cannot extend "'+L.namespace()+'", base class is not an interface.')}L=null}var G=function(){},M=X===false||false,ab=false,P=false,W=null,V=Q.lastIndexOf("."),I=V>-1?Q.substring(0,V):"",R=V>-1?Q.substring(V+1):Q,K,N,J,ac,Z,U;if(!L||L===undefined){L=(Q=="a5.Object"?G:j.Object)}N=function(ae,af){var ad=this;if(this.constructor._a5_clsDef){B(this.constructor._a5_clsDef,this,this,this.constructor.imports(),this.constructor)}if(ae!==n){z.apply(this,arguments)}};if(H){K=H.split(/[ |]/);for(Z=0,U=K.length;Z<U;Z++){if(K[Z]=="final"){M=true}else{if(K[Z]=="singleton"){ab=true}else{if(K[Z]=="abstract"){P=true}}}}}if(j.core.verifiers.checkNamespaceValid(Q)){if(!L.isFinal||(L.isFinal()!=true)){if(L===Error){var Y={};Y.prototype=new L();N.prototype=Y;Y=null}else{N.prototype=new L(v)}W=L}else{return j.ThrowError("Cannot extend "+L.namespace()+", class marked as final.")}}else{return j.ThrowError("Cannot create new class in namespace "+Q+", definition already exists.")}J=N.prototype;ac=J.constructor=N;if(L.prototype.constructor._extenderRef){L.prototype.constructor._extenderRef.push(N)}ac._a5_superclass=W;ac._a5_pkg=I;ac._a5_clsDef=T;ac._a5_clsName=R;ac._a5_namespace=Q;ac._a5_imports=aa;ac._a5_isFinal=M;ac._a5_isAbstract=P;ac._a5_isSingleton=ab;ac._a5_isInterface=O;ac._a5_isPrototype=X||false;ac._a5_attribs=S;ac._mixinRef=L.prototype.constructor._mixinRef?L.prototype.constructor._mixinRef.slice(0):[];ac._implementsRef=L.prototype.constructor._implementsRef?L.prototype.constructor._implementsRef.slice(0):[];ac._a5_mixedMethods={};ac._a5_instance=null;ac._instanceCount=0;ac._extenderRef=[];J._a5_initialized=false;for(q in j.core.classProxyObj.construct){ac[q]=j.core.classProxyObj.construct[q]}if(L.namespace===undefined){for(q in j.core.classProxyObj.instance){J[q]=j.core.classProxyObj.instance[q]}}if(F){j.core.mixins.applyMixins(J,F,aa)}return j.SetNamespace(Q,N)},s=function(){var F=false,J,H;for(J=0;J<E.length;J++){var K=E[J].pkg,G=k(K.imports,K.pkg),I=j.core.verifiers.validateClassDependencies(K.base,G,K.mixins,K.implement);if(I===true){m(K,true);E.splice(J,1);J--;F=true}else{E[J].reason=I.reason;E[J].reasonNM=I.reasonNM}}if(F){s()}},u=function(H){var G=H.obj,F=H.pkgObj;B(F.proto,G,G.prototype,G.imports(),G,true)},m=function(M,I){var F=function(){return k(M.imports,M.pkg)},G=(typeof M.base==="function")?M.base:j.GetNamespace(M.base,F()),J=w(M.pkg+"."+M.clsName,G,M.cls,M.type,M.isInterface,M.isProto,F,M.mixins,M.attribs),N=I||false,Q=true,K,H;if(M.staticMethods){M.staticMethods(J,F())}if(M.proto&&y){A.push({obj:J,pkgObj:M});if(M.implement){p.push({pkgObj:M,obj:J})}}else{if(M.proto){u({obj:J,pkgObj:M})}if(M.implement){Q=j.core.verifiers.validateImplementation(M,J)}}if(!Q){return}if(M.enumDeclaration){var L=0,O=[];M.enumDeclaration({startIndex:function(R){L=R},addValue:function(R){O.push(R)}});for(K=0,H=O.length;K<H;K++){J[O[K]]=L++}J.addValue=function(R){if(J[R]===undefined){J[R]=L++}};J.getValue=function(R){for(q in J){if(J[q]===R){return q}}return null}}if(M.isInterface){J.interfaceVals={};if(M.base!==null&&M.base!==undefined){var P=j.GetNamespace(M.base,J.imports());if(P.isInterface()){for(q in P.interfaceVals){if(J.interfaceVals[q]===undefined){J.interfaceVals[q]=P.interfaceVals[q]}}}else{j.ThrowError(204,null,{objNM:J.namespace(),clsNM:P.namespace()})}}M.cls.call(J.interfaceVals,J.interfaceVals)}if(M.isMixin){J._mixinDef={Properties:function(R){J.prototype.constructor._a5_mixinProps=R},MustExtend:function(){J.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){J.prototype.constructor._a5_mixinMustMix=arguments}};M.cls.call(J._mixinDef,J._mixinDef,J.imports(),J);if(typeof J._mixinDef[J.className()]==="function"){J._a5_instanceConst=J._mixinDef[J.className()];delete J._mixinDef[J.className()]}else{j.ThrowError(205,null,{nm:J.namespace()})}delete J._mixinDef.Properties;delete J._mixinDef.Contract;delete J._mixinDef.MustExtend;delete J._mixinDef.MustMix}t(M.pkg,M.clsName,J);if(!N){s()}},k=function(H,G,F){return(function(R,T){var N=function(){if(K.length){var X={},Z=k(K,null,true),W=Z.retObj,Y=Z.rebuildArray;for(q in N){X[q]=N[q]}for(q in W){if(X[q]===undefined){N[q]=X[q]=W[q]}}K=Y;return X}else{return N}},J=F||false,K=[],Q,M,S=function(W){var X;for(q in W){X=W[q];if((typeof X==="function"||typeof X==="object")&&N[q]===undefined){N[q]=X}}};if(T){S(j.GetNamespace(T,null,true))}if(R){var U,T,L,P,I,V;for(Q=0,M=R.length;Q<M;Q++){U=R[Q],P=false,I=U.lastIndexOf(".");if(U.charAt(U.length-1)=="*"){P=true}if(P){V=U.substr(0,U.length-2);T=j.GetNamespace(V,null,true);if(T){S(T)}var V=V.replace(/\./g,"_");if(!r[V]){r[V]=[]}r[V].push(N);K.push(U)}else{L=I>-1?U.substr(I+1):U;var O=j.GetNamespace(U,null,true);if(O){if(N[L]===undefined){N[L]=O}}else{K.push(U)}}}}if(J){return{retObj:N,rebuildArray:K}}return N})(H,G)};j.Create=D;j.Package=C;j._a5_Extend=w;j._a5_processImports=k;j._a5_verifyPackageQueueEmpty=function(){if(E.length){var H="",G,F;for(G=0,F=E.length;G<F;G++){H+='"'+E[G].pkg.pkg+"."+E[G].pkg.clsName+'", '+E[G].reason+' class missing: "'+E[G].reasonNM+'"'+(E.length>1&&G<E.length-1?", \n":"")}j.ThrowError(206,null,{classPlural:E.length==1?"class":"classes",clsString:H})}};j._a5_delayProtoCreation=function(F){y=F};j._a5_createQueuedPrototypes=function(){for(var G=0,F=A.length;G<F;G++){u(A[G])}A=[];for(G=0,F=p.length;G<F;G++){j.core.verifiers.validateImplementation(p[G].pkgObj,p[G].obj)}p=[]}});j.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(k){return k?j.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports()},doesImplement:function(k){return j.core.verifiers.checkImplements(this,k)},doesExtend:function(k){return j.core.verifiers.checkExtends(this,k)},doesMix:function(k){return j.core.verifiers.checkMixes(this,k)},getAttributes:function(){return this._a5_attributes},instance:function(m,k){if(m===true){return this._a5_instance||j.Create(this,k)}else{return this._a5_instance}},superclass:function(n,k){if(n!==undefined){if(typeof n==="object"&&n.isA5===true){if(typeof k!=="object"){k=[]}if(!this._a5_superclass.className){return j.ThrowError(210)}var m=this._a5_superclass.prototype.constructor._a5_instanceConst;if(m){m.apply(n,k)}else{j.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{j.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},superclass:function(m,k){return this.constructor.superclass(m,k)},mixins:function(k){if(k!==undefined){return c(k,this.imports())}else{return this.constructor._a5_mixedMethods}},mix:function(k){j.core.mixins.applyMixins(this,k,this.imports(),this)},getAttributes:function(){return this.constructor.getAttributes()},getAttributeValue:function(k){return this.constructor.getAttributeValue(k)},getMethods:function(m,n){var k=[];for(var o in this){if((m||({}).hasOwnProperty.call(this,o))&&typeof(this[o])==="function"&&j.core.classProxyObj.instance[o]===undefined&&o.substr(0,4)!=="_a5_"&&(n||o.substr(0,1)!=="_")){k.push(o)}}return k},getProperties:function(m,o){var k=[],n=function(t,u){var q=t;while(q!==null){var s=q.constructor;if(s._a5_protoProps!==undefined){var r={};s._a5_protoProps.call(r);if(r[u]!==undefined){return true}}q=s.superclass&&s.superclass().constructor.namespace?s.superclass():null}return false};for(var p in this){if((m||!n(this,p))&&typeof(this[p])!=="function"&&j.core.classProxyObj.instance[p]===undefined&&p.substr(0,4)!=="_a5_"&&(o||p.substr(0,1)!=="_")){k.push(p)}}return k},classPackage:function(k){return this.constructor.classPackage(k)},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(k){return this.constructor.doesImplement(k)},doesExtend:function(k){return this.constructor.doesExtend(k)},doesMix:function(k){return this.constructor.doesMix(k)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){if((this.namespace()==="a5.cl.CL"||this.classPackage().indexOf("a5.cl.core")!==-1)&&!this.classPackage()==="a5.cl.core.viewDef"){j.ThrowError(215,null,{nm:this.namespace()});return}this._a5_initialized=false;var p=this,r,n,k,s,o,m;while(p!==null){var q=p.constructor;k=q._mixinRef;if(k&&k.length){for(o=0,m=k.length;o<m;o++){if(k[o]._mixinDef.dealloc!=undefined){k[o]._mixinDef.dealloc.call(this)}}}if(q.namespace){n=q.superclass?q.superclass():null;if(n&&n.dealloc!==undefined&&n.dealloc!==p.dealloc){p.dealloc.call(this)}p=n}else{p=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}for(s in this){if(typeof this[s]=="function"){this[s]=j._a5_destroyedObjFunc}else{this[s]=null;delete this[s]}}if(this.__proto__){this.__proto__=j._a5_destroyedObj}}},create:j.Create,throwError:function(){return j.ThrowError.apply(this,arguments)},assert:function(m,k){if(m!==true){throw new j.AssertException(k)}}}});j.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(t,o){var p,n,k,q,y,u,s,m=function(A,z){for(var B in A){if(A[B]!==z[B]){return false}}return true};for(p=0,n=t.implement.length;p<n;p++){q=t.implement[p];try{y=new o("_a5_interfaceTest");y.Override={};y.Final={};y.Attributes=function(){var B=Array.prototype.slice.call(arguments);var D=B.pop();for(var C=0,A=B.length;C<A;C++){var z=B[C][0];if(z==="Contract"||z==="ContractAttribute"||z===j.ContractAttribute){D.attributes=B[C]}}return D};u=j.GetNamespace(q,o.imports());if(o._a5_clsDef){o._a5_clsDef.call(y,y,o.imports(),o)}}catch(r){throw r;return false}if(!u.isInterface()){return j.ThrowError(213,null,{implNM:u.namespace(),objNM:o.namespace()})}for(k in u.interfaceVals){s=y[k]!==undefined;var x=u.interfaceVals[k],v=y[k];if(s&&typeof x==="object"&&v.attributes&&(v.attributes[0]==="Contract"||v.attributes[0]==="ContractAttribute"||v.attributes[0]===j.ContractAttribute)){var w=true;for(var p=0,n=x.length;p<n;p++){w=w&&v.attributes.length>=(p+1)?m(x[p],v.attributes[p+1]):false}if(!w){return j.ThrowError(601,null,{intNM:u.namespace(),implNM:o.namespace(),method:k})}}else{if(!s||(s&&typeof u.interfaceVals[k]!==typeof y[k])){return j.ThrowError(214,null,{implNM:u.namespace(),objNM:o.namespace()})}}}o._implementsRef.push(u);y.destroy()}return true},checkNamespaceValid:function(n){for(var m=0,k=this.namespaceArray.length;m<k;m++){if(this.namespaceArray[m]==n){return false}}this.namespaceArray.push(n);return true},checkImplements:function(n,s){if(typeof s==="string"){s=j.GetNamespace(s)}var r=n._implementsRef,q,p,o,m;while(r){for(q=0,m=r.length;q<m;q++){if(r[q]===s){return true}}r=n.superclass()?n.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(k,o){var n=k._a5_superclass&&k._a5_superclass.prototype.className?k._a5_superclass:null;if(!n){return false}var m=(typeof o==="string")?j.GetNamespace(o):o;if(!m){return false}while(n){if(n===m){return true}n=n._a5_superclass&&n._a5_superclass.prototype.className?n._a5_superclass:null}return false},checkMixes:function(m,o){if(typeof o==="string"){o=j.GetNamespace(o)}if(!o){return false}for(var n=0,k=m._mixinRef.length;n<k;n++){if(m._mixinRef[n]===o){return true}}return false},validateClassDependencies:function(o,x,v,n,p,y){var w,t,u,s=null,k,q,z,r;if(o!==undefined){if(typeof o==="function"){s=o}else{s=j.GetNamespace(o,x)}}w=true;if(o!==undefined&&!s){w=false;t="base";u=o}if(w&&v!==undefined){for(k in v){q=v[k];if(typeof q==="string"){z=j.GetNamespace(q,x)}if(typeof z!=="function"){w=false;t="mixin";u=q}}}if(w&&n!==undefined){for(k in n){r=n[k];if(typeof r==="string"){z=j.GetNamespace(r,x)}if(typeof z!=="function"){w=false;t="interface";u=r}}}return w?true:{reason:t,reasonNM:u}}});j.SetNamespace("a5.core.mixins",{prepareMixins:function(q){var p=q,k=q.constructor._mixinRef,o,n,r,m;if(k.length){for(o=k.length-1,n=-1;o>n;o--){if(k[o]._a5_mixinMustExtend!==undefined){for(r in k[o]._a5_mixinMustExtend){m=k[o]._a5_mixinMustExtend[r];if(!q.doesExtend(j.GetNamespace(m,q.imports()))){return j.ThrowError(400,null,{mixinNM:k[o].namespace(),instNM:q.namespace(),clsNM:m.namespace()})}}}}}},initializeMixins:function(q){var p=q,k=q.constructor._mixinRef,o,n,r,m;if(k.length){for(o=k.length-1,n=-1;o>n;o--){if(k[o]._a5_mixinProps!==undefined){k[o]._a5_mixinProps.call(p)}}for(o=0,n=k.length;o<n;o++){k[o]._a5_instanceConst.call(p)}}},mixinsReady:function(p){var k=p.constructor._mixinRef,o,n,q,m;if(k.length){for(o=k.length-1,n=-1;o>n;o--){if(k[o]._a5_mixinMustMix!==undefined){for(q in k[o]._a5_mixinMustMix){m=k[o]._a5_mixinMustMix[q];if(!inst.doesMix(j.GetNamespace(m))){return j.ThrowError(401,null,{nm:k[o].namespace(),cls:m})}}}if(typeof k[o]._mixinDef.mixinReady==="function"){k[o]._mixinDef.mixinReady.call(p)}}}},applyMixins:function(v,u,n,t){var o={},u=typeof u==="string"?[u]:u,w=[],s,r,q,p,x;for(s=0,p=u.length;s<p;s++){x=j.GetNamespace(u[s],typeof n==="function"?n():n);if(!x){return j.ThrowError(404,null,{mixin:u[s]})}w.push(x);for(r=0,q=v.constructor._mixinRef.length;r<q;r++){if(v.constructor._mixinRef[r]===x){return j.ThrowError(402,null,{nm:x.namespace()})}}for(var m in x._mixinDef){if(m!=="dealloc"&&m!=="Properties"&&m!=="mixinReady"&&m!=="MustExtend"&&m!=="Contract"){if(o[m]===undefined){if(t===undefined){v.constructor._a5_mixedMethods[m]=x._mixinDef[m]}v[m]=x._mixinDef[m];o[m]="mixed"}else{return j.ThrowError(403,null,{method:m})}}}if(t){j.core.mixins.initializeMixins(t,w,t)}else{v.constructor._mixinRef.push(x)}}}});j.SetNamespace("a5.core.errorHandling",true,function(){var m=null;this.ThrowError=function(n,q,p){var o=typeof n,r;if(o==="string"){r=n}else{if(o==="number"){if(j.GetNamespace("a5.ErrorDefinitions",null,true)){var r=j.ErrorDefinitions[n];if(!r){r="Invalid error id "+n+" thrown: error not defined."}}else{r="Error id "+n+" thrown. Include a5.ErrorDefinitions for verbose information."}n=j.Create(q||j.Error,[r,j.Error.FORCE_CAST_ERROR])}}if(r){n=j.Create(q||j.Error,[(p?k(r,p):r),j.Error.FORCE_CAST_ERROR])}m=n;throw n};this._a5_getThrownError=function(){var n=m;m=null;return n};var k=function(o,n){for(var p in n){o=o.replace(new RegExp("{"+p+"}","g"),n[p])}return o}});j.ThrowError=j.core.errorHandling.ThrowError;j._a5_getThrownError=j.core.errorHandling._a5_getThrownError;j.Package("a5").Prototype("Object",function(m,k){m.Object=function(){}});j.Package("a5").Prototype("Attribute","singleton",function(n,k,m){n.Attribute=function(){}});j.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(n,m,k){k.RETURN_NULL="_a5_aspectReturnsNull";k.SUCCESS="_a5_aspectSuccess";k.ASYNC="_a5_aspectAsync";k.FAILURE="_a5_aspectFailure";k.NOT_IMPLEMENTED="_a5_notImplemented";n.AspectAttribute=function(){n.superclass(this)};n.before=function(r,o,p,t,s,q){return k.NOT_IMPLEMENTED};n.after=function(s,p,q,u,t,r,o){return k.NOT_IMPLEMENTED};n.around=function(){return k.NOT_IMPLEMENTED}});j.Package("a5").Class("AspectCallArguments",function(t,s,q){var k,o,n,r,u,p,m;t.AspectCallArguments=function(z,w,x,B,A,y,v){k=z;o=w;n=x;r=B;u=A;p=y;m=v};t.rules=function(){return k};t.args=function(){return o};t.scope=function(){return n};t.method=function(){return r};t.callback=function(){return u};t.callOriginator=function(){return p};t.beforeArgs=function(){return m}});j.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(m,k,p){m.ContractAttribute=function(){m.superclass(this)};m.Override.before=function(s){var t=null,u=false,r=function(v){v.message='Contract type failure on method "'+s.method().getName()+'" '+v.message;return v};if(s.rules().length>1){for(i=0,l=s.rules().length;i<l;i++){t=n(s.rules()[i],s.args());if(t instanceof j.ContractException){m.throwError(r(t));return j.AspectAttribute.FAILURE}if(t!==false){u=true;t.overloadID=i;break}}}else{u=true;t=n(s.rules()[0],s.args(),true);if(t instanceof j.ContractException){m.throwError(r(t));return j.AspectAttribute.FAILURE}}if(!u||t===false){m.throwError(r(new j.ContractException("no matching overload found")));return j.AspectAttribute.FAILURE}else{return t}};var n=function(w,s){var v={},u=0,r,x,t;for(x in w){t=w[x];r=q((u<s.length?s[u]:undefined),t,u);if(r instanceof j.ContractException){return r}v[x]=r;u++}if(s.length>u){return false}if(s.length===0){if(u===0){return v}return false}return v},q=function(s,w,x){var v="type",t=false,y=null,u,r;if(w.indexOf("=")!=-1){u=w.split("=");w=u[0];t=true;y=u[1]}else{if(t){return new j.ContractException("for argument "+x+", required values cannot be defined after optional values")}}if(w.indexOf(".")!==-1){v="class"}if(w==="array"){v="array"}if(w==="object"){v="object"}if(v!=="class"){w=w.toLowerCase()}if(s===undefined){if(t){s=o(w,v,y,x)}else{return new j.ContractException("for argument "+x+', missing required argument of type "'+w+'"')}}if(s!==undefined&&s!==null){switch(v){case"class":r=j.GetNamespace(w);if(r.isInterface()){if(!(s.doesImplement(r))){return new j.ContractException("for argument "+x+", must implement interface "+w)}}else{if(!(s instanceof r)){return new j.ContractException("for argument "+x+", must be an instance of type "+w)}}break;case"type":if(s!==null&&typeof s!==w){return new j.ContractException("for argument "+x+", must be of type "+w)}break;case"array":if(Object.prototype.toString.call(s)!=="[object Array]"){return new j.ContractException("for argument "+x+", must be an array")}break;case"object":if(s._a5_initialized!==undefined||typeof s!=="object"||s instanceof Array){return new j.ContractException("for argument "+x+", must be a generic object")}break}}return s},o=function(s,r,x,t){var w,v=false;if(s==="string"){var u=x.charAt(0);if(u===x.charAt(x.length-1)){if(u==='"'||u==="'"){w=x.substr(1,x.length-2)}else{v=true}}else{v=true}}else{if(s==="number"){if(!isNaN(x)){w=parseInt(x)}else{v=true}}else{if(r==="class"){if(x==="null"){w=null}else{v=true}}else{if(s==="boolean"||s==="array"||s==="function"||s==="object"){switch(x){case"{}":if(s==="object"){w={}}else{v=true}break;case"[]":if(s==="array"){w=[]}else{v=true}break;case"null":w=null;break;case"true":if(s==="boolean"){w=true}else{v=true}break;case"false":if(s==="boolean"){w=false}else{v=true}break;default:v=true}}else{v=true}}}}if(v){return new j.ContractException("for argument "+t+', invalid default value for data type "'+s+'"')}else{return w}}});j.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(k){k.PropertyMutatorAttribute=function(){k.superclass(this)};k.Override.before=function(o){if(o.args().length){var m=o.rules()[0].validate,n=false;if(m){if(m.indexOf(".")!==-1){n=true;var m=j.GetNamespace(m);if(!m){return j.AspectAttribute.FAILURE}}var q=n?(o.args()[0] instanceof m):(typeof o.args()[0]===m);if(!q){return j.AspectAttribute.FAILURE}}o.scope()[o.rules()[0].property]=o.args()[0];return j.AspectAttribute.SUCCESS}var p=o.scope()[o.rules()[0].property]||null;return p===null||p===undefined?j.AspectAttribute.RETURN_NULL:p};k.Override.after=function(m){if(m.beforeArgs().length){return m.scope()}else{return j.AspectAttribute.SUCCESS}}});j.Package("a5").Static(function(k){k.DESTROYED="Destroyed"}).Prototype("Event",function(k){this.Properties(function(){this._a5_type=null;this._a5_data=null;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false});k.Event=function(n,m,o){this._a5_type=n;this._a5_data=o||null;this._a5_bubbles=m!==false};k.cancel=function(m){if(m===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};k.target=function(){return this._a5_target};k.currentTarget=function(){return this._a5_currentTarget};k.type=function(){return this._a5_type};k.data=function(){return this._a5_data};k.phase=function(){return this._a5_phase};k.bubbles=function(){return this._a5_bubbles};k.shouldRetain=function(m){if(typeof m==="boolean"){this._a5_shouldRetain=m;return this}return this._a5_shouldRetain};k.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});j.Package("a5").Static("EventPhase",function(k){k.CAPTURING=1;k.AT_TARGET=2;k.BUBBLING=3});j.Package("a5").Extends(Error).Prototype("Error",function(m,k,n){n.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this._a5_isWindowError=false;this.name=this.type=this.className()});m.Error=function(p,o){if(o===false){this._a5_isWindowError=true}if(typeof p==="string"){this.message=p}else{o=p}if(o instanceof n){if(o.stack){this.stack=o.stack.split("\n")}this.line=o.lineNumber;this.url=o.fileName;if(o.message&&this.message===""){this.message=o.message}}else{if(o!==false){}}};m.isWindowError=function(){return this._a5_isWindowError};m.Override.toString=function(){return this.type+": "+this.message}});j.Package("a5").Extends("Error").Prototype("AssertException",function(k){k.AssertException=function(){k.superclass(this,arguments);this.type="AssertException"}});j.Package("a5").Extends("Error").Prototype("ContractException",function(k){k.ContractException=function(){k.superclass(this,arguments);this.type="ContractException"}});j.Package("a5").Static(function(k){k.ADD="eventDispatcherAdd";k.REMOVE="eventDispatcherRemove"}).Prototype("EventDispatcher","abstract",function(n,k,m){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});n.EventDispatcher=function(){};n.autoPurge=function(o){if(typeof o==="boolean"){this._a5_autoPurge=o;return this}return this._a5_autoPurge};n.addEventListener=function(q,r,o,p){this._a5_addEventListener(q,r,o,p)};n.addOneTimeEventListener=function(q,r,o,p){this._a5_addEventListener(q,r,o,p,true)};n.hasEventListener=function(v,o){var u=v.split("|"),w=this.cl(),t,r,q,s,p;for(t=0,r=u.length;t<r;t++){q=this._a5_getListenerArray(u[t]);if(q){for(s=0,p=q.length;s<p;s++){if(q[s].type==u[t]&&(typeof o==="function"?(q[s].method==o):true)){return true}}}}return false};n.removeEventListener=function(y,o,q,z,u){var x=y.split("|"),p=true,w,t,s,v,r;z=z||null;u=u||false;q=q===true;for(w=0,t=x.length;w<t;w++){s=this._a5_getListenerArray(x[w]);if(s){for(v=0,r=s.length;v<r;v++){if(s[v].method===o&&s[v].type===x[w]&&s[v].useCapture===q&&s[v].isOneTime===u){s.splice(v,1);r=s.length}}this.eListenersChange({type:x.length>1?x:x[0],method:o,useCapture:q,changeType:m.REMOVE})}}};n.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};n.getTotalListeners=function(p){if(typeof p==="string"){var o=this._a5_getListenerArray(p);if(o){return o.length}else{return 0}}else{var q=0;for(var r in this._a5_listeners){q+=this._a5_listeners[r].length}return q}};n.dispatchEvent=function(p,q,o){var r=this._a5_createEvent(p,q,o);r._a5_phase=j.EventPhase.AT_TARGET;this._a5_dispatchEvent(r);if(!r.shouldRetain()){r.destroy()}r=null};n.eListenersChange=function(o){};n._a5_addEventListener=function(y,o,z,A,B){var C=A||null,x=y.split("|"),u=B||false,q=z===true,p=true,w,t,s,v,r;if(x.length!=0&&o!=undefined){for(w=0,t=x.length;w<t;w++){s=this._a5_getListenerArray(x[w],true);for(v=0,r=s.length;v<r;v++){if(s[v].method===o&&s[v].type===x[w]&&s[v].useCapture===q&&s[v].scope===C&&s[v].isOneTime===u){p=false;break}}if(p){s.push({type:x[w],method:o,scope:C,useCapture:q===true,isOneTime:u})}}this.eListenersChange({type:x.length>1?x:x[0],method:o,changeType:m.ADD})}else{throw"invalid listener: type- "+y+", method- "+o}};n._a5_createEvent=function(p,q,o){var r=(typeof p==="string")?new j.Event(p,o):p;if(r instanceof j.Event||r.doesExtend&&r.doesExtend(j.Error)){r._a5_target=this;if(q){r._a5_data=q}return r}throw"Invalid event type."};n._a5_dispatchEvent=function(t){t._a5_currentTarget=this;if(this._a5_listeners){var u=this._a5_getListenerArray(t.type()),q,o,p,s,r;if(u){for(q=0,o=u.length;q<o;q++){p=u?u[q]:null;if(t._a5_canceled||!p){return}s=(t.phase()===j.EventPhase.CAPTURING&&p.useCapture)||(t.phase()!==j.EventPhase.CAPTURING&&!p.useCapture),r=typeof p.method==="function"&&(p.scope&&p.scope.namespace?p.scope._a5_initialized:true);if(s&&r){p.method.call(p.scope,t)}if(p.isOneTime===true||(!r&&this._a5_autoPurge)){u.splice(q,1);q--;o--}}}}};n._a5_getListenerArray=function(p,o){if(this._a5_listeners[p]===undefined){if(o===true){this._a5_listeners[p]=[];return this._a5_listeners[p]}return null}return this._a5_listeners[p]};n.dealloc=function(){this.dispatchEvent(new j.Event(j.Event.DESTROYED));this.removeAllListeners();this._a5_listeners=null}});j.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'Mixin "{mixinNM}" requires mixing object "{instNM}" to extend class "{clsNM}" .',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(this);