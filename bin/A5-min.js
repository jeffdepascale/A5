//A5, Copyright (c) 2011, Jeff dePascale & Brian Sutliffe. http://www.jeffdepascale.com(function(a,b){(function(h){var f=null,e=null,d=function(s,p,n){var t,r,o,q;if(!s){return null}n=n||false;if(typeof s==="object"){return s}t=s.split(".");q=h;if(t.length===1&&p&&p[s]){return p[s]}for(r=0,o=t.length;r<o;r++){q=q[t[r]];if(q===b){return null}}if(n||q.namespace!==b){return q}else{if(e){var m=e(s,p);if(m){return m}}}return null},k=function(n,r,q){var t=typeof r==="boolean",p=t?r:false,s,m=(t?q:r)||{},s=n.split("."),u=s.pop(),o;if(!n.match(/^[A-Za-z0-9.]*$/)){return a5.ThrowError(100,null,{namespace:n})}o=s.length?g(s):h;if(o[u]!==b){return o[u]}return o[u]=p?new m():m},g=function(p){var o=h,n,m;for(n=0,m=p.length;n<m;n++){if(!o[p[n]]){o[p[n]]={}}o=o[p[n]]}return o},j=function(){f={};for(var m in h){f[m]=""}},c=function(m){if(!f){a5.ThrowError(101)}else{var o=[],n;for(n in h){if(f[n]===b){o.push(n)}}if(m===true){j()}return o}};h.a5={version:function(){return"0.5.{BUILD_NUMBER}"},buildDate:function(){return"{BUILD_DATE}"},GetNamespace:d,SetNamespace:k,TrackGlobalStrays:j,GetGlobalStrays:c,_a5_destroyedObj:{},_a5_destroyedObjFunc:function(){var m=arguments.callee.caller,n="Destroyed method called from";if(m._a5_methodName!==b){throw n+" method '"+m.getName()+"' in class '"+m.getClass().className()+"'"}else{throw n+" function '"+m.toString()+"'"}},_a5_classCreateHandler:function(){return classCreateHandler},CreateGlobals:function(){h.Create=a5.Create;h.Package=a5.Package;h.GetNamespace=a5.GetNamespace;h.SetNamespace=a5.SetNamespace;h.ThrowError=a5.ThrowError},RegisterNamespaceResolver:function(m){e=m}}})(this);a5.SetNamespace("a5.core.reflection",true,function(){var c={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},d=function(e,g,h,f){f=f||g[h];f._a5_ownerInstance=g;f._a5_ownerClass=e;f._a5_methodName=h;f.getName=c.getName;f.getClass=c.getClass;f.getClassInstance=c.getClassInstance;f.getAttributes=c.getAttributes};return{setReflection:d}});a5.SetNamespace("a5.core.attributes",true,function(){var e=function(h,n){var r=Array.prototype.slice.call(n),o,B,A,z,y,s,p={},f=false;if(!r.length){return a5.ThrowError(305)}o=typeof r[r.length-1]==="function"?r.pop():null;if(o!==null&&typeof o!=="function"){return a5.ThrowError(300)}if(!r.length){return a5.ThrowError(301)}for(B=0,y=r.length;B<y;B++){var q=r[B];if(Object.prototype.toString.call(q)!=="[object Array]"){return a5.ThrowError(302)}for(A=0,z=q.length;A<z;A++){var w=q[A],s=typeof w;if(A==0){var C=false,x=null;if(s!=="string"){if(s==="function"){x=w}else{C=true}}else{var m=a5.GetNamespace(w,h.imports());if(!m){m=a5.GetNamespace(w+"Attribute",h.imports())}if(m){x=q[A]=m}else{C=true}}if(!C&&(!x.isA5||!x.doesExtend(a5.Attribute))){C=true}else{if(x.doesExtend(a5.AspectAttribute)){f=true}}if(C){return a5.ThrowError(303)}}else{if(s!=="object"||Object.prototype.toString.call(w)==="[object Array]"){return a5.ThrowError(304)}}}}for(B=0,y=r.length;B<y;B++){var g=r[B],v=[];for(var A=1,z=g.length;A<z;A++){v.push(g[A])}r[B]=[g[0],v];p[g[0].className()]=v}if(!f){if(!o){o=function(){}}o._a5_attributes=p;return o}p.wrappedMethod=o;var u=function(){var F,k,D,N=[],J=this,F,H=0;if(o){for(var k in u){o[k]=u[k]}}D=u.caller;do{if(D.getClassInstance!==b){F=D}else{D=D.caller}}while(D!==null&&!F);for(var G=0,E=r.length;G<E;G++){var M=r[G][0],L=M.instance(true),K=r[G][1];N.push({cls:L,props:K})}var I=function(Q,P,O){t(H,Q,P,O)},t=function(P,U,W,Q){if(U){if(Object.prototype.toString.call(U)!=="[object Array]"){U=[U]}}else{U=[]}if(!Q){Q=U}if(P>=N.length){if(W){return U[0]}else{return j(U,Q)}}var T,W=W||false,S=false,R=false,V=function(X){I.call(this,X||U,W,Q)};var O=a5.Create(a5.AspectCallArguments,[N[P].props,U,J,u,V,F,Q]);T=N[P].cls.around(O);if(T===a5.AspectAttribute.NOT_IMPLEMENTED){T=N[P].cls[(W?"after":"before")](O)}else{S=true}if(T!==null&&T!==b){switch(T){case a5.AspectAttribute.NOT_IMPLEMENTED:case a5.Attribute.SUCCESS:T=U;break;case a5.Attribute.ASYNC:R=true;break;case a5.Attribute.RETURN_NULL:T=null;break;case a5.Attribute.FAILURE:return}}else{return a5.ThrowError(308,null,{prop:k,method:S?"around":(W?"after":"before")})}H=P+1;if(!R){return t(H,T,W,U,Q)}},j=function(P,O){H=0;var Q=o?o.apply(J,P):b;if(Q!==b){Q=[Q]}else{Q=P}return t(0,Q,true,O)};return t(H,Array.prototype.slice.call(arguments))};u._a5_attributes=p;return u},d=function(){for(i=0,l=a5.Attribute._extenderRef.length;i<l;i++){a5.Create(a5.Attribute._extenderRef[i])}},c=function(p,n){var o=n.split("|");for(var k=0,h=o.length;k<h;k++){var f=o[k],g=f.charAt(0)==="*",q=f.charAt(f.length-1)==="*",m=p.indexOf(f),j=m!==-1;if(j){return true}if(g&&p.indexOf(f.substr(1))===0){return true}if(q&&p.indexOf(f.substr(0,f.length-1))>-1){return true}}return false};applyClassAttribs=function(z,h){var n=z.getMethods(),x=Array.prototype.slice;for(var u=0,o=n.length;u<o;u++){var y=n[u],f=z[y],m=[];for(var s=0,p=h.length;s<p;s++){var w=x.call(h[s]);if(w.length>1){var t=w[w.length-1],g=false,r=true,q=t.include,v=t.exclude;if(q!==b){g=true;if(typeof q==="object"){r=y.match(q).length>0}else{r=c(y,q)}}if(v!==b){g=true;if(typeof v==="object"){r=y.match(v)}else{r=c(y,v)}}if(g){w.pop()}if(r){m.push(w)}}else{m.push(w)}}if(m.length){m.push(f);z[y]=a5.core.attributes.createAttribute(z,m);a5.core.reflection.setReflection(z.constructor,z,y,z[y])}}};return{createAttribute:e,applyClassAttribs:applyClassAttribs}});a5.SetNamespace("a5.core.classBuilder",true,function(){var o=[],s=false,h=null,g=[],n=[],c,k=function(u,t){var v,w;if(typeof u==="string"){v=a5.GetNamespace(u);if(v===null){return a5.ThrowError(207,null,{className:u})}}else{v=u}if(typeof v!=="function"){return a5.ThrowError(207,null,{className:u})}if(v.isInterface()){return a5.ThrowError(208,null,{nm:v.namespace()})}try{w=new v()}catch(x){return a5.ThrowError(209,null,{nm:typeof u==="string"?u:(u.namespace?u.namespace():""),errorStr:x})}if(v._a5_clsDef){r(v._a5_clsDef,w,w,v.imports(),v)}w._a5_initialize(t);return w},r=function(t,w,y,u,v,x){if(x){w.Properties=function(z){y.constructor._a5_protoProps=z};w.PrivateProperties=function(z){y.constructor._a5_protoPrivateProps=z;return function(A){return A._a5_privatePropsRef[y.namespace()]}}}w.Attributes=function(){return a5.core.attributes.createAttribute.call(y,w,arguments)};y.Override={};y.Final={};t.call(w,y,u,v);a5.core.mixins.prepareMixins(y);p(y);for(c in y){if(c!=="Attributes"&&({}).hasOwnProperty.call(y,c)&&typeof y[c]==="function"&&(v._a5_namespace==="a5.Object"||a5.core.classProxyObj.instance[c]===b)){if(c===y.className()){y.constructor._a5_instanceConst=y[c];a5.core.reflection.setReflection(v,y,c,y.constructor._a5_instanceConst);delete y[c]}else{a5.core.reflection.setReflection(v,y,c)}}}delete y.Final;delete y.Override;delete w.Attributes;if(x){delete w.Properties;delete w.PrivateProperties}},p=function(v){var w=v.superclass(),t=v.constructor._a5_mixedMethods;if(!w){w={}}for(c in v){if(v.hasOwnProperty(c)&&typeof v[c]==="function"){if(c!=="Final"&&c!=="Override"&&c!=="constructor"&&c!=="prototype"&&c!=="dealloc"&&c!=="_a5_initialized"){if(w[c]&&w[c].toString().indexOf("[native code]")===-1){if(w[c].Final==true){return a5.ThrowError(201,null,{prop:c,namespace:v.namespace()})}return a5.ThrowError(200,null,{prop:c,namespace:v.namespace()})}else{var u=t[c];if(t[c]!==b&&u!==v[c]){return a5.ThrowError(220,null,{prop:c,namespace:v.namespace()})}}}}}for(c in v.Override){if(w[c]===b&&t[c]===b){return a5.ThrowError(202,null,{prop:c,namespace:v.namespace()})}if(w[c]&&w[c].Final===true||t[c]&&t[c].Final===true){return a5.ThrowError(203,null,{prop:c,namespace:v.namespace()})}v[c]=v.Override[c]}for(c in v.Final){v[c]=v.Final[c];v[c].Final=true}},m=function(x){var Q,D,t,y,w,G,A,u,E=null,z=false,O=false,B=false,K=false,J=false,F=function(){var T=e(Q,x),V={pkg:x,imports:Q,clsName:D,cls:t,base:y,attribs:E,type:w,proto:G,implement:A,mixins:u,staticMethods:z,isInterface:B,isMixin:O,enumDeclaration:K,isProto:J},U=a5.core.verifiers.validateClassDependencies(y,T,u,A,B,O);if(U===true){f(V)}else{o.push({pkg:V,reason:U.reason,reasonNM:U.reasonNM})}F=C=P=M=R=v=L=I=S=N=H=null},C=function(){Q=Array.prototype.slice.call(arguments);return{Prototype:I,Static:R,Mixin:S,Mix:N,Extends:P,Implements:M,Interface:v,Class:L}},P=function(T){y=T;return{Prototype:I,Static:R,Import:C,Mix:N,Implements:M,Interface:v,Class:L}},N=function(){u=Array.prototype.slice.call(arguments);return{Prototype:I,Static:R,Extends:P,Implements:M,Interface:v,Class:L}},M=function(T){A=Array.prototype.slice.call(arguments);return{Prototype:I,Static:R,Mix:N,Import:C,Extends:P,Class:L}},R=function(T,U){if(typeof T==="string"){D=T;z=U;F()}else{z=T;return{Prototype:I,Implements:M,Mix:N,Mixin:S,Import:C,Extends:P,Class:L}}},v=function(U,T){D=U;t=T;B=true;F()},S=function(){O=true;var U=Array.prototype.slice.call(arguments);D=U[0];for(var V=1,T=U.length;V<T;V++){switch(typeof U[V]){case"string":w=U[V];break;case"object":if(Object.prototype.toString.call(U[V])==="[object Array]"){if(!E){E=[]}E.push(U[V])}break;case"function":t=U[V];break}}F()},H=function(T,U){D=T;K=U;F()},L=function(){var U=Array.prototype.slice.call(arguments);D=U[0];for(var V=1,T=U.length;V<T;V++){switch(typeof U[V]){case"string":w=U[V];break;case"object":if(Object.prototype.toString.call(U[V])==="[object Array]"){if(!E){E=[]}E.push(U[V])}break;case"function":t=U[V];break}}F()},I=function(){J=true;var U=Array.prototype.slice.call(arguments);D=U[0];for(var V=1,T=U.length;V<T;V++){switch(typeof U[V]){case"string":w=U[V];break;case"object":if(Object.prototype.toString.call(U[V])==="[object Array]"){if(!E){E=[]}E.push(U[V])}break;case"function":G=U[V];break}}F()};a5.SetNamespace(x);return{Enum:H,Static:R,Import:C,Extends:P,Mixin:S,Mix:N,Implements:M,Class:L,Prototype:I,Interface:v}},q=function(E,z,H,v,C,L,O,t,G){if(C){if(z&&!z.isInterface()){return a5.ThrowError('Interface "'+E+'" cannot extend "'+z.namespace()+'", base class is not an interface.')}z=null}var u=function(){},A=L===false||false,P=false,D=false,K=null,J=E.lastIndexOf("."),w=J>-1?E.substring(0,J):"",F=J>-1?E.substring(J+1):E,y,B,x,Q,N,I;if(!z||z===b){z=(E=="a5.Object"?u:a5.Object)}B=function(){};if(v){y=v.split(/[ |]/);for(N=0,I=y.length;N<I;N++){if(y[N]=="final"){A=true}else{if(y[N]=="singleton"){P=true}else{if(y[N]=="abstract"){D=true}}}}}if(a5.core.verifiers.checkNamespaceValid(E)){if(!z.isFinal||(z.isFinal()!=true)){if(z===Error){var M={};M.prototype=new z();B.prototype=M;M=null}else{B.prototype=new z()}K=z}else{return a5.ThrowError("Cannot extend "+z.namespace()+", class marked as final.")}}else{return a5.ThrowError("Cannot create new class in namespace "+E+", definition already exists.")}x=B.prototype;Q=x.constructor=B;if(z.prototype.constructor._extenderRef){z.prototype.constructor._extenderRef.push(B)}Q._a5_superclass=K;Q._a5_pkg=w;Q._a5_clsDef=H;Q._a5_clsName=F;Q._a5_namespace=E;Q._a5_imports=O;Q._a5_isFinal=A;Q._a5_isAbstract=D;Q._a5_isSingleton=P;Q._a5_isInterface=C;Q._a5_isPrototype=L||false;Q._a5_attribs=G;Q._mixinRef=z.prototype.constructor._mixinRef?z.prototype.constructor._mixinRef.slice(0):[];Q._implementsRef=z.prototype.constructor._implementsRef?z.prototype.constructor._implementsRef.slice(0):[];Q._a5_mixedMethods={};Q._a5_instance=null;Q._instanceCount=0;Q._extenderRef=[];x._a5_initialized=false;for(c in a5.core.classProxyObj.construct){Q[c]=a5.core.classProxyObj.construct[c]}if(z.namespace===b){for(c in a5.core.classProxyObj.instance){x[c]=a5.core.classProxyObj.instance[c]}}if(t){a5.core.mixins.applyMixins(x,t,O)}return a5.SetNamespace(E,B)},j=function(){var t=false,x,v;for(x=0;x<o.length;x++){var y=o[x].pkg,u=e(y.imports,y.pkg),w=a5.core.verifiers.validateClassDependencies(y.base,u,y.mixins,y.implement);if(w===true){f(y,true);o.splice(x,1);x--;t=true}else{o[x].reason=w.reason;o[x].reasonNM=w.reasonNM}}if(t){j()}},d=function(v){var u=v.obj,t=v.pkgObj;r(t.proto,u,u.prototype,u.imports(),u,true)},f=function(A,w){var t=function(){return e(A.imports,A.pkg)},u=(typeof A.base==="function")?A.base:a5.GetNamespace(A.base,t()),x=q(A.pkg+"."+A.clsName,u,A.cls,A.type,A.isInterface,A.isProto,t,A.mixins,A.attribs),B=w||false,E=true,y,v;if(A.staticMethods){A.staticMethods(x,t())}if(A.proto&&s){g.push({obj:x,pkgObj:A});if(A.implement){n.push({pkgObj:A,obj:x})}}else{if(A.proto){d({obj:x,pkgObj:A})}if(A.implement){E=a5.core.verifiers.validateImplementation(A,x)}}if(!E){return}if(A.enumDeclaration){var z=0,C=[];A.enumDeclaration({startIndex:function(F){z=F},addValue:function(F){C.push(F)}});for(y=0,v=C.length;y<v;y++){x[C[y]]=z++}x.addValue=function(F){if(x[F]===b){x[F]=z++}};x.getValue=function(F){for(c in x){if(x[c]===F){return c}}return null}}if(A.isInterface){x.interfaceVals={};if(A.base!==null&&A.base!==b){var D=a5.GetNamespace(A.base,x.imports());if(D.isInterface()){for(c in D.interfaceVals){if(x.interfaceVals[c]===b){x.interfaceVals[c]=D.interfaceVals[c]}}}else{a5.ThrowError(204,null,{objNM:x.namespace(),clsNM:D.namespace()})}}A.cls.call(x.interfaceVals,x.interfaceVals)}if(A.isMixin){x._mixinDef={Properties:function(F){x.prototype.constructor._a5_mixinProps=F},MustExtend:function(){x.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){x.prototype.constructor._a5_mixinMustMix=arguments}};A.cls.call(x._mixinDef,x._mixinDef,x.imports(),x);if(typeof x._mixinDef[x.className()]==="function"){x._a5_instanceConst=x._mixinDef[x.className()];delete x._mixinDef[x.className()]}else{a5.ThrowError(205,null,{nm:x.namespace()})}delete x._mixinDef.Properties;delete x._mixinDef.Contract;delete x._mixinDef.MustExtend;delete x._mixinDef.MustMix}if(!B){j()}},e=function(v,u,t){return(function(D,F){var A=function(){if(x.length){var I={},K=e(x,null,true),H=K.retObj,J=K.rebuildArray;for(c in A){I[c]=A[c]}for(c in H){if(I[c]===b){A[c]=I[c]=H[c]}}x=J;return I}else{return A}},w=t||false,x=[],C,z,E=function(H){var I;for(c in H){I=H[c];if((typeof I==="function"||typeof I==="object")&&A[c]===b){A[c]=I}}};if(F){E(a5.GetNamespace(F,null,true))}if(D){var G,F,y;for(C=0,z=D.length;C<z;C++){G=D[C],isWC=false,dotIndex=G.lastIndexOf(".");if(G.charAt(G.length-1)=="*"){isWC=true}if(isWC){F=a5.GetNamespace(G.substr(0,G.length-2),null,true);if(F){E(F)}x.push(G)}else{y=dotIndex>-1?G.substr(dotIndex+1):G;var B=a5.GetNamespace(G,null,true);if(B){if(A[y]===b){A[y]=B}}else{x.push(G)}}}}if(w){return{retObj:A,rebuildArray:x}}return A})(v,u)};a5.Create=k;a5.Package=m;a5._a5_processImports=e;a5._a5_verifyPackageQueueEmpty=function(){if(o.length){var v="",u,t;for(u=0,t=o.length;u<t;u++){v+='"'+o[u].pkg.pkg+"."+o[u].pkg.clsName+'", '+o[u].reason+' class missing: "'+o[u].reasonNM+'"'+(o.length>1&&u<o.length-1?", \n":"")}a5.ThrowError(206,null,{classPlural:o.length==1?"class":"classes",clsString:v})}};a5._a5_delayProtoCreation=function(t){s=t};a5._a5_createQueuedPrototypes=function(){for(var u=0,t=g.length;u<t;u++){d(g[u])}g=[];for(u=0,t=n.length;u<t;u++){a5.core.verifiers.validateImplementation(n[u].pkgObj,n[u].obj)}n=[]};a5.RegisterClassCreateHandler=function(t){h=t}});a5.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(c){return c?a5.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports()},doesImplement:function(c){return a5.core.verifiers.checkImplements(this,c)},doesExtend:function(c){return a5.core.verifiers.checkExtends(this,c)},doesMix:function(c){return a5.core.verifiers.checkMixes(this,c)},getAttributes:function(){return this._a5_attributes},instance:function(d,c){if(d===true){return this._a5_instance||a5.Create(this,c)}else{return this._a5_instance}},superclass:function(e,c){if(e!==b){if(typeof e==="object"&&e.isA5===true){if(typeof c!=="object"){c=[]}if(!this._a5_superclass.className){return a5.ThrowError(210)}var d=this._a5_superclass.prototype.constructor._a5_instanceConst;if(d){d.apply(e,c)}else{a5.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{a5.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},superclass:function(d,c){return this.constructor.superclass(d,c)},mixins:function(c){if(c!==b){return GetNamespace(c,this.imports())}else{return this.constructor._a5_mixedMethods}},mix:function(c){a5.core.mixins.applyMixins(this,c,this.imports(),this)},getAttributes:function(){return this.constructor.getAttributes()},getAttributeValue:function(c){return this.constructor.getAttributeValue(c)},getMethods:function(d,e){var c=[];for(var f in this){if((d||({}).hasOwnProperty.call(this,f))&&typeof(this[f])==="function"&&a5.core.classProxyObj.instance[f]===b&&f.substr(0,4)!=="_a5_"&&(e||f.substr(0,1)!=="_")){c.push(f)}}return c},getProperties:function(d,f){var c=[],e=function(m,n){var h=m;while(h!==null){var k=h.constructor;if(k._a5_protoProps!==b){var j={};k._a5_protoProps.call(j);if(j[n]!==b){return true}}h=k.superclass&&k.superclass().constructor.namespace?k.superclass():null}return false};for(var g in this){if((d||!e(this,g))&&typeof(this[g])!=="function"&&a5.core.classProxyObj.instance[g]===b&&g.substr(0,4)!=="_a5_"&&(f||g.substr(0,1)!=="_")){c.push(g)}}return c},classPackage:function(c){return this.constructor.classPackage(c)},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(c){return this.constructor.doesImplement(c)},doesExtend:function(c){return this.constructor.doesExtend(c)},doesMix:function(c){return this.constructor.doesMix(c)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){if((this.namespace()==="a5.cl.CL"||this.classPackage().indexOf("a5.cl.core")!==-1)&&!this.classPackage()==="a5.cl.core.viewDef"){a5.ThrowError(215,null,{nm:this.namespace()});return}this._a5_initialized=false;var g=this,j,e,c,k,f,d;while(g!==null){var h=g.constructor;c=h._mixinRef;if(c&&c.length){for(f=0,d=c.length;f<d;f++){if(c[f]._mixinDef.dealloc!=b){c[f]._mixinDef.dealloc.call(this)}}}if(h.namespace){e=h.superclass?h.superclass():null;if(e&&e.dealloc!==g.dealloc){g.dealloc.call(this)}g=e}else{g=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}for(k in this){if(typeof this[k]=="function"){this[k]=a5._a5_destroyedObjFunc}else{this[k]=null;delete this[k]}}if(this.__proto__){this.__proto__=a5._a5_destroyedObj}}},_a5_initialize:function(j){if(!this._a5_initialized){if(this.constructor.isAbstract()&&this._a5_initialize.caller.caller!==Extend){return a5.ThrowError(216,null,{nm:this.constructor.namespace()})}this._a5_initialized=true;if(this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return a5.ThrowError(217,null,{nm:this.constructor.namespace()})}this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;var m=this,c=this,e=j||[],n=[],g,f,d,h;this._a5_privatePropsRef={};if(typeof this.constructor._a5_instanceConst!=="function"){return a5.ThrowError(218,null,{clsName:this.className()})}while(c!==null){var k=c.constructor;if(k._a5_attribs){a5.core.attributes.applyClassAttribs(this,k._a5_attribs)}if(k._a5_protoPrivateProps!==b){this._a5_privatePropsRef[c.namespace()]={};k._a5_protoPrivateProps.call(this._a5_privatePropsRef[c.namespace()])}if(k._a5_protoProps!==b){n.unshift(k._a5_protoProps)}c=k.superclass&&k.superclass().constructor.namespace?k.superclass():null}a5.core.mixins.initializeMixins(this);for(f=0,d=n.length;f<d;f++){n[f].call(this)}this.constructor._a5_instanceConst.apply(this,e);a5.core.mixins.mixinsReady(this);return true}else{return null}},create:a5.Create,throwError:function(){return a5.ThrowError.apply(this,arguments)},assert:function(d,c){if(d!==true){throw this.create(a5.AssertException,[c])}}}});a5.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(n,g){var h,f,c,j,s,o,m,d=function(t,e){for(var u in t){if(t[u]!==e[u]){return false}}return true};for(h=0,f=n.implement.length;h<f;h++){j=n.implement[h];try{s=new g;s.Override={};s.Final={};s.Attributes=function(){var u=Array.prototype.slice.call(arguments);var w=u.pop();for(var v=0,t=u.length;v<t;v++){var e=u[v][0];if(e==="Contract"||e==="ContractAttribute"||e===a5.ContractAttribute){w.attributes=u[v]}}return w};o=a5.GetNamespace(j,g.imports());if(g._a5_clsDef){g._a5_clsDef.call(s,s,g.imports(),g)}}catch(k){throw k;return false}if(!o.isInterface()){return a5.ThrowError(213,null,{implNM:o.namespace(),objNM:g.namespace()})}for(c in o.interfaceVals){m=s[c]!==b;var r=o.interfaceVals[c],p=s[c];if(m&&typeof r==="object"&&p.attributes&&(p.attributes[0]==="Contract"||p.attributes[0]==="ContractAttribute"||p.attributes[0]===a5.ContractAttribute)){var q=true;for(var h=0,f=r.length;h<f;h++){q=q&&p.attributes.length>=(h+1)?d(r[h],p.attributes[h+1]):false}if(!q){return a5.ThrowError(601,null,{intNM:o.namespace(),implNM:g.namespace(),method:c})}}else{if(!m||(m&&typeof o.interfaceVals[c]!==typeof s[c])){return a5.ThrowError(214,null,{implNM:o.namespace(),objNM:g.namespace()})}}}g._implementsRef.push(o);s.destroy()}return true},checkNamespaceValid:function(e){for(var d=0,c=this.namespaceArray.length;d<c;d++){if(this.namespaceArray[d]==e){return false}}this.namespaceArray.push(e);return true},checkImplements:function(d,m){if(typeof m==="string"){m=a5.GetNamespace(m)}var h=d._implementsRef,g,f,e,c;while(h){for(g=0,c=h.length;g<c;g++){if(h[g]===m){return true}}h=d.superclass()?d.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(c,f){var e=c._a5_superclass&&c._a5_superclass.prototype.className?c._a5_superclass:null;if(!e){return false}var d=(typeof f==="string")?a5.GetNamespace(f):f;if(!d){return false}while(e){if(e===d){return true}e=e._a5_superclass&&e._a5_superclass.prototype.className?e._a5_superclass:null}return false},checkMixes:function(d,f){if(typeof f==="string"){f=a5.GetNamespace(f)}if(!f){return false}for(var e=0,c=d._mixinRef.length;e<c;e++){if(d._mixinRef[e]===f){return true}}return false},validateClassDependencies:function(e,q,o,d,f,r){var p,k,n,j=null,c,g,s,h;if(e!==b){if(typeof e==="function"){j=e}else{j=a5.GetNamespace(e,q)}}p=true;if(e!==b&&!j){p=false;k="base";n=e}if(p&&o!==b){for(c in o){g=o[c];if(typeof g==="string"){s=a5.GetNamespace(g,q)}if(typeof s!=="function"){p=false;k="mixin";n=g}}}if(p&&d!==b){for(c in d){h=d[c];if(typeof h==="string"){s=a5.GetNamespace(h,q)}if(typeof s!=="function"){p=false;k="interface";n=h}}}return p?true:{reason:k,reasonNM:n}}});a5.SetNamespace("a5.core.mixins",{prepareMixins:function(h){var g=h,c=h.constructor._mixinRef,f,e,j,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinMustExtend!==b){for(j in c[f]._a5_mixinMustExtend){d=c[f]._a5_mixinMustExtend[j];if(!h.doesExtend(a5.GetNamespace(d,h.imports()))){return a5.ThrowError(400,null,{mixinNM:c[f].namespace(),instNM:h.namespace(),clsNM:d.namespace()})}}}}}},initializeMixins:function(h){var g=h,c=h.constructor._mixinRef,f,e,j,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinProps!==b){c[f]._a5_mixinProps.call(g)}}for(f=0,e=c.length;f<e;f++){c[f]._a5_instanceConst.call(g)}}},mixinsReady:function(g){var c=g.constructor._mixinRef,f,e,h,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinMustMix!==b){for(h in c[f]._a5_mixinMustMix){d=c[f]._a5_mixinMustMix[h];if(!inst.doesMix(a5.GetNamespace(d))){return a5.ThrowError(401,null,{nm:c[f].namespace(),cls:d})}}}if(typeof c[f]._mixinDef.mixinReady==="function"){c[f]._mixinDef.mixinReady.call(g)}}}},applyMixins:function(p,o,d,n){var e={},o=typeof o==="string"?[o]:o,q=[],m,h,g,f,r;for(m=0,f=o.length;m<f;m++){r=a5.GetNamespace(o[m],typeof d==="function"?d():d);if(!r){return a5.ThrowError(404,null,{mixin:o[m]})}q.push(r);for(h=0,g=p.constructor._mixinRef.length;h<g;h++){if(p.constructor._mixinRef[h]===r){return a5.ThrowError(402,null,{nm:r.namespace()})}}for(var c in r._mixinDef){if(c!=="dealloc"&&c!=="Properties"&&c!=="mixinReady"&&c!=="MustExtend"&&c!=="Contract"){if(e[c]===b){if(n===b){p.constructor._a5_mixedMethods[c]=r._mixinDef[c]}p[c]=r._mixinDef[c];e[c]="mixed"}else{return a5.ThrowError(403,null,{method:c})}}}if(n){a5.core.mixins.initializeMixins(n,q,n)}else{p.constructor._mixinRef.push(r)}}}});a5.SetNamespace("a5.core.errorHandling",true,function(){var d=null;this.ThrowError=function(e,h,g){var f=typeof e,j;if(f==="string"){j=e}else{if(f==="number"){if(a5.GetNamespace("a5.ErrorDefinitions",null,true)){var j=a5.ErrorDefinitions[e];if(!j){j="Invalid error id "+e+" thrown: error not defined."}}else{j="Error id "+e+" thrown. Include a5.ErrorDefinitions for verbose information."}e=a5.Create(h||a5.Error,[j,a5.Error.FORCE_CAST_ERROR])}}if(j){e=a5.Create(h||a5.Error,[(g?c(j,g):j),a5.Error.FORCE_CAST_ERROR])}d=e;throw e};this._a5_getThrownError=function(){var e=d;d=null;return e};var c=function(f,e){for(var g in e){f=f.replace(new RegExp("{"+g+"}","g"),e[g])}return f}});a5.ThrowError=a5.core.errorHandling.ThrowError;a5._a5_getThrownError=a5.core.errorHandling._a5_getThrownError;a5.Package("a5").Prototype("Object",function(d,c){d.Object=function(){}});a5.Package("a5").Prototype("Attribute","singleton",function(e,c,d){e.Attribute=function(){}});a5.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(e,d,c){c.RETURN_NULL="_a5_aspectReturnsNull";c.SUCCESS="_a5_aspectSuccess";c.ASYNC="_a5_aspectAsync";c.FAILURE="_a5_aspectFailure";c.NOT_IMPLEMENTED="_a5_notImplemented";e.AspectAttribute=function(){e.superclass(this)};e.before=function(j,f,g,m,k,h){return c.NOT_IMPLEMENTED};e.after=function(k,g,h,n,m,j,f){return c.NOT_IMPLEMENTED};e.around=function(){return c.NOT_IMPLEMENTED}});a5.Package("a5").Class("AspectCallArguments",function(m,k,h){var c,f,e,j,n,g,d;m.AspectCallArguments=function(s,p,q,u,t,r,o){c=s;f=p;e=q;j=u;n=t;g=r;d=o};m.rules=function(){return c};m.args=function(){return f};m.scope=function(){return e};m.method=function(){return j};m.callback=function(){return n};m.callOriginator=function(){return g};m.beforeArgs=function(){return d}});a5.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(d,c,g){d.ContractAttribute=function(){d.superclass(this)};d.Override.before=function(k){var m=null,n=false,j=function(o){o.message='Contract type failure on method "'+k.method().getName()+'" '+o.message;return o};if(k.rules().length>1){for(i=0,l=k.rules().length;i<l;i++){m=e(k.rules()[i],k.args());if(m instanceof a5.ContractException){d.throwError(j(m));return a5.AspectAttribute.FAILURE}if(m!==false){n=true;m.overloadID=i;break}}}else{n=true;m=e(k.rules()[0],k.args(),true);if(m instanceof a5.ContractException){d.throwError(j(m));return a5.AspectAttribute.FAILURE}}if(!n||m===false){d.throwError(j(d.create(a5.ContractException,["no matching overload found"])));return a5.AspectAttribute.FAILURE}else{return m}};var e=function(p,k){var o={},n=0,j,q,m;for(q in p){m=p[q];j=h((n<k.length?k[n]:b),m,n);if(j instanceof a5.ContractException){return j}o[q]=j;n++}if(k.length>n){return false}if(k.length===0){if(n===0){return o}return false}return o},h=function(k,p,q){var o="type",m=false,r=null,n,j;if(p.indexOf("=")!=-1){n=p.split("=");p=n[0];m=true;r=n[1]}else{if(m){return d.create(a5.ContractException,["for argument "+q+", required values cannot be defined after optional values"])}}if(p.indexOf(".")!==-1){o="class"}if(p==="array"){o="array"}if(p==="object"){o="object"}if(o!=="class"){p=p.toLowerCase()}if(k===b){if(m){k=f(p,o,r,q)}else{return d.create(a5.ContractException,["for argument "+q+', missing required argument of type "'+p+'"'])}}if(k!==b&&k!==null){switch(o){case"class":j=a5.GetNamespace(p);if(j.isInterface()){if(!(k.doesImplement(j))){return d.create(a5.ContractException,["for argument "+q+", must implement interface "+p])}}else{if(!(k instanceof j)){return d.create(a5.ContractException,["for argument "+q+", must be an instance of type "+p])}}break;case"type":if(k!==null&&typeof k!==p){return d.create(a5.ContractException,["for argument "+q+", must be of type "+p])}break;case"array":if(Object.prototype.toString.call(k)!=="[object Array]"){return d.create(a5.ContractException,["for argument "+q+", must be an array"])}break;case"object":if(k._a5_initialized!==b||typeof k!=="object"||k instanceof Array){return d.create(a5.ContractException,["for argument "+q+", must be a generic object"])}break}}return k},f=function(k,j,q,m){var p,o=false;if(k==="string"){var n=q.charAt(0);if(n===q.charAt(q.length-1)){if(n==='"'||n==="'"){p=q.substr(1,q.length-2)}else{o=true}}else{o=true}}else{if(k==="number"){if(!isNaN(q)){p=parseInt(q)}else{o=true}}else{if(j==="class"){if(q==="null"){p=null}else{o=true}}else{if(k==="boolean"||k==="array"||k==="function"||k==="object"){switch(q){case"{}":if(k==="object"){p={}}else{o=true}break;case"[]":if(k==="array"){p=[]}else{o=true}break;case"null":p=null;break;case"true":if(k==="boolean"){p=true}else{o=true}break;case"false":if(k==="boolean"){p=false}else{o=true}break;default:o=true}}else{o=true}}}}if(o){return d.create(a5.ContractException,["for argument "+m+', invalid default value for data type "'+k+'"'])}else{return p}}});a5.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(c){c.PropertyMutatorAttribute=function(){c.superclass(this)};c.Override.before=function(f){if(f.args().length){var d=f.rules()[0].validate,e=false;if(d){if(d.indexOf(".")!==-1){e=true;var d=a5.GetNamespace(d);if(!d){return a5.AspectAttribute.FAILURE}}var h=e?(f.args()[0] instanceof d):(typeof f.args()[0]===d);if(!h){return a5.AspectAttribute.FAILURE}}f.scope()[f.rules()[0].property]=f.args()[0];return a5.AspectAttribute.SUCCESS}var g=f.scope()[f.rules()[0].property]||null;return g===null||g===b?a5.AspectAttribute.RETURN_NULL:g};c.Override.after=function(d){if(d.beforeArgs().length){return d.scope()}else{return a5.AspectAttribute.SUCCESS}}});a5.Package("a5").Static(function(c){c.DESTROYED="Destroyed"}).Prototype("Event",function(c){this.Properties(function(){this._a5_type=null;this._a5_data=null;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false});c.Event=function(e,d,f){this._a5_type=e;this._a5_data=f||null;this._a5_bubbles=d!==false};c.cancel=function(d){if(d===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};c.target=function(){return this._a5_target};c.currentTarget=function(){return this._a5_currentTarget};c.type=function(){return this._a5_type};c.data=function(){return this._a5_data};c.phase=function(){return this._a5_phase};c.bubbles=function(){return this._a5_bubbles};c.shouldRetain=function(d){if(typeof d==="boolean"){this._a5_shouldRetain=d;return this}return this._a5_shouldRetain};c.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});a5.Package("a5").Static("EventPhase",function(c){c.CAPTURING=1;c.AT_TARGET=2;c.BUBBLING=3});a5.Package("a5").Extends(Error).Prototype("Error",function(d,c,e){e.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this._a5_isWindowError=false;this.name=this.type=this.className()});d.Error=function(m,g){if(g===false){this._a5_isWindowError=true}if(typeof m==="string"){this.message=m}else{g=m}if(g instanceof e){if(g.stack){this.stack=g.stack.split("\n")}this.line=g.lineNumber;this.url=g.fileName;if(g.message&&this.message===""){this.message=g.message}}else{if(g!==false){try{__undefined__()}catch(n){if(n.stack){var f=n.stack.indexOf("@http")!==-1;this.stack=n.stack.split("\n");this.stack=this.stack.splice(4);if(f){for(var j=0;j<this.stack.length;j++){this.stack[j]=this.stack[j].substr(this.stack[j].indexOf("@http"))}}}else{var k=[];try{var j=0,h=this.init.caller.caller.caller;do{for(j=0,l=k.length;j<l;j++){if(k[j]===h){h=null}}if(h){if(h.toString().indexOf(e.FORCE_CAST_ERROR)===-1){this.stack.push(h.toString().replace(/;/g,";<br/>").replace(/{/g,"{<br/>").replace(/}/g,"}<br/>")+"<br/><br/>")}k.push(h);h=h.caller;j++}}while(h&&j<=50)}catch(n){}}}}}};d.isWindowError=function(){return this._a5_isWindowError};d.Override.toString=function(){return this.type+": "+this.message}});a5.Package("a5").Extends("Error").Prototype("AssertException",function(c){c.AssertException=function(){c.superclass(this,arguments);this.type="AssertException"}});a5.Package("a5").Extends("Error").Prototype("ContractException",function(c){c.ContractException=function(){c.superclass(this,arguments);this.type="ContractException"}});a5.Package("a5").Static(function(c){c.ADD="eventDispatcherAdd";c.REMOVE="eventDispatcherRemove"}).Prototype("EventDispatcher","abstract",function(e,c,d){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});e.EventDispatcher=function(){};e.autoPurge=function(f){if(typeof f==="boolean"){this._a5_autoPurge=f;return this}return this._a5_autoPurge};e.addEventListener=function(h,j,f,g){this._a5_addEventListener(h,j,f,g)};e.addOneTimeEventListener=function(h,j,f,g){this._a5_addEventListener(h,j,f,g,true)};e.hasEventListener=function(q,f){var p=q.split("|"),r=this.cl(),o,k,h,n,g;for(o=0,k=p.length;o<k;o++){h=this._a5_getListenerArray(p[o]);if(h){for(n=0,g=h.length;n<g;n++){if(h[n].type==p[o]&&(typeof f==="function"?(h[n].method==f):true)){return true}}}}return false};e.removeEventListener=function(t,f,h,u,p){var s=t.split("|"),g=true,r,o,n,q,k;u=u||null;p=p||false;h=h===true;for(r=0,o=s.length;r<o;r++){n=this._a5_getListenerArray(s[r]);if(n){for(q=0,k=n.length;q<k;q++){if(n[q].method===f&&n[q].type===s[r]&&n[q].useCapture===h&&n[q].isOneTime===p){n.splice(q,1);k=n.length}}this.eListenersChange({type:s.length>1?s:s[0],method:f,useCapture:h,changeType:d.REMOVE})}}};e.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};e.getTotalListeners=function(g){if(typeof g==="string"){var f=this._a5_getListenerArray(g);if(f){return f.length}else{return 0}}else{var h=0;for(var j in this._a5_listeners){h+=this._a5_listeners[j].length}return h}};e.dispatchEvent=function(g,h,f){var j=this._a5_createEvent(g,h,f);j._a5_phase=a5.EventPhase.AT_TARGET;this._a5_dispatchEvent(j);if(!j.shouldRetain()){j.destroy()}j=null};e.eListenersChange=function(f){};e._a5_addEventListener=function(t,f,u,v,w){var x=v||null,s=t.split("|"),p=w||false,h=u===true,g=true,r,o,n,q,k;if(s.length!=0&&f!=b){for(r=0,o=s.length;r<o;r++){n=this._a5_getListenerArray(s[r],true);for(q=0,k=n.length;q<k;q++){if(n[q].method===f&&n[q].type===s[r]&&n[q].useCapture===h&&n[q].scope===x&&n[q].isOneTime===p){g=false;break}}if(g){n.push({type:s[r],method:f,scope:x,useCapture:h===true,isOneTime:p})}}this.eListenersChange({type:s.length>1?s:s[0],method:f,changeType:d.ADD})}else{throw"invalid listener: type- "+t+", method- "+f}};e._a5_createEvent=function(g,h,f){var j=(typeof g==="string")?a5.Create(a5.Event,[g,f]):g;if(j instanceof a5.Event||j.doesExtend&&j.doesExtend(a5.Error)){j._a5_target=this;if(h){j._a5_data=h}return j}throw"Invalid event type."};e._a5_dispatchEvent=function(k){k._a5_currentTarget=this;if(this._a5_listeners){var m=this._a5_getListenerArray(k.type()),h,f,g,j;if(m){for(h=0,f=m.length;h<f;h++){g=m?m[h]:null;if(k._a5_canceled||!g){return}j=(k.phase()===a5.EventPhase.CAPTURING&&g.useCapture)||(k.phase()!==a5.EventPhase.CAPTURING&&!g.useCapture),validListener=typeof g.method==="function"&&(g.scope&&g.scope.namespace?g.scope._a5_initialized:true);if(j&&validListener){g.method.call(g.scope,k)}if(g.isOneTime===true||(!validListener&&this._a5_autoPurge)){m.splice(h,1);h--;f--}}}}};e._a5_getListenerArray=function(g,f){if(this._a5_listeners[g]===b){if(f===true){this._a5_listeners[g]=[];return this._a5_listeners[g]}return null}return this._a5_listeners[g]};e.dealloc=function(){this.dispatchEvent(a5.Create(a5.Event,[a5.Event.DESTROYED]));this.removeAllListeners();this._a5_listeners=null}});a5.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'Mixin "{mixinNM}" requires mixing object "{instNM}" to extend class "{clsNM}" .',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(this);