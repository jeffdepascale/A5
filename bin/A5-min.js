//A5, Copyright (c) 2011, Jeff dePascale & Brian Sutliffe. http://www.jeffdepascale.com(function(a,b){(function(){var e=null,c=function(p,m,j){var q,o,k,n;if(!p){return null}j=j||false;if(typeof p==="object"){return p}q=p.split(".");n=a;if(q.length===1&&m&&m[p]){return m[p]}for(o=0,k=q.length;o<k;o++){n=n[q[o]];if(n===b){return null}}if(j||n.namespace!==b){return n}return null},g=function(k,p,o){var r=typeof p==="boolean",n=r?p:false,q,j=(r?o:p)||{},q=k.split("."),s=q.pop(),m;if(!k.match(/^[A-Za-z0-9.]*$/)){return a5.ThrowError(100,null,{namespace:k})}m=q.length?f(q):a;if(m[s]!==b){return m[s]}return m[s]=n?new j():j},f=function(n){var m=a,k,j;for(k=0,j=n.length;k<j;k++){if(!m[n[k]]){m[n[k]]={}}m=m[n[k]]}return m},h=function(){e={};for(var j in a){e[j]=""}},d=function(j){if(!e){a5.ThrowError(101)}else{var m=[],k;for(k in a){if(e[k]===b){m.push(k)}}if(j===true){h()}return m}};a.a5={version:function(){return"0.5.{BUILD_NUMBER}"},buildDate:function(){return"{BUILD_DATE}"},isStableRelease:function(){return false},releaseType:function(){return"alpha"},isPublicRelease:function(){return false},versionInfo:function(){return("A5 - version "+this.version()+", "+this.releaseType()+", "+this.buildDate()+". "+(this.isPublicRelease()?"Public release":"Development build")+". "+(this.isStableRelease()?"Stable release":"Unstable release")+".")},GetNamespace:c,SetNamespace:g,TrackWindowStrays:h,GetWindowStrays:d,CreateGlobals:function(){a.Create=a5.Create;a.Package=a5.Package;a.GetNamespace=a5.GetNamespace;a.SetNamespace=a5.SetNamespace;a.ThrowError=a5.ThrowError}}})();a5.SetNamespace("a5.core.reflection",true,function(){var c={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},d=function(e,g,h,f){f=f||g[h];f._a5_ownerInstance=g;f._a5_ownerClass=e;f._a5_methodName=h;f.getName=c.getName;f.getClass=c.getClass;f.getClassInstance=c.getClassInstance;f.getAttributes=c.getAttributes};return{setReflection:d}});a5.SetNamespace("a5.core.attributes",true,function(){createAttribute=function(x,r){var h=Array.prototype.slice.call(r),d,m,g,f,e,w,u={};if(!h.length){return a5.ThrowError(305)}d=typeof h[h.length-1]==="function"?h.pop():null;if(d!==null&&typeof d!=="function"){return a5.ThrowError(300)}if(!h.length){return a5.ThrowError(301)}for(m=0,e=h.length;m<e;m++){var o=h[m];if(Object.prototype.toString.call(o)!=="[object Array]"){return a5.ThrowError(302)}for(g=0,f=o.length;g<f;g++){var q=o[g],w=typeof q;if(g==0){var p=false;if(w!=="string"){if(w==="function"){if(!q.isA5||!q.doesExtend(a5.Attribute)){p=true}}else{p=true}}else{var v=a5.GetNamespace(q,x.imports());if(!v){v=a5.GetNamespace(q+"Attribute",x.imports())}if(v){o[g]=v}else{p=true}}if(p){return a5.ThrowError(303)}}else{if(w!=="object"||Object.prototype.toString.call(q)==="[object Array]"){return a5.ThrowError(304)}}}}for(m=0,e=h.length;m<e;m++){var n=h[m],s=[];for(var g=1,f=n.length;g<f;g++){s.push(n[g])}h[m]=[n[0],s];u[n[0].className()]=s}u.wrappedMethod=d;var c=function(){var z,j,I=[],D=this,z,B=0;if(d){for(var j in c){d[j]=c[j]}}if(c.caller.getClassInstance!==b){z=c.caller}for(var A=0,y=h.length;A<y;A++){var H=h[A][0],F=H.instance(true),E=h[A][1];I.push({cls:F,props:E})}var C=function(J,K,L){k(B,J,K,L)},k=function(P,K,L,N){if(K){if(Object.prototype.toString.call(K)!=="[object Array]"){K=[K]}}else{K=[]}if(!N){N=K}if(P>=I.length){if(L){return K[0]}else{return t(K,N)}}var J,L=L||false,M=false,O=function(Q){C.call(this,Q||K,L,N)};J=I[P].cls.around(I[P].props,K,D,c,O,z,N);if(J===a5.AspectAttribute.NOT_IMPLEMENTED){J=I[P].cls[(L?"after":"before")](I[P].props,K,D,c,O,z,N)}if(J!==null&&J!==b){switch(J){case a5.Attribute.SUCCESS:J=K;break;case a5.Attribute.ASYNC:M=true;break;case a5.Attribute.RETURN_NULL:J=null;break;case a5.Attribute.FAILURE:return}}else{return a5.ThrowError(308,null,{prop:j,method:L?"methodPost":"methodPre"})}B=P+1;if(!M){return k(B,J,L,K,N)}},t=function(J,K){B=0;var L=d?d.apply(D,J):J.length?J[0]:b;return k(0,L,true,K)},G=k(B,Array.prototype.slice.call(arguments));return G};c._a5_attributes=u;return c},createAttribs=function(){for(i=0,l=a5.Attribute._extenderRef.length;i<l;i++){a5.Create(a5.Attribute._extenderRef[i])}},processInstance=function(c){var d=c.getClass().getAttributes();return c};return{createAttribute:createAttribute,processInstance:processInstance}});a5.SetNamespace("a5.core.classBuilder",true,function(){var f=[],e=false,d=[],c=[],g;Create=function(j,h){var k,m;if(typeof j==="string"){k=a5.GetNamespace(j);if(k===null){return a5.ThrowError(207,null,{className:j})}}else{k=j}if(typeof k!=="function"){return a5.ThrowError(207,null,{className:j})}if(k.isInterface()){return a5.ThrowError(208,null,{nm:k.namespace()})}try{m=new k()}catch(n){return a5.ThrowError(209,null,{nm:typeof j==="string"?j:(j.namespace?j.namespace():""),errorStr:n})}if(k._a5_clsDef){processDeclaration(k._a5_clsDef,m,m,k.imports(),k)}m._a5_initialize(h);return m},processDeclaration=function(h,m,o,j,k,n){if(n){m.Properties=function(p){o.constructor._a5_protoProps=p};m.PrivateProperties=function(p){o.constructor._a5_protoPrivateProps=p;return function(q){return q._a5_privatePropsRef[o.namespace()]}}}m.Attributes=function(){return a5.core.attributes.createAttribute.call(o,m,arguments)};o.Override={};o.Final={};h.call(m,o,j,k);a5.core.mixins.prepareMixins(o);processMethodChangers(o);for(g in o){if(({}).hasOwnProperty.call(o,g)&&typeof o[g]==="function"&&a5.core.classProxyObj[g]===b){if(g===o.className()){o.constructor._a5_instanceConst=o[g];a5.core.reflection.setReflection(k,o,g,o.constructor._a5_instanceConst);delete o[g]}else{a5.core.reflection.setReflection(k,o,g)}}}delete o.Final;delete o.Override;delete m.Attributes;if(n){delete m.Properties;delete m.PrivateProperties}},processMethodChangers=function(k){var m=k.superclass(),h=k.constructor._a5_mixedMethods;if(!m){m={}}for(g in k){if(k.hasOwnProperty(g)&&typeof k[g]==="function"){if(g!=="Final"&&g!=="Override"&&g!=="constructor"&&g!=="prototype"&&g!=="dealloc"&&g!=="_a5_initialized"){if(m[g]&&m[g].toString().indexOf("[native code]")===-1){if(m[g].Final==true){return a5.ThrowError(201,null,{prop:g,namespace:k.namespace()})}return a5.ThrowError(200,null,{prop:g,namespace:k.namespace()})}else{var j=h[g];if(h[g]!==b&&j!==k[g]){return a5.ThrowError(220,null,{prop:g,namespace:k.namespace()})}}}}}for(g in k.Override){if(m[g]===b&&h[g]===b){return a5.ThrowError(202,null,{prop:g,namespace:k.namespace()})}if(m[g]&&m[g].Final===true||h[g]&&h[g].Final===true){return a5.ThrowError(203,null,{prop:g,namespace:k.namespace()})}k[g]=k.Override[g]}for(g in k.Final){k[g]=k.Final[g];k[g].Final=true}},Package=function(n){var E,t,h,o,m,v,q,j,p=false,D=false,r=false,z=false,y=false,u=function(){var I=_a5_processImports(E,n),K={pkg:n,imports:E,clsName:t,cls:h,base:o,type:m,proto:v,implement:q,mixins:j,staticMethods:p,isInterface:r,isMixin:D,enumDeclaration:z,isProto:y},J=a5.core.verifiers.validateClassDependencies(o,I,j,q,r,D);if(J===true){processClass(K)}else{f.push({pkg:K,reason:J.reason,reasonNM:J.reasonNM})}u=s=F=B=G=k=A=x=H=C=w=null},s=function(){E=Array.prototype.slice.call(arguments);return{Prototype:x,Static:G,Mixin:H,Mix:C,Extends:F,Implements:B,Interface:k,Class:A}},F=function(I){o=I;return{Prototype:x,Static:G,Import:s,Mix:C,Implements:B,Interface:k,Class:A}},C=function(){j=Array.prototype.slice.call(arguments);return{Prototype:x,Static:G,Extends:F,Implements:B,Interface:k,Class:A}},B=function(I){q=Array.prototype.slice.call(arguments);return{Prototype:x,Static:G,Mix:C,Import:s,Extends:F,Class:A}},G=function(I,J){if(typeof I==="string"){t=I;p=J;u()}else{p=I;return{Prototype:x,Implements:B,Mix:C,Mixin:H,Import:s,Extends:F,Class:A}}},k=function(J,I){t=J;h=I;r=true;u()},H=function(J,I){t=J;h=I,D=true;u()},w=function(I,J){t=I;z=J;u()},A=function(L,K,J){t=L;var I=(typeof K==="string");h=I?J:K;m=I?K:b;u()},x=function(L,K,J){y=true;t=L;var I=(typeof K==="string");v=I?J:K;m=I?K:b;u()};a5.SetNamespace(n);return{Enum:w,Static:G,Import:s,Extends:F,Mixin:H,Mix:C,Implements:B,Class:A,Prototype:x,Interface:k}},Extend=function(u,p,w,k,s,A,D,h){if(s){if(p&&!p.isInterface()){return a5.ThrowError('Interface "'+u+'" cannot extend "'+p.namespace()+'", base class is not an interface.')}p=null}var j=function(){},q=A===false||false,E=false,t=false,z=null,y=u.lastIndexOf("."),m=y>-1?u.substring(0,y):"",v=y>-1?u.substring(y+1):u,o,r,n,F,C,x;if(!p||p===b){p=j}r=function(){};if(k){o=k.split(/[ |]/);for(C=0,x=o.length;C<x;C++){if(o[C]=="final"){q=true}else{if(o[C]=="singleton"){E=true}else{if(o[C]=="abstract"){t=true}}}}}if(a5.core.verifiers.checkNamespaceValid(u)){if(!p.isFinal||(p.isFinal()!=true)){if(p===Error){var B={};B.prototype=new p();r.prototype=B;B=null}else{r.prototype=new p()}z=p}else{return a5.ThrowError("Cannot extend "+p.namespace()+", class marked as final.")}}else{return a5.ThrowError("Cannot create new class in namespace "+u+", definition already exists.")}n=r.prototype;F=n.constructor=r;if(p.prototype.constructor._extenderRef){p.prototype.constructor._extenderRef.push(r)}F._a5_superclass=z;F._a5_pkg=m;F._a5_clsDef=w;F._a5_clsName=v;F._a5_namespace=u;F._a5_imports=D;F._a5_isFinal=q;F._a5_isAbstract=t;F._a5_isSingleton=E;F._a5_isInterface=s;F._a5_isPrototype=A||false;F._mixinRef=p.prototype.constructor._mixinRef?p.prototype.constructor._mixinRef.slice(0):[];F._implementsRef=p.prototype.constructor._implementsRef?p.prototype.constructor._implementsRef.slice(0):[];F._a5_mixedMethods={};F._a5_instance=null;F._instanceCount=0;F._extenderRef=[];n._a5_initialized=false;for(g in a5.core.classProxyObj.construct){F[g]=a5.core.classProxyObj.construct[g]}if(p.namespace===b){for(g in a5.core.classProxyObj.instance){n[g]=a5.core.classProxyObj.instance[g]}}if(h){a5.core.mixins.applyMixins(n,h,D)}return a5.SetNamespace(u,r)},processQueue=function(){var h=false,n,k;for(n=0;n<f.length;n++){var o=f[n].pkg,j=_a5_processImports(o.imports,o.pkg),m=a5.core.verifiers.validateClassDependencies(o.base,j,o.mixins,o.implement);if(m===true){processClass(o,true);f.splice(n,1);n--;h=true}else{f[n].reason=m.reason;f[n].reasonNM=m.reasonNM}}if(h){processQueue()}},processProtoClass=function(k){var j=k.obj,h=k.pkgObj;processDeclaration(h.proto,j,j.prototype,j.imports(),j,true)},processClass=function(q,m){var h=function(){return _a5_processImports(q.imports,q.pkg)},j=(typeof q.base==="function")?q.base:a5.GetNamespace(q.base,h()),n=Extend(q.pkg+"."+q.clsName,j,q.cls,q.type,q.isInterface,q.isProto,h,q.mixins),r=m||false,u=true,o,k;if(q.staticMethods){q.staticMethods(n,h())}if(q.proto&&e){d.push({obj:n,pkgObj:q});if(q.implement){c.push({pkgObj:q,obj:n})}}else{if(q.proto){processProtoClass({obj:n,pkgObj:q})}if(q.implement){u=a5.core.verifiers.validateImplementation(q,n)}}if(!u){return}if(q.enumDeclaration){var p=0,s=[];q.enumDeclaration({startIndex:function(v){p=v},addValue:function(v){s.push(v)}});for(o=0,k=s.length;o<k;o++){n[s[o]]=p++}n.addValue=function(v){if(n[v]===b){n[v]=p++}};n.getValue=function(v){for(g in n){if(n[g]===v){return g}}return null}}if(q.isInterface){n.interfaceVals={};if(q.base!==null&&q.base!==b){var t=a5.GetNamespace(q.base,n.imports());if(t.isInterface()){for(g in t.interfaceVals){if(n.interfaceVals[g]===b){n.interfaceVals[g]=t.interfaceVals[g]}}}else{a5.ThrowError(204,null,{objNM:n.namespace(),clsNM:t.namespace()})}}q.cls.call(n.interfaceVals,n.interfaceVals)}if(q.isMixin){n._mixinDef={Properties:function(v){n.prototype.constructor._a5_mixinProps=v},Contract:function(v,w){return a5.core.contracts.createContract(v,w)},MustExtend:function(){n.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){n.prototype.constructor._a5_mixinMustMix=arguments}};q.cls.call(n._mixinDef,n._mixinDef,n.imports(),n);if(typeof n._mixinDef[n.className()]==="function"){n._a5_instanceConst=n._mixinDef[n.className()];delete n._mixinDef[n.className()]}else{a5.ThrowError(205,null,{nm:n.namespace()})}delete n._mixinDef.Properties;delete n._mixinDef.Contract;delete n._mixinDef.MustExtend;delete n._mixinDef.MustMix}if(!r){processQueue()}},_a5_processImports=function(k,j,h){return(function(t,v){var q={},m=h||false,n=[],s,p,u=function(x){var y;for(g in x){y=x[g];if(typeof y==="function"&&y.namespace!=b&&q[g]===b){q[g]=y}}};q.rebuild=function(){if(n.length){var y={},A=_a5_processImports(n,null,true),x=A.retObj,z=A.rebuildArray;for(g in q){y[g]=q[g]}for(g in x){if(y[g]===b){q[g]=y[g]=x[g]}}n=z;return y}else{return q}};if(v){u(a5.GetNamespace(v,null,true))}if(t){var w,v,o;for(s=0,p=t.length;s<p;s++){w=t[s],isWC=false,dotIndex=w.lastIndexOf(".");if(w.charAt(w.length-1)=="*"){isWC=true}if(isWC){v=a5.GetNamespace(w.substr(0,w.length-2),null,true);u(v)}else{o=dotIndex>-1?w.substr(dotIndex+1):w;var r=a5.GetNamespace(w);if(r){if(q[o]===b){q[o]=r}}else{n.push(w)}}}}if(m){return{retObj:q,rebuildArray:n}}return q})(k,j)},_a5_verifyPackageQueueEmpty=function(){if(f.length){var k="",j,h;for(j=0,h=f.length;j<h;j++){k+='"'+f[j].pkg.pkg+"."+f[j].pkg.clsName+'", '+f[j].reason+' class missing: "'+f[j].reasonNM+'"'+(f.length>1&&j<f.length-1?", \n":"")}a5.ThrowError(206,null,{classPlural:f.length==1?"class":"classes",clsString:k})}},_a5_delayProtoCreation=function(h){e=h},_a5_createQueuedPrototypes=function(){for(var j=0,h=d.length;j<h;j++){processProtoClass(d[j])}d=[];for(j=0,h=c.length;j<h;j++){a5.core.verifiers.validateImplementation(c[j].pkgObj,c[j].obj)}c=[]};return{Create:Create,Package:Package,_a5_processImports:_a5_processImports,_a5_processImports:_a5_processImports,_a5_verifyPackageQueueEmpty:_a5_verifyPackageQueueEmpty,_a5_delayProtoCreation:_a5_delayProtoCreation,_a5_createQueuedPrototypes:_a5_createQueuedPrototypes}});a5.Create=a5.core.classBuilder.Create;a5.Package=a5.core.classBuilder.Package;a5._a5_processImports=a5.core.classBuilder._a5_processImports;a5._a5_verifyPackageQueueEmpty=a5.core.classBuilder._a5_verifyPackageQueueEmpty;a5._a5_delayProtoCreation=a5.core.classBuilder._a5_delayProtoCreation;a5._a5_createQueuedPrototypes=a5.core.classBuilder._a5_createQueuedPrototypes;a5.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(c){return c?a5.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports?this._a5_imports():{}},doesImplement:function(c){return a5.core.verifiers.checkImplements(this,c)},doesExtend:function(c){return a5.core.verifiers.checkExtends(this,c)},doesMix:function(c){return a5.core.verifiers.checkMixes(this,c)},getAttributes:function(){return this._a5_attributes},instance:function(c){if(c===true){return this._a5_instance||a5.Create(this)}else{return this._a5_instance}},superclass:function(e,c){if(e!==b){if(typeof e==="object"&&e.isA5===true){if(typeof c!=="object"){c=[]}if(!this._a5_superclass.className){return a5.ThrowError(210)}var d=this._a5_superclass.prototype.constructor._a5_instanceConst;if(d){d.apply(e,c)}else{a5.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{a5.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},autoRelease:function(d){if(d!==b){var e=new Date().getTime(),c=this;this._a5_ar[e]=d;return function(){return c._a5_ar[e]}}},superclass:function(d,c){return this.constructor.superclass(d,c)},mixins:function(c){if(c!==b){return GetNamespace(c,this.imports())}else{return this.constructor._a5_mixedMethods}},mix:function(c){a5.core.mixins.applyMixins(this,c,this.imports(),this)},getMethods:function(d,e){var c=[];for(var f in this){if((d||({}).hasOwnProperty.call(this,f))&&typeof(this[f])==="function"&&a5.core.classProxyObj.instance[f]===b&&f.substr(0,4)!=="_a5_"&&(e||f.substr(0,1)!=="_")){c.push(f)}}return c},getProperties:function(d,f){var c=[],e=function(k,m){var h=k;while(h!==null){if(h.constructor._a5_protoProps!==b){var j={};h.constructor._a5_protoProps.call(j);if(j[m]!==b){return true}}h=h.constructor.superclass&&h.constructor.superclass().constructor.namespace?h.constructor.superclass():null}return false};for(var g in this){if((d||!e(this,g))&&typeof(this[g])!=="function"&&a5.core.classProxyObj.instance[g]===b&&g.substr(0,4)!=="_a5_"&&(f||g.substr(0,1)!=="_")){c.push(g)}}return c},classPackage:function(){return this.constructor.classPackage()},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(c){return this.constructor.doesImplement(c)},doesExtend:function(c){return this.constructor.doesExtend(c)},doesMix:function(c){return this.constructor.doesMix(c)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){if((this.namespace()==="a5.cl.CL"||this.classPackage().indexOf("a5.cl.core")!==-1)&&!this.classPackage()==="a5.cl.core.viewDef"){a5.ThrowError(215,null,{nm:this.namespace()});return}this._a5_initialized=false;var g=this,h,e,c,j,f,d;while(g!==null){c=g.constructor._mixinRef;if(c&&c.length){for(f=0,d=c.length;f<d;f++){if(c[f]._mixinDef.dealloc!=b){c[f]._mixinDef.dealloc.call(this)}}}if(g.constructor.namespace){e=g.constructor.superclass?g.constructor.superclass():null;if(e&&e.dealloc!==g.dealloc){g.dealloc.call(this)}g=e}else{g=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}for(j in this._a5_ar){delete this._a5_ar[j]}for(j in this){if(({}).hasOwnProperty.call(this,j)&&typeof this.constructor.prototype[j]==="undefined"&&j!=="_a5_initialized"&&j!=="_a5_instanceUID"){this[j]=null}}}},_a5_initialize:function(j){if(!this._a5_initialized){if(this.constructor.isAbstract()&&this._a5_initialize.caller.caller!==Extend){return a5.ThrowError(216,null,{nm:this.constructor.namespace()})}this._a5_initialized=true;if(this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return a5.ThrowError(217,null,{nm:this.constructor.namespace()})}this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;this._a5_ar={};var k=this,c=this,e=j||[],m=[],g,f,d,h;this._a5_privatePropsRef={};if(typeof this.constructor._a5_instanceConst!=="function"){return a5.ThrowError(218,null,{clsName:this.className()})}while(c!==null){if(c.constructor._a5_protoPrivateProps!==b){this._a5_privatePropsRef[c.namespace()]={};c.constructor._a5_protoPrivateProps.call(this._a5_privatePropsRef[c.namespace()])}if(c.constructor._a5_protoProps!==b){m.unshift(c.constructor._a5_protoProps)}c=c.constructor.superclass&&c.constructor.superclass().constructor.namespace?c.constructor.superclass():null}a5.core.mixins.initializeMixins(this);for(f=0,d=m.length;f<d;f++){m[f].call(this)}this.constructor._a5_instanceConst.apply(this,e);a5.core.mixins.mixinsReady(this);return true}else{return null}},create:a5.Create,throwError:function(){return a5.ThrowError.apply(this,arguments)},assert:function(d,c){if(d!==true){throw this.create(a5.AssertException,[c])}}}});a5.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(n,g){var h,f,c,j,s,o,m,d=function(t,e){for(var u in t){if(t[u]!==e[u]){return false}}return true};for(h=0,f=n.implement.length;h<f;h++){j=n.implement[h];try{s=new g;s.Override={};s.Final={};s.Attributes=function(){var u=Array.prototype.slice.call(arguments);var w=u.pop();for(var v=0,t=u.length;v<t;v++){var e=u[v][0];if(e==="Contract"||e==="ContractAttribute"||e===ar.ContractAttribute){w.attributes=u[v]}}return w};o=a5.GetNamespace(j,g.imports());if(g._a5_clsDef){g._a5_clsDef.call(s,s,g.imports(),g)}}catch(k){throw k;return false}if(!o.isInterface()){return a5.ThrowError(213,null,{implNM:o.namespace(),objNM:g.namespace()})}for(c in o.interfaceVals){m=s[c]!==b;var r=o.interfaceVals[c],p=s[c];if(m&&typeof r==="object"&&p.attributes&&(p.attributes[0]==="Contract"||p.attributes[0]==="ContractAttribute"||p.attributes[0]===a5.ContractAttribute)){var q=true;for(var h=0,f=r.length;h<f;h++){q=q&&p.attributes.length>=(h+1)?d(r[h],p.attributes[h+1]):false}if(!q){return a5.ThrowError(601,null,{intNM:o.namespace(),implNM:g.namespace(),method:c})}}else{if(!m||(m&&typeof o.interfaceVals[c]!==typeof s[c])){return a5.ThrowError(214,null,{implNM:o.namespace(),objNM:g.namespace()})}}}g._implementsRef.push(o);s.destroy()}return true},checkNamespaceValid:function(e){for(var d=0,c=this.namespaceArray.length;d<c;d++){if(this.namespaceArray[d]==e){return false}}this.namespaceArray.push(e);return true},checkImplements:function(d,m){if(typeof m==="string"){m=a5.GetNamespace(m)}var h=d._implementsRef,g,f,e,c;while(h){for(g=0,c=h.length;g<c;g++){if(h[g]===m){return true}}h=d.superclass()?d.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(c,f){var e=c._a5_superclass&&c._a5_superclass.prototype.className?c._a5_superclass:null;if(!e){return false}var d=(typeof f==="string")?a5.GetNamespace(f):f;if(!d){return false}while(e){if(e===d){return true}e=e._a5_superclass&&e._a5_superclass.prototype.className?e._a5_superclass:null}return false},checkMixes:function(d,f){if(typeof f==="string"){f=a5.GetNamespace(f)}if(!f){return false}for(var e=0,c=d._mixinRef.length;e<c;e++){if(d._mixinRef[e]===f){return true}}return false},validateClassDependencies:function(e,q,o,d,f,r){var p,k,n,j=null,c,g,s,h;if(e!==b){if(typeof e==="function"){j=e}else{j=a5.GetNamespace(e,q)}}p=true;if(e!==b&&!j){p=false;k="base";n=e}if(p&&o!==b){for(c in o){g=o[c];if(typeof g==="string"){s=a5.GetNamespace(g,q)}if(typeof s!=="function"){p=false;k="mixin";n=g}}}if(p&&d!==b){for(c in d){h=d[c];if(typeof h==="string"){s=a5.GetNamespace(h,q)}if(typeof s!=="function"){p=false;k="interface";n=h}}}return p?true:{reason:k,reasonNM:n}}});a5.SetNamespace("a5.core.mixins",{prepareMixins:function(h){var g=h,c=h.constructor._mixinRef,f,e,j,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinMustExtend!==b){for(j in c[f]._a5_mixinMustExtend){d=c[f]._a5_mixinMustExtend[j];if(!h.doesExtend(a5.GetNamespace(d,h.imports()))){return a5.ThrowError(400,null,{nm:c[f].namespace()})}}}}}},initializeMixins:function(h){var g=h,c=h.constructor._mixinRef,f,e,j,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinProps!==b){c[f]._a5_mixinProps.call(g)}}for(f=0,e=c.length;f<e;f++){c[f]._a5_instanceConst.call(g)}}},mixinsReady:function(g){var c=g.constructor._mixinRef,f,e,h,d;if(c.length){for(f=c.length-1,e=-1;f>e;f--){if(c[f]._a5_mixinMustMix!==b){for(h in c[f]._a5_mixinMustMix){d=c[f]._a5_mixinMustMix[h];if(!inst.doesMix(a5.GetNamespace(d))){return a5.ThrowError(401,null,{nm:c[f].namespace(),cls:d})}}}if(typeof c[f].mixinReady==="function"){c[f].mixinReady.call(g)}}}},applyMixins:function(k,j,d,h){var e={},j=typeof j==="string"?[j]:j,m=[],g,f,n;for(g=0,f=j.length;g<f;g++){n=a5.GetNamespace(j[g],typeof d==="function"?d():d);if(!n){return a5.ThrowError(404,null,{mixin:j[g]})}m.push(n);for(g=0;g<k.constructor._mixinRef.length;g++){if(k.constructor._mixinRef[g]===n){return a5.ThrowError(402,null,{nm:n.namespace()})}}for(var c in n._mixinDef){if(c!=="dealloc"&&c!=="Properties"&&c!=="mixinReady"&&c!=="MustExtend"&&c!=="Contract"){if(e[c]===b){if(h===b){k.constructor._a5_mixedMethods[c]=n._mixinDef[c]}k[c]=n._mixinDef[c];e[c]="mixed"}else{return a5.ThrowError(403,null,{method:c})}}}if(h){a5.core.mixins.initializeMixins(h,m,h)}else{k.constructor._mixinRef.push(n)}}}});a5.SetNamespace("a5.core.errorHandling",true,function(){var d=null;this.ThrowError=function(e,h,g){var f=typeof e,j;if(f==="string"){j=e}else{if(f==="number"){if(a5.GetNamespace("a5.ErrorDefinitions",null,true)){var j=a5.ErrorDefinitions[e];if(!j){j="Invalid error id "+e+" thrown: error not defined."}}else{j="Error id "+e+" thrown. Include a5.ErrorDefinitions for verbose information."}e=a5.Create(h||a5.Error,[j,a5.Error.FORCE_CAST_ERROR])}}if(j){e=a5.Create(h||a5.Error,[(g?c(j,g):j),a5.Error.FORCE_CAST_ERROR])}d=e;throw e};this._a5_getThrownError=function(){var e=d;d=null;return e};var c=function(f,e){for(var g in e){f=f.replace(new RegExp("{"+g+"}","g"),e[g])}return f}});a5.ThrowError=a5.core.errorHandling.ThrowError;a5._a5_getThrownError=a5.core.errorHandling._a5_getThrownError;a5.Package("a5").Prototype("Attribute","singleton",function(e,c,d){e.Attribute=function(){}});a5.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(e,d,c){c.RETURN_NULL="_a5_aspectReturnsNull";c.SUCCESS="_a5_aspectSuccess";c.ASYNC="_a5_aspectAsync";c.FAILURE="_a5_aspectFailure";c.NOT_IMPLEMENTED="_a5_notImplemented";e.AspectAttribute=function(){e.superclass(this)};e.before=function(){return c.NOT_IMPLEMENTED};e.after=function(){return c.NOT_IMPLEMENTED};e.around=function(){return c.NOT_IMPLEMENTED}});a5.Package("a5").Static("AspectAttributeTarget",function(c){c.ALL="_a5_aspectTargAll";c.METHOD="_a5_aspectTargMethod";c.CLASS="_a5_aspectTargClass"});a5.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(d,c,g){d.ContractAttribute=function(){d.superclass(this)};d.Override.before=function(o,k,m,r,q){var n=null,p=false,j=function(s){s.message='Contract type failure on method "'+r.getName()+'" '+s.message;return s};if(o.length>1){for(i=0,l=o.length;i<l;i++){n=e(o[i],k);if(n instanceof a5.ContractException){d.throwError(j(n));return a5.AspectAttribute.FAILURE}if(n!==false){p=true;n.overloadID=i;break}}}else{p=true;n=e(o[0],k,true);if(n instanceof a5.ContractException){d.throwError(j(n));return a5.AspectAttribute.FAILURE}}if(!p||n===false){d.throwError(j(d.create(a5.ContractException,["no matching overload found"])));return a5.AspectAttribute.FAILURE}else{return n}};var e=function(p,k){var o={},n=0,j,q,m;for(q in p){m=p[q];j=h((n<k.length?k[n]:b),m,n);if(j instanceof a5.ContractException){return j}o[q]=j;n++}if(k.length>n){return false}if(k.length===0){if(n===0){return o}return false}return o},h=function(k,p,q){var o="type",m=false,r=null,n,j;if(p.indexOf("=")!=-1){n=p.split("=");p=n[0];m=true;r=n[1]}else{if(m){return d.create(a5.ContractException,["for argument "+q+", required values cannot be defined after optional values"])}}if(p.indexOf(".")!==-1){o="class"}if(p==="array"){o="array"}if(p==="object"){o="object"}if(o!=="class"){p=p.toLowerCase()}if(k===b){if(m){k=f(p,o,r,q)}else{return d.create(a5.ContractException,["for argument "+q+', missing required argument of type "'+p+'"'])}}if(k!==b&&k!==null){switch(o){case"class":j=a5.GetNamespace(p);if(j.isInterface()){if(!(k.doesImplement(j))){return d.create(a5.ContractException,["for argument "+q+", must implement interface "+p])}}else{if(!(k instanceof j)){return d.create(a5.ContractException,["for argument "+q+", must be an instance of type "+p])}}break;case"type":if(k!==null&&typeof k!==p){return d.create(a5.ContractException,["for argument "+q+", must be of type "+p])}break;case"array":if(Object.prototype.toString.call(k)!=="[object Array]"){return d.create(a5.ContractException,["for argument "+q+", must be an array"])}break;case"object":if(k._a5_initialized!==b||typeof k!=="object"||k instanceof Array){return d.create(a5.ContractException,["for argument "+q+", must be a generic object"])}break}}return k},f=function(k,j,q,m){var p,o=false;if(k==="string"){var n=q.charAt(0);if(n===q.charAt(q.length-1)){if(n==='"'||n==="'"){p=q.substr(1,q.length-2)}else{o=true}}else{o=true}}else{if(k==="number"){if(!isNaN(q)){p=parseInt(q)}else{o=true}}else{if(j==="class"){if(q==="null"){p=null}else{o=true}}else{if(k==="boolean"||k==="array"||k==="function"||k==="object"){switch(q){case"{}":if(k==="object"){p={}}else{o=true}break;case"[]":if(k==="array"){p=[]}else{o=true}break;case"null":p=null;break;case"true":if(k==="boolean"){p=true}else{o=true}break;case"false":if(k==="boolean"){p=false}else{o=true}break;default:o=true}}else{o=true}}}}if(o){return d.create(a5.ContractException,["for argument "+m+', invalid default value for data type "'+k+'"'])}else{return p}}});a5.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(c){c.PropertyMutatorAttribute=function(){c.superclass(this)};c.Override.before=function(n,h,o,d,k,g){if(h.length){var f=n[0].validate,j=false;if(f){if(f.indexOf(".")!==-1){j=true;var f=a5.GetNamespace(f);if(!f){return a5.AspectAttribute.FAILURE}}var m=j?(h[0] instanceof f):(typeof h[0]===f);if(!m){return a5.AspectAttribute.FAILURE}}o[n[0].property]=h[0];return a5.AspectAttribute.SUCCESS}var e=o[n[0].property];return e===null?a5.AspectAttribute.RETURN_NULL:e};c.Override.after=function(h,d,e,k,j,f,g){if(g.length){return e}else{return a5.AspectAttribute.SUCCESS}}});a5.Package("a5").Static(function(c){c.DESTROYED="Destroyed"}).Prototype("Event",function(c){c.Event=function(d,f,e){this._a5_type=d;this._a5_data=e;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=f!==false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false};c.cancel=function(d){if(d===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};c.target=function(){return this._a5_target};c.currentTarget=function(){return this._a5_currentTarget};c.type=function(){return this._a5_type};c.data=function(){return this._a5_data};c.phase=function(){return this._a5_phase};c.bubbles=function(){return this._a5_bubbles};c.shouldRetain=function(d){if(typeof d==="boolean"){this._a5_shouldRetain=d;return this}return this._a5_shouldRetain};c.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});a5.Package("a5").Static("EventPhase",function(c){c.CAPTURING=1;c.AT_TARGET=2;c.BUBBLING=3});a5.Package("a5").Extends(Error).Prototype("Error",function(d,c,e){e.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this._a5_isWindowError=false;this.name=this.type=this.className()});d.Error=function(m,g){if(g===false){this._a5_isWindowError=true}if(typeof m==="string"){this.message=m}else{g=m}if(g instanceof e){if(g.stack){this.stack=g.stack.split("\n")}this.line=g.lineNumber;this.url=g.fileName;if(g.message&&this.message===""){this.message=g.message}}else{if(g!==false){try{__undefined__()}catch(n){if(n.stack){var f=n.stack.indexOf("@http")!==-1;this.stack=n.stack.split("\n");this.stack=this.stack.splice(4);if(f){for(var j=0;j<this.stack.length;j++){this.stack[j]=this.stack[j].substr(this.stack[j].indexOf("@http"))}}}else{var k=[];try{var j=0,h=this.init.caller.caller.caller;do{for(j=0,l=k.length;j<l;j++){if(k[j]===h){h=null}}if(h){if(h.toString().indexOf(e.FORCE_CAST_ERROR)===-1){this.stack.push(h.toString().replace(/;/g,";<br/>").replace(/{/g,"{<br/>").replace(/}/g,"}<br/>")+"<br/><br/>")}k.push(h);h=h.caller;j++}}while(h&&j<=50)}catch(n){}}}}}};d.isWindowError=function(){return this._a5_isWindowError};d.Override.toString=function(){return this.type+": "+this.message}});a5.Package("a5").Extends("Error").Prototype("AssertException",function(c){c.AssertException=function(){c.superclass(this,arguments);this.type="AssertException"}});a5.Package("a5").Extends("Error").Prototype("ContractException",function(c){c.ContractException=function(){c.superclass(this,arguments);this.type="ContractException"}});a5.Package("a5").Prototype("EventDispatcher","abstract",function(c){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});c.EventDispatcher=function(){};c.autoPurge=function(d){if(typeof d==="boolean"){this._a5_autoPurge=d;return this}return this._a5_autoPurge};c.addEventListener=function(f,g,d,e){this._a5_addEventListener(f,g,d,e)};c.addOneTimeEventListener=function(f,g,d,e){this._a5_addEventListener(f,g,d,e,true)};c.hasEventListener=function(o,d){var n=o.split("|"),p=this.cl(),k,g,f,h,e;for(k=0,g=n.length;k<g;k++){f=this._a5_getListenerArray(n[k]);if(f){for(h=0,e=f.length;h<e;h++){if(f[h].type==n[k]&&(typeof d==="function"?(f[h].method==d):true)){return true}}}}return false};c.removeEventListener=function(p,d,e){var o=p.split("|"),n,h,g,k,f;e=e===true;for(n=0,h=o.length;n<h;n++){g=this._a5_getListenerArray(o[n]);if(g){for(k=0,f=g.length;k<f;k++){if(g[k].method==d&&g[k].type==o[n]&&g[k].useCapture===e){g.splice(k,1);f=g.length}}this.eListenersChange({type:o.length>1?o:o[0],method:d,useCapture:e,changeType:"REMOVE"})}}};c.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};c.getTotalListeners=function(e){if(typeof e==="string"){var d=this._a5_getListenerArray(e);if(d){return d.length}else{return 0}}else{var f=0;for(var g in this._a5_listeners){f+=this._a5_listeners[g].length}return f}};c.dispatchEvent=function(f,g,d){var h=this._a5_createEvent(f,g,d);h._a5_phase=a5.EventPhase.AT_TARGET;this._a5_dispatchEvent(h);if(!h.shouldRetain()){h.destroy()}h=null};c.eListenersChange=function(d){};c._a5_addEventListener=function(r,d,f,s,t){var u=s||null,q=r.split("|"),n=t||false,e=true,p,k,h,o,g;if(q.length!=0&&d!=b){for(p=0,k=q.length;p<k;p++){h=this._a5_getListenerArray(q[p],true);for(o=0,g=h.length;o<g;o++){if(h[o].method===d&&h[o].type===q[p]&&h[o].useCapture===f){e=false;break}}if(e){h.push({type:q[p],method:d,scope:u,useCapture:f===true,isOneTime:n})}}this.eListenersChange({type:q.length>1?q:q[0],method:d,changeType:"ADD"})}else{throw"invalid listener: type- "+r+", method- "+d}};c._a5_createEvent=function(f,g,d){var h=(typeof f==="string")?a5.Create(a5.Event,[f,d]):f;if(h instanceof a5.Event||h.doesExtend&&h.doesExtend(a5.Error)){h._a5_target=this;if(g){h._a5_data=g}return h}throw"Invalid event type."};c._a5_dispatchEvent=function(j){j._a5_currentTarget=this;if(this._a5_listeners){var k=this._a5_getListenerArray(j.type()),g,d,f,h;if(k){for(g=0,d=k.length;g<d;g++){f=k?k[g]:null;if(j._a5_canceled||!f){return}h=(j.phase()===a5.EventPhase.CAPTURING&&f.useCapture)||(j.phase()!==a5.EventPhase.CAPTURING&&!f.useCapture),validListener=typeof f.method==="function"&&(f.scope&&f.scope.namespace?f.scope._a5_initialized:true);if(h&&validListener){f.method.call(f.scope,j)}if(f.isOneTime===true||(!validListener&&this._a5_autoPurge)){k.splice(g,1);g--;d--}}}}};c._a5_getListenerArray=function(e,d){if(this._a5_listeners[e]===b){if(d===true){this._a5_listeners[e]=[];return this._a5_listeners[e]}return null}return this._a5_listeners[e]};c.dealloc=function(){this.dispatchEvent(a5.Create(a5.Event,[a5.Event.DESTROYED]));this.removeAllListeners();this._a5_listeners=null}});a5.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'invalid scope argument passed to superclass constructor on class "{nm}".',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(this);