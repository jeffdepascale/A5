//A5, Copyright (c) 2012, Jeff dePascale http://www.a5js.com(function(b){var f=null,j=null,k=(function(){return !this})(),a=function(r,p,o,s){var n=this,o=o||0,q=this.isA5,t=s?setInterval:setTimeout,m=t(function(){if(!q||n._a5_initialized){r.apply(n,p)}},o);return{cancel:function(){clearInterval(m)}}},e=function(o,m,q){var t,r,p,n;if(!o){return null}q=q||false;if(typeof o==="object"){return o}t=o.split(".");n=b;if(t.length===1&&m&&m[o]){return m[o]}for(r=0,p=t.length;r<p;r++){n=n[t[r]];if(n===undefined){if(j){try{var u=j(o,m);if(u){return u}}catch(s){return null}}else{return null}}}if(q||n.namespace!==undefined){return n}return null},c=function(n,r,q){var t=typeof r==="boolean",p=t?r:false,s,m=(t?q:r)||{},s=n.split("."),u=s.pop(),o;if(!n.match(/^[A-Za-z0-9.]*$/)){return a5.ThrowError(100,null,{namespace:n})}o=s.length?d(s):b;if(o[u]!==undefined){return o[u]}return o[u]=p?new m():m},d=function(p){var o=b,n,m;for(n=0,m=p.length;n<m;n++){if(!o[p[n]]){o[p[n]]={}}o=o[p[n]]}return o},g=function(){f={};for(var m in b){f[m]=""}},h=function(m){if(!f){a5.ThrowError(101)}else{var o=[],n;for(n in b){if(f[n]===undefined){o.push(n)}}if(m===true){g()}return o}};b.a5={Version:function(){return"0.5.{BUILD_NUMBER}"},GetNamespace:e,SetNamespace:c,ES5:k,Async:a,TrackGlobalStrays:g,GetGlobalStrays:h,RegisterNamespaceResolver:function(m){j=m},CreateGlobals:function(){b.Create=a5.Create;b.Async=a5.Async;b.Package=a5.Package;b.GetNamespace=a5.GetNamespace;b.SetNamespace=a5.SetNamespace}};a5.SetNamespace("a5.core.reflection",true,function(){var m={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},n=function(o,q,r,p){p=p||q[r];p._a5_ownerInstance=q;p._a5_ownerClass=o;p._a5_methodName=r;p.getName=m.getName;p.getClass=m.getClass;p.getClassInstance=m.getClassInstance;p.getAttributes=m.getAttributes};return{setReflection:n}});a5.SetNamespace("a5.core.attributes",true,function(){var p=function(s,v){var z=Array.prototype.slice.call(v),w,I,H,G,F,A,x={},q=false;if(!z.length){return a5.ThrowError(305)}w=typeof z[z.length-1]==="function"?z.pop():null;if(w!==null&&typeof w!=="function"){return a5.ThrowError(300)}if(!z.length){return a5.ThrowError(301)}for(I=0,F=z.length;I<F;I++){var y=z[I];if(Object.prototype.toString.call(y)!=="[object Array]"){return a5.ThrowError(302)}for(H=0,G=y.length;H<G;H++){var D=y[H],A=typeof D;if(H==0){var J=false,E=null;if(A!=="string"){if(A==="function"){E=D}else{J=true}}else{var u=a5.GetNamespace(D,s.imports());if(!u){u=a5.GetNamespace(D+"Attribute",s.imports())}if(u){E=y[H]=u}else{J=true}}if(!J&&(!E.isA5||!E.doesExtend(a5.Attribute))){J=true}else{if(!J&&E.doesExtend(a5.AspectAttribute)){q=true}}if(J){return a5.ThrowError(303)}}else{if(A!=="object"||Object.prototype.toString.call(D)==="[object Array]"){return a5.ThrowError(304)}}}}for(I=0,F=z.length;I<F;I++){var r=z[I],C=[];for(var H=1,G=r.length;H<G;H++){C.push(r[H])}z[I]=[r[0],C];x[r[0].className()]=C}if(!q){if(!w){w=function(){}}w._a5_attributes=x;return w}x.wrappedMethod=w;var B=function(){var K,U=[],Q=this,O=0;if(w){for(var K in B){w[K]=B[K]}}for(var N=0,M=z.length;N<M;N++){var T=z[N][0],S=T.instance(true),R=z[N][1];U.push({cls:S,props:R})}var P=function(X,W,V){L(O,X,W,V)},L=function(W,ab,ad,X){if(ab){if(Object.prototype.toString.call(ab)!=="[object Array]"){ab=[ab]}}else{ab=[]}if(!X){X=ab}if(W>=U.length){if(ad){return ab[0]}else{return t(ab,X)}}var aa,ad=ad||false,Z=false,Y=false,ac=function(ae){P.call(this,ae||ab,ad,X)};var V=new a5.AspectCallArguments(U[W].props,ab,Q,B,ac,X);aa=U[W].cls.around(V);if(aa===a5.AspectAttribute.NOT_IMPLEMENTED){aa=U[W].cls[(ad?"after":"before")](V)}else{Z=true}if(aa!==null&&aa!==undefined){switch(aa){case a5.AspectAttribute.NOT_IMPLEMENTED:case a5.AspectAttribute.SUCCESS:aa=ab;break;case a5.AspectAttribute.ASYNC:Y=true;break;case a5.AspectAttribute.RETURN_NULL:aa=null;break;case a5.AspectAttribute.FAILURE:return}}else{return a5.ThrowError(308,null,{prop:K,method:Z?"around":(ad?"after":"before")})}O=W+1;if(!Y){return L(O,aa,ad,ab,X)}},t=function(W,V){O=0;var X=w?w.apply(Q,W):undefined;if(X!==undefined){X=[X]}else{X=W}return L(0,X,true,V)};return L(O,Array.prototype.slice.call(arguments))};B._a5_attributes=x;return B},o=function(){for(i=0,l=a5.Attribute._extenderRef.length;i<l;i++){new a5.Attribute._extenderRef[i]()}},m=function(z,x){var y=x.split("|");for(var v=0,t=y.length;v<t;v++){var q=y[v],s=q.charAt(0)==="*",A=q.charAt(q.length-1)==="*",w=z.indexOf(q),u=w!==-1;if(u){return true}if(s&&z.indexOf(q.substr(1))===0){return true}if(A&&z.indexOf(q.substr(0,q.length-1))>-1){return true}}return false},n=function(G,s){var u=G.getMethods(),E=Array.prototype.slice;for(var B=0,v=u.length;B<v;B++){var F=u[B],q=G[F],t=[];for(var z=0,w=s.length;z<w;z++){var D=E.call(s[z]);if(D.length>1){var A=D[D.length-1],r=false,y=true,x=A.include,C=A.exclude;if(x!==undefined){r=true;if(typeof x==="object"){y=F.match(x).length>0}else{y=m(F,x)}}if(C!==undefined){r=true;if(typeof C==="object"){y=F.match(C)}else{y=m(F,C)}}if(r){D.pop()}if(y){t.push(D)}}else{t.push(D)}}if(t.length){t.push(q);G[F]=a5.core.attributes.createAttribute(G,t);a5.core.reflection.setReflection(G.constructor,G,F,G[F])}}};return{createAttribute:p,applyClassAttribs:n}});a5.SetNamespace("a5.core.classBuilder",true,function(){var F=[],x=false,B=[],p=[],q,o="_a5_constructFromCreate",u="_a5_baseConstruct",n="_a5_interfaceTest",z={},E=function(H,G){var I,J;if(typeof H==="string"){I=a5.GetNamespace(H);if(I===null){return a5.ThrowError(207,null,{className:H})}}else{I=H}if(typeof I!=="function"){return a5.ThrowError(207,null,{className:H})}return new I(o,G)},s=function(I,L,M){var K,H,J=I.replace(/\./g,"_");if(z[J]){var G=z[J];for(var K=0,H=G.length;K<H;K++){if(!G[K][L]){G[K][L]=M}}}if(z[J+"_"+L]){var G=z[J+"_"+L];for(K=0,H=G.length;K<H;K++){if(!G[K][L]){G[K][L]=M}}delete z[J+"_"+L]}},C=function(G,J,L,H,I,K){if(K){J.Properties=function(M){L.constructor._a5_protoProps=M}}J.Attributes=function(){return a5.core.attributes.createAttribute.call(L,J,arguments)};L.Override={};L.Final={};G.call(J,L,H,I);a5.core.mixins.prepareMixins(L);w(L);delete J.Attributes;if(K){delete J.Properties}delete L.Final;delete L.Override;for(q in L){if(({}).hasOwnProperty.call(L,q)&&typeof L[q]==="function"&&(I._a5_namespace==="a5.Object"||a5.core.classProxyObj.instance[q]===undefined)){if(q===L.className()){L.constructor._a5_instanceConst=L[q];a5.core.reflection.setReflection(I,L,q,L.constructor._a5_instanceConst);delete L[q]}else{a5.core.reflection.setReflection(I,L,q)}}}},w=function(I){var J=I.superclass(),G=I.constructor._a5_mixedMethods;if(!J){J={}}for(q in I){if(I.hasOwnProperty(q)&&typeof I[q]==="function"){if(q!=="Final"&&q!=="Override"&&q!=="constructor"&&q!=="prototype"&&q!=="dealloc"&&q!=="_a5_initialized"){if(J[q]&&J[q].toString().indexOf("[native code]")===-1){if(J[q].Final==true){return a5.ThrowError(201,null,{prop:q,namespace:I.namespace()})}return a5.ThrowError(200,null,{prop:q,namespace:I.namespace()})}else{var H=G[q];if(G[q]!==undefined&&H!==I[q]){return a5.ThrowError(220,null,{prop:q,namespace:I.namespace()})}}}}}I.constructor._a5_superMethods={};for(q in I.Override){if(J[q]===undefined&&G[q]===undefined){return a5.ThrowError(202,null,{prop:q,namespace:I.namespace()})}if(J[q]&&J[q].Final!==undefined&&J[q].Final===true||G[q]&&G[q].Final!==undefined&&G[q].Final===true){return a5.ThrowError(203,null,{prop:q,namespace:I.namespace()})}I[q]=I.Override[q];I.constructor._a5_superMethods[q]=(function(K){return function(){var L=[].slice.call(arguments,1),M=this;return function(){return K.apply(M,L)}}})(J[q])}for(q in I.Final){I[q]=I.Final[q];I[q].Final=true}},D=function(K){var ad,Q,G,L,J,T,N,H,R=null,M=false,ab=false,O=false,X=false,W=false,S=function(){var ah={pkg:K,imports:A(ad,K),clsName:Q,cls:G,base:L,attribs:R,type:J,proto:T,implement:N,mixins:H,staticMethods:M,isInterface:O,isMixin:ab,enumDeclaration:X,isProto:W},ag=a5.core.verifiers.validateClassDependencies(L,ah.imports,H,N,O,ab);if(ag===true){m(ah)}else{F.push({pkg:ah,reason:ag.reason,reasonNM:ag.reasonNM})}S=P=ac=Z=ae=I=Y=V=af=aa=U=null},P=function(){ad=Array.prototype.slice.call(arguments);return{Prototype:V,Static:ae,Mixin:af,Mix:aa,Extends:ac,Implements:Z,Interface:I,Class:Y}},ac=function(ag){L=ag;return{Prototype:V,Static:ae,Import:P,Mix:aa,Implements:Z,Interface:I,Class:Y}},aa=function(){H=Array.prototype.slice.call(arguments);return{Prototype:V,Static:ae,Extends:ac,Implements:Z,Interface:I,Class:Y}},Z=function(ag){N=Array.prototype.slice.call(arguments);return{Prototype:V,Static:ae,Mix:aa,Import:P,Extends:ac,Class:Y}},ae=function(ag,ah){if(typeof ag==="string"){Q=ag;M=ah;S()}else{M=ag;return{Prototype:V,Implements:Z,Mix:aa,Mixin:af,Import:P,Extends:ac,Class:Y}}},I=function(ah,ag){Q=ah;G=ag;O=true;S()},af=function(){ab=true;var ah=Array.prototype.slice.call(arguments);Q=ah[0];for(var ai=1,ag=ah.length;ai<ag;ai++){switch(typeof ah[ai]){case"string":J=ah[ai];break;case"object":if(Object.prototype.toString.call(ah[ai])==="[object Array]"){if(!R){R=[]}R.push(ah[ai])}break;case"function":G=ah[ai];break}}S()},U=function(ag,ah){Q=ag;X=ah;S()},Y=function(){var ah=Array.prototype.slice.call(arguments);Q=ah[0];for(var ai=1,ag=ah.length;ai<ag;ai++){switch(typeof ah[ai]){case"string":J=ah[ai];break;case"object":if(Object.prototype.toString.call(ah[ai])==="[object Array]"){if(!R){R=[]}R.push(ah[ai])}break;case"function":G=ah[ai];break}}S()},V=function(){W=true;var ah=Array.prototype.slice.call(arguments);Q=ah[0];for(var ai=1,ag=ah.length;ai<ag;ai++){switch(typeof ah[ai]){case"string":J=ah[ai];break;case"object":if(Object.prototype.toString.call(ah[ai])==="[object Array]"){if(!R){R=[]}R.push(ah[ai])}break;case"function":T=ah[ai];break}}S()};a5.SetNamespace(K);return{Enum:U,Static:ae,Import:P,Extends:ac,Mixin:af,Mix:aa,Implements:Z,Class:Y,Prototype:V,Interface:I}},y=function(N,H){if(!this._a5_initialized){if(this.constructor.isInterface()){return a5.ThrowError(208,null,{nm:ref.namespace()})}if(this.constructor.isAbstract()){return a5.ThrowError(216,null,{nm:this.constructor.namespace()})}if(this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return a5.ThrowError(217,null,{nm:this.constructor.namespace()})}var P=this,G=this,J=N||[],Q=[],L,K,I,M;this._a5_initialized=true;this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;var P=this,G=this,J=N||[],Q=[],L,K,I,M;(function(R){R.Super=function(){if(!R.constructor._a5_superclass.className){return a5.ThrowError(210)}var T=R.constructor._a5_superclass.prototype.constructor._a5_instanceConst;if(T){T.apply(R,arguments)}else{a5.ThrowError(211,null,{nm:R.constructor._a5_superclass.className()})}};for(var S in R.constructor._a5_superMethods){R.Super[S]=R.constructor._a5_superMethods[S].call(R)}})(this);if(typeof this.constructor._a5_instanceConst!=="function"){return a5.ThrowError(218,null,{clsName:this.className()})}while(G!==null){var O=G.constructor;if(O._a5_attribs){a5.core.attributes.applyClassAttribs(this,O._a5_attribs)}if(O._a5_protoProps!==undefined){Q.unshift(O._a5_protoProps)}G=O.superclass&&O.superclass().constructor.namespace?O.superclass():null}a5.core.mixins.initializeMixins(this);for(K=0,I=Q.length;K<I;K++){Q[K].call(this)}if(N==o){this.constructor._a5_instanceConst.apply(this,H)}else{this.constructor._a5_instanceConst.apply(this,arguments)}a5.core.mixins.mixinsReady(this)}},v=function(R,M,U,I,P,Y,ab,G,T){if(P){if(M&&!M.isInterface()){return a5.ThrowError('Interface "'+R+'" cannot extend "'+M.namespace()+'", base class is not an interface.')}M=null}var H=function(){},N=Y===false||false,ac=false,Q=false,X=null,W=R.lastIndexOf("."),J=W>-1?R.substring(0,W):"",S=W>-1?R.substring(W+1):R,L,O,K,ad,aa,V;if(!M||M===undefined){M=(R=="a5.Object"?H:a5.Object)}O=function(af,ag){var ae=this;if(this.constructor._a5_clsDef){C(this.constructor._a5_clsDef,this,this,this.constructor.imports(),this.constructor)}if(af!==n&&af!==u){y.apply(this,arguments)}};if(I){L=I.split(/[ |]/);for(aa=0,V=L.length;aa<V;aa++){if(L[aa]=="final"){N=true}else{if(L[aa]=="singleton"){ac=true}else{if(L[aa]=="abstract"){Q=true}}}}}if(a5.core.verifiers.checkNamespaceValid(R)){if(!M.isFinal||(M.isFinal()!=true)){if(M===Error){var Z={};Z.prototype=new M();O.prototype=Z;Z=null}else{O.prototype=new M(u)}X=M}else{return a5.ThrowError("Cannot extend "+M.namespace()+", class marked as final.")}}else{return a5.ThrowError("Cannot create new class in namespace "+R+", definition already exists.")}K=O.prototype;ad=K.constructor=O;if(M.prototype.constructor._extenderRef){M.prototype.constructor._extenderRef.push(O)}ad._a5_superclass=X;ad._a5_pkg=J;ad._a5_clsDef=U;ad._a5_clsName=S;ad._a5_namespace=R;ad._a5_imports=ab;ad._a5_isFinal=N;ad._a5_isAbstract=Q;ad._a5_isSingleton=ac;ad._a5_isInterface=P;ad._a5_isPrototype=Y||false;ad._a5_attribs=T;ad._mixinRef=M.prototype.constructor._mixinRef?M.prototype.constructor._mixinRef.slice(0):[];ad._implementsRef=M.prototype.constructor._implementsRef?M.prototype.constructor._implementsRef.slice(0):[];ad._a5_mixedMethods={};ad._a5_instance=null;ad._instanceCount=0;ad._extenderRef=[];K._a5_initialized=false;for(q in a5.core.classProxyObj.construct){ad[q]=a5.core.classProxyObj.construct[q]}if(M.namespace===undefined){for(q in a5.core.classProxyObj.instance){K[q]=a5.core.classProxyObj.instance[q]}}if(G){a5.core.mixins.applyMixins(K,G,ab)}return a5.SetNamespace(R,O)},r=function(){var G=false,J,H;for(J=0;J<F.length;J++){var K=F[J].pkg,I=a5.core.verifiers.validateClassDependencies(K.base,K.imports,K.mixins,K.implement);if(I===true){m(K,true);F.splice(J,1);J--;G=true}else{F[J].reason=I.reason;F[J].reasonNM=I.reasonNM}}if(G){r()}},t=function(I){var H=I.obj,G=I.pkgObj;C(G.proto,H,H.prototype,H.imports(),H,true)},m=function(M,I){var G=(typeof M.base==="function")?M.base:a5.GetNamespace(M.base,M.imports),J=v(M.pkg+"."+M.clsName,G,M.cls,M.type,M.isInterface,M.isProto,M.imports,M.mixins,M.attribs),N=I||false,Q=true,K,H;if(M.staticMethods){M.staticMethods(J,M.imports)}if(M.proto&&x){B.push({obj:J,pkgObj:M});if(M.implement){p.push({pkgObj:M,obj:J})}}else{if(M.proto){t({obj:J,pkgObj:M})}if(M.implement){Q=a5.core.verifiers.validateImplementation(M,J)}}if(!Q){return}if(M.enumDeclaration){var L=0,O=[];M.enumDeclaration({startIndex:function(R){L=R},addValue:function(R){O.push(R)}});for(K=0,H=O.length;K<H;K++){J[O[K]]=L++}J.addValue=function(R){if(J[R]===undefined){J[R]=L++}};J.getValue=function(R){for(q in J){if(J[q]===R){return q}}return null}}if(M.isInterface){J.interfaceVals={};if(M.base!==null&&M.base!==undefined){var P=a5.GetNamespace(M.base,M.imports);if(P.isInterface()){for(q in P.interfaceVals){if(J.interfaceVals[q]===undefined){J.interfaceVals[q]=P.interfaceVals[q]}}}else{a5.ThrowError(204,null,{objNM:J.namespace(),clsNM:P.namespace()})}}M.cls.call(J.interfaceVals,J.interfaceVals)}if(M.isMixin){J._mixinDef={Properties:function(R){J.prototype.constructor._a5_mixinProps=R},MustExtend:function(){J.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){J.prototype.constructor._a5_mixinMustMix=arguments}};M.cls.call(J._mixinDef,J._mixinDef,M.imports,J);if(typeof J._mixinDef[J.className()]==="function"){J._a5_instanceConst=J._mixinDef[J.className()];delete J._mixinDef[J.className()]}else{a5.ThrowError(205,null,{nm:J.namespace()})}delete J._mixinDef.Properties;delete J._mixinDef.Contract;delete J._mixinDef.MustExtend;delete J._mixinDef.MustMix}s(M.pkg,M.clsName,J);if(!N){r()}},A=function(P,Q,S){var K={},O,I,R,Q,H,N,G,T,M;if(P==undefined){P=[]}P.push(Q+".*");for(O=0,I=P.length;O<I;O++){R=P[O],N=false,G=R.lastIndexOf(".");T=R.substr(0,R.length-2);if(R.charAt(R.length-1)=="*"){N=true}if(N){T=R.substr(0,R.length-2);Q=a5.GetNamespace(T,null,true);if(Q){for(q in Q){M=Q[q];if((typeof M==="function"||typeof M==="object")&&K[q]===undefined){K[q]=M}}}var J=T.replace(/\./g,"_");if(!z[J]){z[J]=[]}z[J].push(K)}else{H=G>-1?R.substr(G+1):R;T=R.substr(0,G);var M=a5.GetNamespace(R,null,true);if(M){if(K[H]===undefined){K[H]=M}}else{var L=T.replace(/\./g,"_")+"_"+H;if(!z[L]){z[L]=[]}z[L].push(K)}}}return K};a5.Create=E;a5.Package=D;a5._a5_verifyPackageQueueEmpty=function(){if(F.length){var I="",H,G;for(H=0,G=F.length;H<G;H++){I+='"'+F[H].pkg.pkg+"."+F[H].pkg.clsName+'", '+F[H].reason+' class missing: "'+F[H].reasonNM+'"'+(F.length>1&&H<F.length-1?", \n":"")}a5.ThrowError(206,null,{classPlural:F.length==1?"class":"classes",clsString:I})}};a5._a5_delayProtoCreation=function(G){x=G};a5._a5_createQueuedPrototypes=function(){for(var H=0,G=B.length;H<G;H++){t(B[H])}B=[];for(H=0,G=p.length;H<G;H++){a5.core.verifiers.validateImplementation(p[H].pkgObj,p[H].obj)}p=[]};a5._a5_processImports=A});a5.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(m){return m?a5.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports},doesImplement:function(m){return a5.core.verifiers.checkImplements(this,m)},doesExtend:function(m){return a5.core.verifiers.checkExtends(this,m)},doesMix:function(m){return a5.core.verifiers.checkMixes(this,m)},getAttributes:function(){return this._a5_attributes},instance:function(n,m){if(n===true){return this._a5_instance||a5.Create(this,m)}else{return this._a5_instance}},superclass:function(o,m){if(o!==undefined){if(typeof o==="object"&&o.isA5===true){if(typeof m!=="object"){m=[]}if(!this._a5_superclass.className){return a5.ThrowError(210)}var n=this._a5_superclass.prototype.constructor._a5_instanceConst;if(n){n.apply(o,m)}else{a5.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{a5.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},superclass:function(n,m){return this.constructor.superclass(n,m)},async:function(n,m){return a5.Async.apply(this,arguments)},getAttributes:function(){return this.constructor.getAttributes()},getAttributeValue:function(m){return this.constructor.getAttributeValue(m)},getMethods:function(n,o){var m=[];for(var p in this){if((n||({}).hasOwnProperty.call(this,p))&&typeof(this[p])==="function"&&a5.core.classProxyObj.instance[p]===undefined&&p.substr(0,4)!=="_a5_"&&(o||p.substr(0,1)!=="_")){m.push(p)}}return m},getProperties:function(n,p){var m=[],o=function(u,v){var r=u;while(r!==null){var t=r.constructor;if(t._a5_protoProps!==undefined){var s={};t._a5_protoProps.call(s);if(s[v]!==undefined){return true}}r=t.superclass&&t.superclass().constructor.namespace?t.superclass():null}return false};for(var q in this){if((n||!o(this,q))&&typeof(this[q])!=="function"&&a5.core.classProxyObj.instance[q]===undefined&&q.substr(0,4)!=="_a5_"&&(p||q.substr(0,1)!=="_")){m.push(q)}}return m},classPackage:function(m){return this.constructor.classPackage(m)},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(m){return this.constructor.doesImplement(m)},doesExtend:function(m){return this.constructor.doesExtend(m)},doesMix:function(m){return this.constructor.doesMix(m)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){var q=this,s,o,m,t,p,n;while(q!==null){var r=q.constructor;m=r._mixinRef;if(m&&m.length){for(p=0,n=m.length;p<n;p++){if(m[p]._mixinDef.dealloc!=undefined){m[p]._mixinDef.dealloc.call(this)}}}if(r.namespace){o=r.superclass?r.superclass():null;if(o&&o.dealloc!==undefined&&o.dealloc!==q.dealloc){q.dealloc.call(this)}q=o}else{q=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}if(this.__proto__){this.__proto__=null}for(t in this){delete this[t]}}}}});a5.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(u,p){var q,o,m,r,z,v,t,n=function(B,A){for(var C in B){if(B[C]!==A[C]){return false}}return true};for(q=0,o=u.implement.length;q<o;q++){r=u.implement[q];try{z=new p("_a5_interfaceTest");z.Override={};z.Final={};z.Attributes=function(){var C=Array.prototype.slice.call(arguments);var E=C.pop();for(var D=0,B=C.length;D<B;D++){var A=C[D][0];if(A==="Contract"||A==="ContractAttribute"||A===a5.ContractAttribute){E.attributes=C[D]}}return E};v=a5.GetNamespace(r,p.imports());if(p._a5_clsDef){p._a5_clsDef.call(z,z,p.imports(),p)}}catch(s){throw s;return false}if(!v.isInterface()){return a5.ThrowError(213,null,{implNM:v.namespace(),objNM:p.namespace()})}for(m in v.interfaceVals){t=z[m]!==undefined;var y=v.interfaceVals[m],w=z[m];if(t&&typeof y==="object"&&w.attributes&&(w.attributes[0]==="Contract"||w.attributes[0]==="ContractAttribute"||w.attributes[0]===a5.ContractAttribute)){var x=true;for(var q=0,o=y.length;q<o;q++){x=x&&w.attributes.length>=(q+1)?n(y[q],w.attributes[q+1]):false}if(!x){return a5.ThrowError(601,null,{intNM:v.namespace(),implNM:p.namespace(),method:m})}}else{if(!t||(t&&typeof v.interfaceVals[m]!==typeof z[m])){return a5.ThrowError(214,null,{implNM:v.namespace(),objNM:p.namespace()})}}}p._implementsRef.push(v);z.destroy()}return true},checkNamespaceValid:function(o){for(var n=0,m=this.namespaceArray.length;n<m;n++){if(this.namespaceArray[n]==o){return false}}this.namespaceArray.push(o);return true},checkImplements:function(n,s){if(typeof s==="string"){s=a5.GetNamespace(s)}var r=n._implementsRef,q,p,o,m;while(r){for(q=0,m=r.length;q<m;q++){if(r[q]===s){return true}}r=n.superclass()?n.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(m,p){var o=m._a5_superclass&&m._a5_superclass.prototype.className?m._a5_superclass:null;if(!o){return false}var n=(typeof p==="string")?a5.GetNamespace(p):p;if(!n){return false}while(o){if(o===n){return true}o=o._a5_superclass&&o._a5_superclass.prototype.className?o._a5_superclass:null}return false},checkMixes:function(n,p){if(typeof p==="string"){p=a5.GetNamespace(p)}if(!p){return false}for(var o=0,m=n._mixinRef.length;o<m;o++){if(n._mixinRef[o]===p){return true}}return false},validateClassDependencies:function(p,y,w,o,q,z){var x,u,v,t=null,n,r,A,s;if(p!==undefined){if(typeof p==="function"){t=p}else{t=a5.GetNamespace(p,y)}}x=true;if(p!==undefined&&!t){x=false;u="base";v=p}if(x&&w!==undefined){for(n in w){r=w[n];if(typeof r==="string"){A=a5.GetNamespace(r,y)}if(typeof A!=="function"){x=false;u="mixin";v=r}}}if(x&&o!==undefined){for(n in o){s=o[n];if(typeof s==="string"){A=a5.GetNamespace(s,y)}if(typeof A!=="function"){x=false;u="interface";v=s}}}return x?true:{reason:u,reasonNM:v}}});a5.SetNamespace("a5.core.mixins",{prepareMixins:function(r){var q=r,m=r.constructor._mixinRef,p,o,s,n;if(m.length){for(p=m.length-1,o=-1;p>o;p--){if(m[p]._a5_mixinMustExtend!==undefined){for(s in m[p]._a5_mixinMustExtend){n=m[p]._a5_mixinMustExtend[s];if(!r.doesExtend(a5.GetNamespace(n,r.imports()))){return a5.ThrowError(400,null,{mixinNM:m[p].namespace(),instNM:r.namespace(),clsNM:n.namespace()})}}}}}},initializeMixins:function(r){var q=r,m=r.constructor._mixinRef,p,o,s,n;if(m.length){for(p=m.length-1,o=-1;p>o;p--){if(m[p]._a5_mixinProps!==undefined){m[p]._a5_mixinProps.call(q)}}for(p=0,o=m.length;p<o;p++){m[p]._a5_instanceConst.call(q)}}},mixinsReady:function(q){var m=q.constructor._mixinRef,p,o,r,n;if(m.length){for(p=m.length-1,o=-1;p>o;p--){if(m[p]._a5_mixinMustMix!==undefined){for(r in m[p]._a5_mixinMustMix){n=m[p]._a5_mixinMustMix[r];if(!inst.doesMix(a5.GetNamespace(n))){return a5.ThrowError(401,null,{nm:m[p].namespace(),cls:n})}}}if(typeof m[p]._mixinDef.mixinReady==="function"){m[p]._mixinDef.mixinReady.call(q)}}}},applyMixins:function(v,u,n,t){var o={},u=typeof u==="string"?[u]:u,w=[],s,r,q,p,x;for(s=0,p=u.length;s<p;s++){x=a5.GetNamespace(u[s],typeof n==="function"?n():n);if(!x){return a5.ThrowError(404,null,{mixin:u[s]})}w.push(x);for(r=0,q=v.constructor._mixinRef.length;r<q;r++){if(v.constructor._mixinRef[r]===x){return a5.ThrowError(402,null,{nm:x.namespace()})}}for(var m in x._mixinDef){if(m!=="dealloc"&&m!=="Properties"&&m!=="mixinReady"&&m!=="MustExtend"&&m!=="Contract"){if(o[m]===undefined){if(t===undefined){v.constructor._a5_mixedMethods[m]=x._mixinDef[m]}v[m]=x._mixinDef[m];o[m]="mixed"}else{return a5.ThrowError(403,null,{method:m})}}}if(t){a5.core.mixins.initializeMixins(t,w,t)}else{v.constructor._mixinRef.push(x)}}}});a5.SetNamespace("a5.core.errorHandling",true,function(){var n=null;this.ThrowError=function(o,r,q){var p=typeof o,s;if(p==="string"){s=o}else{if(p==="number"){if(a5.GetNamespace("a5.ErrorDefinitions",null,true)){var s=a5.ErrorDefinitions[o];if(!s){s="Invalid error id "+o+" thrown: error not defined."}}else{s="Error id "+o+" thrown. Include a5.ErrorDefinitions for verbose information."}o=a5.Create(r||a5.Error,[s,a5.Error.FORCE_CAST_ERROR])}}if(s){o=a5.Create(r||a5.Error,[(q?m(s,q):s),a5.Error.FORCE_CAST_ERROR])}n=o;throw o};this._a5_getThrownError=function(){var o=n;n=null;return o};var m=function(p,o){for(var q in o){p=p.replace(new RegExp("{"+q+"}","g"),o[q])}return p}});a5.ThrowError=a5.core.errorHandling.ThrowError;a5._a5_getThrownError=a5.core.errorHandling._a5_getThrownError;a5.Package("a5").Prototype("Object",function(n,m){n.Object=function(){};n.mixins=function(o){if(o!==undefined){return a5.GetNamespace(o,this.imports())}else{return this.constructor._a5_mixedMethods}}});a5.Package("a5").Prototype("Attribute","singleton",function(o,m,n){o.Attribute=function(){}});a5.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(o,n,m){m.RETURN_NULL="_a5_aspectReturnsNull";m.SUCCESS="_a5_aspectSuccess";m.ASYNC="_a5_aspectAsync";m.FAILURE="_a5_aspectFailure";m.NOT_IMPLEMENTED="_a5_notImplemented";o.AspectAttribute=function(){o.superclass(this)};o.before=function(s,p,q,u,t,r){return m.NOT_IMPLEMENTED};o.after=function(t,q,r,v,u,s,p){return m.NOT_IMPLEMENTED};o.around=function(){return m.NOT_IMPLEMENTED}});a5.Package("a5").Class("AspectCallArguments",function(t,s,q){var m,p,o,r,u,n;t.AspectCallArguments=function(y,w,x,A,z,v){m=y;p=w;o=x;r=A;u=z;n=v};t.rules=function(){return m};t.args=function(){return p};t.scope=function(){return o};t.method=function(){return r};t.callback=function(){return u};t.beforeArgs=function(){return n}});a5.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(n,m,q){n.ContractAttribute=function(){n.superclass(this)};n.Override.before=function(t){var u=null,v=false,s=function(w){w.message='Contract type failure on method "'+t.method().getName()+'" '+w.message;return w};if(t.rules().length>1){for(i=0,l=t.rules().length;i<l;i++){u=o(t.rules()[i],t.args());if(u instanceof a5.ContractException){n.throwError(s(u));return a5.AspectAttribute.FAILURE}if(u!==false){v=true;u.overloadID=i;break}}}else{v=true;u=o(t.rules()[0],t.args(),true);if(u instanceof a5.ContractException){n.throwError(s(u));return a5.AspectAttribute.FAILURE}}if(!v||u===false){n.throwError(s(new a5.ContractException("no matching overload found")));return a5.AspectAttribute.FAILURE}else{return u}};var o=function(x,t){var w={},v=0,s,y,u;for(y in x){u=x[y];s=r((v<t.length?t[v]:undefined),u,v);if(s instanceof a5.ContractException){return s}w[y]=s;v++}if(t.length>v){return false}if(t.length===0){if(v===0){return w}return false}return w},r=function(t,x,y){var w="type",u=false,z=null,v,s;if(x.indexOf("=")!=-1){v=x.split("=");x=v[0];u=true;z=v[1]}else{if(u){return new a5.ContractException("for argument "+y+", required values cannot be defined after optional values")}}if(x.indexOf(".")!==-1){w="class"}if(x==="array"){w="array"}if(x==="object"){w="object"}if(w!=="class"){x=x.toLowerCase()}if(t===undefined){if(u){t=p(x,w,z,y)}else{return new a5.ContractException("for argument "+y+', missing required argument of type "'+x+'"')}}if(t!==undefined&&t!==null){switch(w){case"class":s=a5.GetNamespace(x);if(s.isInterface()){if(!(t.doesImplement(s))){return new a5.ContractException("for argument "+y+", must implement interface "+x)}}else{if(!(t instanceof s)){return new a5.ContractException("for argument "+y+", must be an instance of type "+x)}}break;case"type":if(t!==null&&typeof t!==x){return new a5.ContractException("for argument "+y+", must be of type "+x)}break;case"array":if(Object.prototype.toString.call(t)!=="[object Array]"){return new a5.ContractException("for argument "+y+", must be an array")}break;case"object":if(t._a5_initialized!==undefined||typeof t!=="object"||t instanceof Array){return new a5.ContractException("for argument "+y+", must be a generic object")}break}}return t},p=function(t,s,y,u){var x,w=false;if(t==="string"){var v=y.charAt(0);if(v===y.charAt(y.length-1)){if(v==='"'||v==="'"){x=y.substr(1,y.length-2)}else{w=true}}else{w=true}}else{if(t==="number"){if(!isNaN(y)){x=parseInt(y)}else{w=true}}else{if(s==="class"){if(y==="null"){x=null}else{w=true}}else{if(t==="boolean"||t==="array"||t==="function"||t==="object"){switch(y){case"{}":if(t==="object"){x={}}else{w=true}break;case"[]":if(t==="array"){x=[]}else{w=true}break;case"null":x=null;break;case"true":if(t==="boolean"){x=true}else{w=true}break;case"false":if(t==="boolean"){x=false}else{w=true}break;default:w=true}}else{w=true}}}}if(w){return new a5.ContractException("for argument "+u+', invalid default value for data type "'+t+'"')}else{return x}}});a5.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(m){m.PropertyMutatorAttribute=function(){m.superclass(this)};m.Override.before=function(p){if(p.args().length){var n=p.rules()[0].validate,o=false;if(n){if(n.indexOf(".")!==-1){o=true;var n=a5.GetNamespace(n);if(!n){return a5.AspectAttribute.FAILURE}}var r=o?(p.args()[0] instanceof n):(typeof p.args()[0]===n);if(!r){return a5.AspectAttribute.FAILURE}}p.scope()[p.rules()[0].property]=p.args()[0];return a5.AspectAttribute.SUCCESS}var q=p.scope()[p.rules()[0].property]||null;return q===null||q===undefined?a5.AspectAttribute.RETURN_NULL:q};m.Override.after=function(n){if(n.beforeArgs().length){return n.scope()}else{return a5.AspectAttribute.SUCCESS}}});a5.Package("a5").Static(function(m){m.DESTROYED="Destroyed"}).Prototype("Event",function(m){this.Properties(function(){this._a5_type=null;this._a5_data=null;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false});m.Event=function(o,n,p){this._a5_type=o;this._a5_data=p||null;this._a5_bubbles=n!==false};m.cancel=function(n){if(n===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};m.target=function(){return this._a5_target};m.currentTarget=function(){return this._a5_currentTarget};m.type=function(){return this._a5_type};m.data=function(){return this._a5_data};m.phase=function(){return this._a5_phase};m.bubbles=function(){return this._a5_bubbles};m.shouldRetain=function(n){if(typeof n==="boolean"){this._a5_shouldRetain=n;return this}return this._a5_shouldRetain};m.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});a5.Package("a5").Static("EventPhase",function(m){m.CAPTURING=1;m.AT_TARGET=2;m.BUBBLING=3});a5.Package("a5").Extends(Error).Prototype("Error",function(n,m,o){o.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this.name=this.type=this.className()});n.Error=function(q,p){if(typeof q==="string"){this.message=q}else{p=q}if(p instanceof o){if(p.stack){this.stack=p.stack.split("\n")}this.line=p.lineNumber;this.url=p.fileName;if(p.message&&this.message===""){this.message=p.message}}};n.Override.toString=function(){return this.type+": "+this.message}});a5.Package("a5").Extends("Error").Prototype("AssertException",function(m){m.AssertException=function(){m.superclass(this,arguments);this.type="AssertException"}});a5.Package("a5").Extends("Error").Prototype("ContractException",function(m){m.ContractException=function(){m.superclass(this,arguments);this.type="ContractException"}});a5.Package("a5").Static(function(m){m.ADD="eventDispatcherAdd";m.REMOVE="eventDispatcherRemove"}).Prototype("EventDispatcher","abstract",function(o,m,n){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});o.EventDispatcher=function(){};o.autoPurge=function(p){if(typeof p==="boolean"){this._a5_autoPurge=p;return this}return this._a5_autoPurge};o.addEventListener=function(r,s,p,q){this._a5_addEventListener(r,s,p,q)};o.addOneTimeEventListener=function(r,s,p,q){this._a5_addEventListener(r,s,p,q,true)};o.hasEventListener=function(w,p){var v=w.split("|"),x=this.cl(),u,s,r,t,q;for(u=0,s=v.length;u<s;u++){r=this._a5_getListenerArray(v[u]);if(r){for(t=0,q=r.length;t<q;t++){if(r[t].type==v[u]&&(typeof p==="function"?(r[t].method==p):true)){return true}}}}return false};o.removeEventListener=function(z,p,r,A,v){var y=z.split("|"),q=true,x,u,t,w,s;A=A||null;v=v||false;r=r===true;for(x=0,u=y.length;x<u;x++){t=this._a5_getListenerArray(y[x]);if(t){for(w=0,s=t.length;w<s;w++){if(t[w].method===p&&t[w].type===y[x]&&t[w].useCapture===r&&t[w].isOneTime===v){t.splice(w,1);s=t.length}}this.eListenersChange({type:y.length>1?y:y[0],method:p,useCapture:r,changeType:n.REMOVE})}}};o.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};o.getTotalListeners=function(q){if(typeof q==="string"){var p=this._a5_getListenerArray(q);if(p){return p.length}else{return 0}}else{var r=0;for(var s in this._a5_listeners){r+=this._a5_listeners[s].length}return r}};o.dispatchEvent=function(r,s,p,q){var t=this._a5_createEvent(r,s,p);t._a5_phase=a5.EventPhase.AT_TARGET;if(q===false){this.async(this._a5_dispatchEvent,[t])}else{this._a5_dispatchEvent(t)}if(!t.shouldRetain()){t.destroy()}t=null};o.eListenersChange=function(p){};o._a5_addEventListener=function(z,p,A,B,C){var D=B||null,y=z.split("|"),v=C||false,r=A===true,q=true,x,u,t,w,s;if(y.length!=0&&p!=undefined){for(x=0,u=y.length;x<u;x++){t=this._a5_getListenerArray(y[x],true);for(w=0,s=t.length;w<s;w++){if(t[w].method===p&&t[w].type===y[x]&&t[w].useCapture===r&&t[w].scope===D&&t[w].isOneTime===v){q=false;break}}if(q){t.push({type:y[x],method:p,scope:D,useCapture:r===true,isOneTime:v})}}this.eListenersChange({type:y.length>1?y:y[0],method:p,changeType:n.ADD})}else{throw"invalid listener: type- "+z+", method- "+p}};o._a5_createEvent=function(q,r,p){var s=(typeof q==="string")?new a5.Event(q,p):q;if(s instanceof a5.Event||s.doesExtend&&s.doesExtend(a5.Error)){s._a5_target=this;if(r){s._a5_data=r}return s}throw"Invalid event type."};o._a5_dispatchEvent=function(u){u._a5_currentTarget=this;if(this._a5_listeners){var v=this._a5_getListenerArray(u.type()),r,p,q,t,s;if(v){for(r=0,p=v.length;r<p;r++){q=v?v[r]:null;if(u._a5_canceled||!q){return}t=(u.phase()===a5.EventPhase.CAPTURING&&q.useCapture)||(u.phase()!==a5.EventPhase.CAPTURING&&!q.useCapture),s=typeof q.method==="function"&&(q.scope&&q.scope.namespace?q.scope._a5_initialized:true);if(t&&s&&(q.scope==null||q.scope._a5_initialized)){q.method.call(q.scope,u)}if(q.isOneTime===true||(!s&&this._a5_autoPurge)){v.splice(r,1);r--;p--}}}}};o._a5_getListenerArray=function(q,p){if(this._a5_listeners[q]===undefined){if(p===true){this._a5_listeners[q]=[];return this._a5_listeners[q]}return null}return this._a5_listeners[q]};o.dealloc=function(){this.dispatchEvent(new a5.Event(a5.Event.DESTROYED));this.removeAllListeners();this._a5_listeners=null}});a5.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'Mixin "{mixinNM}" requires mixing object "{instNM}" to extend class "{clsNM}" .',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(typeof global!=="undefined"?global:this);