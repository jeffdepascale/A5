//A5, Copyright (c) 2012, Jeff dePascale http://www.a5js.com(function(f){var e=null,d=null,c=function(m,j,o){var r,p,n,k;if(!m){return null}o=o||false;if(typeof m==="object"){return m}r=m.split(".");k=f;if(r.length===1&&j&&j[m]){return j[m]}for(p=0,n=r.length;p<n;p++){k=k[r[p]];if(k===undefined){if(d){try{var s=d(m,j);if(s){return s}}catch(q){return null}}else{return null}}}if(o||k.namespace!==undefined){return k}return null},h=function(k,p,o){var r=typeof p==="boolean",n=r?p:false,q,j=(r?o:p)||{},q=k.split("."),s=q.pop(),m;if(!k.match(/^[A-Za-z0-9.]*$/)){return a5.ThrowError(100,null,{namespace:k})}m=q.length?b(q):f;if(m[s]!==undefined){return m[s]}return m[s]=n?new j():j},b=function(n){var m=f,k,j;for(k=0,j=n.length;k<j;k++){if(!m[n[k]]){m[n[k]]={}}m=m[n[k]]}return m},g=function(){e={};for(var j in f){e[j]=""}},a=function(j){if(!e){a5.ThrowError(101)}else{var m=[],k;for(k in f){if(e[k]===undefined){m.push(k)}}if(j===true){g()}return m}};f.a5={Version:function(){return"0.5.{BUILD_NUMBER}"},GetNamespace:c,SetNamespace:h,TrackGlobalStrays:g,GetGlobalStrays:a,RegisterNamespaceResolver:function(j){d=j},CreateGlobals:function(){f.Create=a5.Create;f.Package=a5.Package;f.GetNamespace=a5.GetNamespace;f.SetNamespace=a5.SetNamespace}};a5.SetNamespace("a5.core.reflection",true,function(){var j={getName:function(){return this._a5_methodName},getClass:function(){return this._a5_ownerClass},getClassInstance:function(){return this._a5_ownerInstance},getAttributes:function(){return this._a5_attributes?this._a5_attributes:null}},k=function(m,o,p,n){n=n||o[p];n._a5_ownerInstance=o;n._a5_ownerClass=m;n._a5_methodName=p;n.getName=j.getName;n.getClass=j.getClass;n.getClassInstance=j.getClassInstance;n.getAttributes=j.getAttributes};return{setReflection:k}});a5.SetNamespace("a5.core.attributes",true,function(){var n=function(q,s){var x=Array.prototype.slice.call(s),u,G,F,E,D,y,v={},o=false;if(!x.length){return a5.ThrowError(305)}u=typeof x[x.length-1]==="function"?x.pop():null;if(u!==null&&typeof u!=="function"){return a5.ThrowError(300)}if(!x.length){return a5.ThrowError(301)}for(G=0,D=x.length;G<D;G++){var w=x[G];if(Object.prototype.toString.call(w)!=="[object Array]"){return a5.ThrowError(302)}for(F=0,E=w.length;F<E;F++){var B=w[F],y=typeof B;if(F==0){var H=false,C=null;if(y!=="string"){if(y==="function"){C=B}else{H=true}}else{var r=a5.GetNamespace(B,q.imports());if(!r){r=a5.GetNamespace(B+"Attribute",q.imports())}if(r){C=w[F]=r}else{H=true}}if(!H&&(!C.isA5||!C.doesExtend(a5.Attribute))){H=true}else{if(!H&&C.doesExtend(a5.AspectAttribute)){o=true}}if(H){return a5.ThrowError(303)}}else{if(y!=="object"||Object.prototype.toString.call(B)==="[object Array]"){return a5.ThrowError(304)}}}}for(G=0,D=x.length;G<D;G++){var p=x[G],A=[];for(var F=1,E=p.length;F<E;F++){A.push(p[F])}x[G]=[p[0],A];v[p[0].className()]=A}if(!o){if(!u){u=function(){}}u._a5_attributes=v;return u}v.wrappedMethod=u;var z=function(){var M,I,K,U=[],Q=this,M,O=0;if(u){for(var I in z){u[I]=z[I]}}K=z.caller;do{if(K.getClassInstance!==undefined){M=K}else{K=K.caller}}while(K!==null&&!M);for(var N=0,L=x.length;N<L;N++){var T=x[N][0],S=T.instance(true),R=x[N][1];U.push({cls:S,props:R})}var P=function(X,W,V){J(O,X,W,V)},J=function(W,ab,ad,X){if(ab){if(Object.prototype.toString.call(ab)!=="[object Array]"){ab=[ab]}}else{ab=[]}if(!X){X=ab}if(W>=U.length){if(ad){return ab[0]}else{return t(ab,X)}}var aa,ad=ad||false,Z=false,Y=false,ac=function(ae){P.call(this,ae||ab,ad,X)};var V=new a5.AspectCallArguments(U[W].props,ab,Q,z,ac,M,X);aa=U[W].cls.around(V);if(aa===a5.AspectAttribute.NOT_IMPLEMENTED){aa=U[W].cls[(ad?"after":"before")](V)}else{Z=true}if(aa!==null&&aa!==undefined){switch(aa){case a5.AspectAttribute.NOT_IMPLEMENTED:case a5.Attribute.SUCCESS:aa=ab;break;case a5.Attribute.ASYNC:Y=true;break;case a5.Attribute.RETURN_NULL:aa=null;break;case a5.Attribute.FAILURE:return}}else{return a5.ThrowError(308,null,{prop:I,method:Z?"around":(ad?"after":"before")})}O=W+1;if(!Y){return J(O,aa,ad,ab,X)}},t=function(W,V){O=0;var X=u?u.apply(Q,W):undefined;if(X!==undefined){X=[X]}else{X=W}return J(0,X,true,V)};return J(O,Array.prototype.slice.call(arguments))};z._a5_attributes=v;return z},m=function(){for(i=0,l=a5.Attribute._extenderRef.length;i<l;i++){new a5.Attribute._extenderRef[i]()}},j=function(x,v){var w=v.split("|");for(var t=0,q=w.length;t<q;t++){var o=w[t],p=o.charAt(0)==="*",y=o.charAt(o.length-1)==="*",u=x.indexOf(o),s=u!==-1;if(s){return true}if(p&&x.indexOf(o.substr(1))===0){return true}if(y&&x.indexOf(o.substr(0,o.length-1))>-1){return true}}return false},k=function(E,q){var s=E.getMethods(),C=Array.prototype.slice;for(var z=0,t=s.length;z<t;z++){var D=s[z],o=E[D],r=[];for(var x=0,u=q.length;x<u;x++){var B=C.call(q[x]);if(B.length>1){var y=B[B.length-1],p=false,w=true,v=y.include,A=y.exclude;if(v!==undefined){p=true;if(typeof v==="object"){w=D.match(v).length>0}else{w=j(D,v)}}if(A!==undefined){p=true;if(typeof A==="object"){w=D.match(A)}else{w=j(D,A)}}if(p){B.pop()}if(w){r.push(B)}}else{r.push(B)}}if(r.length){r.push(o);E[D]=a5.core.attributes.createAttribute(E,r);a5.core.reflection.setReflection(E.constructor,E,D,E[D])}}};return{createAttribute:n,applyClassAttribs:k}});a5.SetNamespace("a5.core.classBuilder",true,function(){var D=[],v=false,z=[],n=[],o,m="_a5_constructFromCreate",s="_a5_baseConstruct",k="_a5_interfaceTest",x={},C=function(F,E){var G,H;if(typeof F==="string"){G=a5.GetNamespace(F);if(G===null){return a5.ThrowError(207,null,{className:F})}}else{G=F}if(typeof G!=="function"){return a5.ThrowError(207,null,{className:F})}return new G(m,E)},q=function(G,J,K){var I,F,H=G.replace(/\./g,"_");if(x[H]){var E=x[H];for(var I=0,F=E.length;I<F;I++){if(!E[I][J]){E[I][J]=K}}}if(x[H+"_"+J]){var E=x[H+"_"+J];for(I=0,F=E.length;I<F;I++){if(!E[I][J]){E[I][J]=K}}delete x[H+"_"+J]}},A=function(E,H,J,F,G,I){if(I){H.Properties=function(K){J.constructor._a5_protoProps=K}}H.Attributes=function(){return a5.core.attributes.createAttribute.call(J,H,arguments)};J.Override={};J.Final={};E.call(H,J,F,G);a5.core.mixins.prepareMixins(J);u(J);delete H.Attributes;if(I){delete H.Properties}delete J.Final;delete J.Override;for(o in J){if(({}).hasOwnProperty.call(J,o)&&typeof J[o]==="function"&&(G._a5_namespace==="a5.Object"||a5.core.classProxyObj.instance[o]===undefined)){if(o===J.className()){J.constructor._a5_instanceConst=J[o];a5.core.reflection.setReflection(G,J,o,J.constructor._a5_instanceConst);delete J[o]}else{a5.core.reflection.setReflection(G,J,o)}}}},u=function(G){var H=G.superclass(),E=G.constructor._a5_mixedMethods;if(!H){H={}}for(o in G){if(G.hasOwnProperty(o)&&typeof G[o]==="function"){if(o!=="Final"&&o!=="Override"&&o!=="constructor"&&o!=="prototype"&&o!=="dealloc"&&o!=="_a5_initialized"){if(H[o]&&H[o].toString().indexOf("[native code]")===-1){if(H[o].Final==true){return a5.ThrowError(201,null,{prop:o,namespace:G.namespace()})}return a5.ThrowError(200,null,{prop:o,namespace:G.namespace()})}else{var F=E[o];if(E[o]!==undefined&&F!==G[o]){return a5.ThrowError(220,null,{prop:o,namespace:G.namespace()})}}}}}G.constructor._a5_superMethods={};for(o in G.Override){if(H[o]===undefined&&E[o]===undefined){return a5.ThrowError(202,null,{prop:o,namespace:G.namespace()})}if(H[o]&&H[o].Final!==undefined&&H[o].Final===true||E[o]&&E[o].Final!==undefined&&E[o].Final===true){return a5.ThrowError(203,null,{prop:o,namespace:G.namespace()})}G[o]=G.Override[o];G.constructor._a5_superMethods[o]=(function(I){return function(){var J=[].slice.call(arguments,1),K=this;return function(){return I.apply(K,J)}}})(H[o])}for(o in G.Final){G[o]=G.Final[o];G[o].Final=true}},B=function(I){var ab,O,E,J,H,R,L,F,P=null,K=false,Z=false,M=false,V=false,U=false,Q=function(){pkgObj={pkg:I,imports:y(ab,I),clsName:O,cls:E,base:J,attribs:P,type:H,proto:R,implement:L,mixins:F,staticMethods:K,isInterface:M,isMixin:Z,enumDeclaration:V,isProto:U},validationResult=a5.core.verifiers.validateClassDependencies(J,pkgObj.imports,F,L,M,Z);if(validationResult===true){j(pkgObj)}else{D.push({pkg:pkgObj,reason:validationResult.reason,reasonNM:validationResult.reasonNM})}Q=N=aa=X=ac=G=W=T=ad=Y=S=null},N=function(){ab=Array.prototype.slice.call(arguments);return{Prototype:T,Static:ac,Mixin:ad,Mix:Y,Extends:aa,Implements:X,Interface:G,Class:W}},aa=function(ae){J=ae;return{Prototype:T,Static:ac,Import:N,Mix:Y,Implements:X,Interface:G,Class:W}},Y=function(){F=Array.prototype.slice.call(arguments);return{Prototype:T,Static:ac,Extends:aa,Implements:X,Interface:G,Class:W}},X=function(ae){L=Array.prototype.slice.call(arguments);return{Prototype:T,Static:ac,Mix:Y,Import:N,Extends:aa,Class:W}},ac=function(ae,af){if(typeof ae==="string"){O=ae;K=af;Q()}else{K=ae;return{Prototype:T,Implements:X,Mix:Y,Mixin:ad,Import:N,Extends:aa,Class:W}}},G=function(af,ae){O=af;E=ae;M=true;Q()},ad=function(){Z=true;var af=Array.prototype.slice.call(arguments);O=af[0];for(var ag=1,ae=af.length;ag<ae;ag++){switch(typeof af[ag]){case"string":H=af[ag];break;case"object":if(Object.prototype.toString.call(af[ag])==="[object Array]"){if(!P){P=[]}P.push(af[ag])}break;case"function":E=af[ag];break}}Q()},S=function(ae,af){O=ae;V=af;Q()},W=function(){var af=Array.prototype.slice.call(arguments);O=af[0];for(var ag=1,ae=af.length;ag<ae;ag++){switch(typeof af[ag]){case"string":H=af[ag];break;case"object":if(Object.prototype.toString.call(af[ag])==="[object Array]"){if(!P){P=[]}P.push(af[ag])}break;case"function":E=af[ag];break}}Q()},T=function(){U=true;var af=Array.prototype.slice.call(arguments);O=af[0];for(var ag=1,ae=af.length;ag<ae;ag++){switch(typeof af[ag]){case"string":H=af[ag];break;case"object":if(Object.prototype.toString.call(af[ag])==="[object Array]"){if(!P){P=[]}P.push(af[ag])}break;case"function":R=af[ag];break}}Q()};a5.SetNamespace(I);return{Enum:S,Static:ac,Import:N,Extends:aa,Mixin:ad,Mix:Y,Implements:X,Class:W,Prototype:T,Interface:G}},w=function(L,F){if(!this._a5_initialized){if(this.constructor.isInterface()){return a5.ThrowError(208,null,{nm:ref.namespace()})}if(this.constructor.isAbstract()){return a5.ThrowError(216,null,{nm:this.constructor.namespace()})}if(this.constructor.isSingleton()&&this.constructor._a5_instance!==null){return a5.ThrowError(217,null,{nm:this.constructor.namespace()})}var N=this,E=this,H=L||[],O=[],J,I,G,K;this._a5_initialized=true;this._a5_instanceUID=this.namespace().replace(/\./g,"_")+"__"+this.constructor.instanceCount();if(this.instanceCount()===0){this.constructor._a5_instance=this}this.constructor._instanceCount++;var N=this,E=this,H=L||[],O=[],J,I,G,K;(function(P){P.Super=function(){if(!P.constructor._a5_superclass.className){return a5.ThrowError(210)}var R=P.constructor._a5_superclass.prototype.constructor._a5_instanceConst;if(R){R.apply(P,arguments)}else{a5.ThrowError(211,null,{nm:P.constructor._a5_superclass.className()})}};for(var Q in P.constructor._a5_superMethods){P.Super[Q]=P.constructor._a5_superMethods[Q].call(P)}})(this);if(typeof this.constructor._a5_instanceConst!=="function"){return a5.ThrowError(218,null,{clsName:this.className()})}while(E!==null){var M=E.constructor;if(M._a5_attribs){a5.core.attributes.applyClassAttribs(this,M._a5_attribs)}if(M._a5_protoProps!==undefined){O.unshift(M._a5_protoProps)}E=M.superclass&&M.superclass().constructor.namespace?M.superclass():null}a5.core.mixins.initializeMixins(this);for(I=0,G=O.length;I<G;I++){O[I].call(this)}if(L==m){this.constructor._a5_instanceConst.apply(this,F)}else{this.constructor._a5_instanceConst.apply(this,arguments)}a5.core.mixins.mixinsReady(this)}},t=function(P,K,S,G,N,W,Z,E,R){if(N){if(K&&!K.isInterface()){return a5.ThrowError('Interface "'+P+'" cannot extend "'+K.namespace()+'", base class is not an interface.')}K=null}var F=function(){},L=W===false||false,aa=false,O=false,V=null,U=P.lastIndexOf("."),H=U>-1?P.substring(0,U):"",Q=U>-1?P.substring(U+1):P,J,M,I,ab,Y,T;if(!K||K===undefined){K=(P=="a5.Object"?F:a5.Object)}M=function(ad,ae){var ac=this;if(this.constructor._a5_clsDef){A(this.constructor._a5_clsDef,this,this,this.constructor.imports(),this.constructor)}if(ad!==k&&ad!==s){w.apply(this,arguments)}};if(G){J=G.split(/[ |]/);for(Y=0,T=J.length;Y<T;Y++){if(J[Y]=="final"){L=true}else{if(J[Y]=="singleton"){aa=true}else{if(J[Y]=="abstract"){O=true}}}}}if(a5.core.verifiers.checkNamespaceValid(P)){if(!K.isFinal||(K.isFinal()!=true)){if(K===Error){var X={};X.prototype=new K();M.prototype=X;X=null}else{M.prototype=new K(s)}V=K}else{return a5.ThrowError("Cannot extend "+K.namespace()+", class marked as final.")}}else{return a5.ThrowError("Cannot create new class in namespace "+P+", definition already exists.")}I=M.prototype;ab=I.constructor=M;if(K.prototype.constructor._extenderRef){K.prototype.constructor._extenderRef.push(M)}ab._a5_superclass=V;ab._a5_pkg=H;ab._a5_clsDef=S;ab._a5_clsName=Q;ab._a5_namespace=P;ab._a5_imports=Z;ab._a5_isFinal=L;ab._a5_isAbstract=O;ab._a5_isSingleton=aa;ab._a5_isInterface=N;ab._a5_isPrototype=W||false;ab._a5_attribs=R;ab._mixinRef=K.prototype.constructor._mixinRef?K.prototype.constructor._mixinRef.slice(0):[];ab._implementsRef=K.prototype.constructor._implementsRef?K.prototype.constructor._implementsRef.slice(0):[];ab._a5_mixedMethods={};ab._a5_instance=null;ab._instanceCount=0;ab._extenderRef=[];I._a5_initialized=false;for(o in a5.core.classProxyObj.construct){ab[o]=a5.core.classProxyObj.construct[o]}if(K.namespace===undefined){for(o in a5.core.classProxyObj.instance){I[o]=a5.core.classProxyObj.instance[o]}}if(E){a5.core.mixins.applyMixins(I,E,Z)}return a5.SetNamespace(P,M)},p=function(){var E=false,H,F;for(H=0;H<D.length;H++){var I=D[H].pkg,G=a5.core.verifiers.validateClassDependencies(I.base,I.imports,I.mixins,I.implement);if(G===true){j(I,true);D.splice(H,1);H--;E=true}else{D[H].reason=G.reason;D[H].reasonNM=G.reasonNM}}if(E){p()}},r=function(G){var F=G.obj,E=G.pkgObj;A(E.proto,F,F.prototype,F.imports(),F,true)},j=function(K,G){var E=(typeof K.base==="function")?K.base:a5.GetNamespace(K.base,K.imports),H=t(K.pkg+"."+K.clsName,E,K.cls,K.type,K.isInterface,K.isProto,K.imports,K.mixins,K.attribs),L=G||false,O=true,I,F;if(K.staticMethods){K.staticMethods(H,K.imports)}if(K.proto&&v){z.push({obj:H,pkgObj:K});if(K.implement){n.push({pkgObj:K,obj:H})}}else{if(K.proto){r({obj:H,pkgObj:K})}if(K.implement){O=a5.core.verifiers.validateImplementation(K,H)}}if(!O){return}if(K.enumDeclaration){var J=0,M=[];K.enumDeclaration({startIndex:function(P){J=P},addValue:function(P){M.push(P)}});for(I=0,F=M.length;I<F;I++){H[M[I]]=J++}H.addValue=function(P){if(H[P]===undefined){H[P]=J++}};H.getValue=function(P){for(o in H){if(H[o]===P){return o}}return null}}if(K.isInterface){H.interfaceVals={};if(K.base!==null&&K.base!==undefined){var N=a5.GetNamespace(K.base,K.imports);if(N.isInterface()){for(o in N.interfaceVals){if(H.interfaceVals[o]===undefined){H.interfaceVals[o]=N.interfaceVals[o]}}}else{a5.ThrowError(204,null,{objNM:H.namespace(),clsNM:N.namespace()})}}K.cls.call(H.interfaceVals,H.interfaceVals)}if(K.isMixin){H._mixinDef={Properties:function(P){H.prototype.constructor._a5_mixinProps=P},MustExtend:function(){H.prototype.constructor._a5_mixinMustExtend=arguments},MustMix:function(){H.prototype.constructor._a5_mixinMustMix=arguments}};K.cls.call(H._mixinDef,H._mixinDef,K.imports,H);if(typeof H._mixinDef[H.className()]==="function"){H._a5_instanceConst=H._mixinDef[H.className()];delete H._mixinDef[H.className()]}else{a5.ThrowError(205,null,{nm:H.namespace()})}delete H._mixinDef.Properties;delete H._mixinDef.Contract;delete H._mixinDef.MustExtend;delete H._mixinDef.MustMix}q(K.pkg,K.clsName,H);if(!L){p()}},y=function(N,O,Q){var I={},M,G,P,O,F,L,E,R,K;if(N==undefined){N=[]}N.push(O+".*");for(M=0,G=N.length;M<G;M++){P=N[M],L=false,E=P.lastIndexOf(".");if(P.charAt(P.length-1)=="*"){L=true}if(L){R=P.substr(0,P.length-2);O=a5.GetNamespace(R,null,true);if(O){for(o in O){K=O[o];if((typeof K==="function"||typeof K==="object")&&I[o]===undefined){I[o]=K}}}var H=R.replace(/\./g,"_");if(!x[H]){x[H]=[]}x[H].push(I)}else{F=E>-1?P.substr(E+1):P;var K=a5.GetNamespace(P,null,true);if(K){if(I[F]===undefined){I[F]=K}}else{var J=R.replace(/\./g,"_")+"_"+F;if(!x[J]){x[J]=[]}x[J].push(I)}}}return I};a5.Create=C;a5.Package=B;a5._a5_verifyPackageQueueEmpty=function(){if(D.length){var G="",F,E;for(F=0,E=D.length;F<E;F++){G+='"'+D[F].pkg.pkg+"."+D[F].pkg.clsName+'", '+D[F].reason+' class missing: "'+D[F].reasonNM+'"'+(D.length>1&&F<D.length-1?", \n":"")}a5.ThrowError(206,null,{classPlural:D.length==1?"class":"classes",clsString:G})}};a5._a5_delayProtoCreation=function(E){v=E};a5._a5_createQueuedPrototypes=function(){for(var F=0,E=z.length;F<E;F++){r(z[F])}z=[];for(F=0,E=n.length;F<E;F++){a5.core.verifiers.validateImplementation(n[F].pkgObj,n[F].obj)}n=[]}});a5.SetNamespace("a5.core.classProxyObj",{construct:{classPackage:function(j){return j?a5.GetNamespace(this._a5_pkg,null,true):this._a5_pkg},className:function(){return this._a5_clsName},namespace:function(){return this._a5_namespace},imports:function(){return this._a5_imports},doesImplement:function(j){return a5.core.verifiers.checkImplements(this,j)},doesExtend:function(j){return a5.core.verifiers.checkExtends(this,j)},doesMix:function(j){return a5.core.verifiers.checkMixes(this,j)},getAttributes:function(){return this._a5_attributes},instance:function(k,j){if(k===true){return this._a5_instance||a5.Create(this,j)}else{return this._a5_instance}},superclass:function(m,j){if(m!==undefined){if(typeof m==="object"&&m.isA5===true){if(typeof j!=="object"){j=[]}if(!this._a5_superclass.className){return a5.ThrowError(210)}var k=this._a5_superclass.prototype.constructor._a5_instanceConst;if(k){k.apply(m,j)}else{a5.ThrowError(211,null,{nm:this._a5_superclass.className()})}}else{a5.ThrowError(212,null,{nm:this.namespace()})}}else{return this._a5_superclass.prototype}},instanceCount:function(){return this._instanceCount},isInterface:function(){return this._a5_isInterface},isFinal:function(){return this._a5_isFinal},isSingleton:function(){return this._a5_isSingleton},isAbstract:function(){return this._a5_isAbstract},isPrototype:function(){return this._a5_isPrototype},isA5ClassDef:function(){return true},isA5:true},instance:{isA5:true,isA5ClassDef:function(){return false},getStatic:function(){return this.constructor},superclass:function(k,j){return this.constructor.superclass(k,j)},getAttributes:function(){return this.constructor.getAttributes()},getAttributeValue:function(j){return this.constructor.getAttributeValue(j)},getMethods:function(k,m){var j=[];for(var n in this){if((k||({}).hasOwnProperty.call(this,n))&&typeof(this[n])==="function"&&a5.core.classProxyObj.instance[n]===undefined&&n.substr(0,4)!=="_a5_"&&(m||n.substr(0,1)!=="_")){j.push(n)}}return j},getProperties:function(k,n){var j=[],m=function(s,t){var p=s;while(p!==null){var r=p.constructor;if(r._a5_protoProps!==undefined){var q={};r._a5_protoProps.call(q);if(q[t]!==undefined){return true}}p=r.superclass&&r.superclass().constructor.namespace?r.superclass():null}return false};for(var o in this){if((k||!m(this,o))&&typeof(this[o])!=="function"&&a5.core.classProxyObj.instance[o]===undefined&&o.substr(0,4)!=="_a5_"&&(n||o.substr(0,1)!=="_")){j.push(o)}}return j},classPackage:function(j){return this.constructor.classPackage(j)},className:function(){return this.constructor.className()},getClass:function(){return this.constructor},namespace:function(){return this.constructor.namespace()},doesImplement:function(j){return this.constructor.doesImplement(j)},doesExtend:function(j){return this.constructor.doesExtend(j)},doesMix:function(j){return this.constructor.doesMix(j)},imports:function(){return this.constructor.imports()},dealloc:function(){},instanceCount:function(){return this.constructor.instanceCount()},isInterface:function(){return this.constructor.isInterface()},isFinal:function(){return this.constructor.isFinal()},isSingleton:function(){return this.constructor.isSingleton()},isAbstract:function(){return this.constructor.isAbstract()},isPrototype:function(){return this.constructor.isAbstract()},instanceUID:function(){return this._a5_instanceUID},destroy:function(){if(this._a5_initialized===true){var o=this,q,m,j,r,n,k;while(o!==null){var p=o.constructor;j=p._mixinRef;if(j&&j.length){for(n=0,k=j.length;n<k;n++){if(j[n]._mixinDef.dealloc!=undefined){j[n]._mixinDef.dealloc.call(this)}}}if(p.namespace){m=p.superclass?p.superclass():null;if(m&&m.dealloc!==undefined&&m.dealloc!==o.dealloc){o.dealloc.call(this)}o=m}else{o=null}}if(this.constructor._a5_instance===this){this.constructor._a5_instance=null}if(this.__proto__){this.__proto__=null}for(r in this){delete this[r]}}}}});a5.SetNamespace("a5.core.verifiers",{namespaceArray:[],validateImplementation:function(s,n){var o,m,j,p,x,t,r,k=function(z,y){for(var A in z){if(z[A]!==y[A]){return false}}return true};for(o=0,m=s.implement.length;o<m;o++){p=s.implement[o];try{x=new n("_a5_interfaceTest");x.Override={};x.Final={};x.Attributes=function(){var A=Array.prototype.slice.call(arguments);var C=A.pop();for(var B=0,z=A.length;B<z;B++){var y=A[B][0];if(y==="Contract"||y==="ContractAttribute"||y===a5.ContractAttribute){C.attributes=A[B]}}return C};t=a5.GetNamespace(p,n.imports());if(n._a5_clsDef){n._a5_clsDef.call(x,x,n.imports(),n)}}catch(q){throw q;return false}if(!t.isInterface()){return a5.ThrowError(213,null,{implNM:t.namespace(),objNM:n.namespace()})}for(j in t.interfaceVals){r=x[j]!==undefined;var w=t.interfaceVals[j],u=x[j];if(r&&typeof w==="object"&&u.attributes&&(u.attributes[0]==="Contract"||u.attributes[0]==="ContractAttribute"||u.attributes[0]===a5.ContractAttribute)){var v=true;for(var o=0,m=w.length;o<m;o++){v=v&&u.attributes.length>=(o+1)?k(w[o],u.attributes[o+1]):false}if(!v){return a5.ThrowError(601,null,{intNM:t.namespace(),implNM:n.namespace(),method:j})}}else{if(!r||(r&&typeof t.interfaceVals[j]!==typeof x[j])){return a5.ThrowError(214,null,{implNM:t.namespace(),objNM:n.namespace()})}}}n._implementsRef.push(t);x.destroy()}return true},checkNamespaceValid:function(m){for(var k=0,j=this.namespaceArray.length;k<j;k++){if(this.namespaceArray[k]==m){return false}}this.namespaceArray.push(m);return true},checkImplements:function(n,s){if(typeof s==="string"){s=a5.GetNamespace(s)}var r=n._implementsRef,q,p,o,m;while(r){for(q=0,m=r.length;q<m;q++){if(r[q]===s){return true}}r=n.superclass()?n.superclass().getStatic()._implementsRef:null}return false},checkExtends:function(j,n){var m=j._a5_superclass&&j._a5_superclass.prototype.className?j._a5_superclass:null;if(!m){return false}var k=(typeof n==="string")?a5.GetNamespace(n):n;if(!k){return false}while(m){if(m===k){return true}m=m._a5_superclass&&m._a5_superclass.prototype.className?m._a5_superclass:null}return false},checkMixes:function(k,n){if(typeof n==="string"){n=a5.GetNamespace(n)}if(!n){return false}for(var m=0,j=k._mixinRef.length;m<j;m++){if(k._mixinRef[m]===n){return true}}return false},validateClassDependencies:function(n,w,u,k,o,x){var v,s,t,r=null,j,p,y,q;if(n!==undefined){if(typeof n==="function"){r=n}else{r=a5.GetNamespace(n,w)}}v=true;if(n!==undefined&&!r){v=false;s="base";t=n}if(v&&u!==undefined){for(j in u){p=u[j];if(typeof p==="string"){y=a5.GetNamespace(p,w)}if(typeof y!=="function"){v=false;s="mixin";t=p}}}if(v&&k!==undefined){for(j in k){q=k[j];if(typeof q==="string"){y=a5.GetNamespace(q,w)}if(typeof y!=="function"){v=false;s="interface";t=q}}}return v?true:{reason:s,reasonNM:t}}});a5.SetNamespace("a5.core.mixins",{prepareMixins:function(p){var o=p,j=p.constructor._mixinRef,n,m,q,k;if(j.length){for(n=j.length-1,m=-1;n>m;n--){if(j[n]._a5_mixinMustExtend!==undefined){for(q in j[n]._a5_mixinMustExtend){k=j[n]._a5_mixinMustExtend[q];if(!p.doesExtend(a5.GetNamespace(k,p.imports()))){return a5.ThrowError(400,null,{mixinNM:j[n].namespace(),instNM:p.namespace(),clsNM:k.namespace()})}}}}}},initializeMixins:function(p){var o=p,j=p.constructor._mixinRef,n,m,q,k;if(j.length){for(n=j.length-1,m=-1;n>m;n--){if(j[n]._a5_mixinProps!==undefined){j[n]._a5_mixinProps.call(o)}}for(n=0,m=j.length;n<m;n++){j[n]._a5_instanceConst.call(o)}}},mixinsReady:function(o){var j=o.constructor._mixinRef,n,m,p,k;if(j.length){for(n=j.length-1,m=-1;n>m;n--){if(j[n]._a5_mixinMustMix!==undefined){for(p in j[n]._a5_mixinMustMix){k=j[n]._a5_mixinMustMix[p];if(!inst.doesMix(a5.GetNamespace(k))){return a5.ThrowError(401,null,{nm:j[n].namespace(),cls:k})}}}if(typeof j[n]._mixinDef.mixinReady==="function"){j[n]._mixinDef.mixinReady.call(o)}}}},applyMixins:function(v,u,n,t){var o={},u=typeof u==="string"?[u]:u,w=[],s,r,q,p,x;for(s=0,p=u.length;s<p;s++){x=a5.GetNamespace(u[s],typeof n==="function"?n():n);if(!x){return a5.ThrowError(404,null,{mixin:u[s]})}w.push(x);for(r=0,q=v.constructor._mixinRef.length;r<q;r++){if(v.constructor._mixinRef[r]===x){return a5.ThrowError(402,null,{nm:x.namespace()})}}for(var m in x._mixinDef){if(m!=="dealloc"&&m!=="Properties"&&m!=="mixinReady"&&m!=="MustExtend"&&m!=="Contract"){if(o[m]===undefined){if(t===undefined){v.constructor._a5_mixedMethods[m]=x._mixinDef[m]}v[m]=x._mixinDef[m];o[m]="mixed"}else{return a5.ThrowError(403,null,{method:m})}}}if(t){a5.core.mixins.initializeMixins(t,w,t)}else{v.constructor._mixinRef.push(x)}}}});a5.SetNamespace("a5.core.errorHandling",true,function(){var k=null;this.ThrowError=function(m,p,o){var n=typeof m,q;if(n==="string"){q=m}else{if(n==="number"){if(a5.GetNamespace("a5.ErrorDefinitions",null,true)){var q=a5.ErrorDefinitions[m];if(!q){q="Invalid error id "+m+" thrown: error not defined."}}else{q="Error id "+m+" thrown. Include a5.ErrorDefinitions for verbose information."}m=a5.Create(p||a5.Error,[q,a5.Error.FORCE_CAST_ERROR])}}if(q){m=a5.Create(p||a5.Error,[(o?j(q,o):q),a5.Error.FORCE_CAST_ERROR])}k=m;throw m};this._a5_getThrownError=function(){var m=k;k=null;return m};var j=function(n,m){for(var o in m){n=n.replace(new RegExp("{"+o+"}","g"),m[o])}return n}});a5.ThrowError=a5.core.errorHandling.ThrowError;a5._a5_getThrownError=a5.core.errorHandling._a5_getThrownError;a5.Package("a5").Prototype("Object",function(k,j){k.Object=function(){};k.mixins=function(m){if(m!==undefined){return a5.GetNamespace(m,this.imports())}else{return this.constructor._a5_mixedMethods}}});a5.Package("a5").Prototype("Attribute","singleton",function(m,j,k){m.Attribute=function(){}});a5.Package("a5").Extends("Attribute").Prototype("AspectAttribute",function(m,k,j){j.RETURN_NULL="_a5_aspectReturnsNull";j.SUCCESS="_a5_aspectSuccess";j.ASYNC="_a5_aspectAsync";j.FAILURE="_a5_aspectFailure";j.NOT_IMPLEMENTED="_a5_notImplemented";m.AspectAttribute=function(){m.superclass(this)};m.before=function(q,n,o,s,r,p){return j.NOT_IMPLEMENTED};m.after=function(r,o,p,t,s,q,n){return j.NOT_IMPLEMENTED};m.around=function(){return j.NOT_IMPLEMENTED}});a5.Package("a5").Class("AspectCallArguments",function(s,r,p){var j,n,m,q,t,o,k;s.AspectCallArguments=function(y,v,w,A,z,x,u){j=y;n=v;m=w;q=A;t=z;o=x;k=u};s.rules=function(){return j};s.args=function(){return n};s.scope=function(){return m};s.method=function(){return q};s.callback=function(){return t};s.callOriginator=function(){return o};s.beforeArgs=function(){return k}});a5.Package("a5").Extends("AspectAttribute").Class("ContractAttribute",function(k,j,o){k.ContractAttribute=function(){k.superclass(this)};k.Override.before=function(r){var s=null,t=false,q=function(u){u.message='Contract type failure on method "'+r.method().getName()+'" '+u.message;return u};if(r.rules().length>1){for(i=0,l=r.rules().length;i<l;i++){s=m(r.rules()[i],r.args());if(s instanceof a5.ContractException){k.throwError(q(s));return a5.AspectAttribute.FAILURE}if(s!==false){t=true;s.overloadID=i;break}}}else{t=true;s=m(r.rules()[0],r.args(),true);if(s instanceof a5.ContractException){k.throwError(q(s));return a5.AspectAttribute.FAILURE}}if(!t||s===false){k.throwError(q(new a5.ContractException("no matching overload found")));return a5.AspectAttribute.FAILURE}else{return s}};var m=function(v,r){var u={},t=0,q,w,s;for(w in v){s=v[w];q=p((t<r.length?r[t]:undefined),s,t);if(q instanceof a5.ContractException){return q}u[w]=q;t++}if(r.length>t){return false}if(r.length===0){if(t===0){return u}return false}return u},p=function(r,v,w){var u="type",s=false,x=null,t,q;if(v.indexOf("=")!=-1){t=v.split("=");v=t[0];s=true;x=t[1]}else{if(s){return new a5.ContractException("for argument "+w+", required values cannot be defined after optional values")}}if(v.indexOf(".")!==-1){u="class"}if(v==="array"){u="array"}if(v==="object"){u="object"}if(u!=="class"){v=v.toLowerCase()}if(r===undefined){if(s){r=n(v,u,x,w)}else{return new a5.ContractException("for argument "+w+', missing required argument of type "'+v+'"')}}if(r!==undefined&&r!==null){switch(u){case"class":q=a5.GetNamespace(v);if(q.isInterface()){if(!(r.doesImplement(q))){return new a5.ContractException("for argument "+w+", must implement interface "+v)}}else{if(!(r instanceof q)){return new a5.ContractException("for argument "+w+", must be an instance of type "+v)}}break;case"type":if(r!==null&&typeof r!==v){return new a5.ContractException("for argument "+w+", must be of type "+v)}break;case"array":if(Object.prototype.toString.call(r)!=="[object Array]"){return new a5.ContractException("for argument "+w+", must be an array")}break;case"object":if(r._a5_initialized!==undefined||typeof r!=="object"||r instanceof Array){return new a5.ContractException("for argument "+w+", must be a generic object")}break}}return r},n=function(r,q,w,s){var v,u=false;if(r==="string"){var t=w.charAt(0);if(t===w.charAt(w.length-1)){if(t==='"'||t==="'"){v=w.substr(1,w.length-2)}else{u=true}}else{u=true}}else{if(r==="number"){if(!isNaN(w)){v=parseInt(w)}else{u=true}}else{if(q==="class"){if(w==="null"){v=null}else{u=true}}else{if(r==="boolean"||r==="array"||r==="function"||r==="object"){switch(w){case"{}":if(r==="object"){v={}}else{u=true}break;case"[]":if(r==="array"){v=[]}else{u=true}break;case"null":v=null;break;case"true":if(r==="boolean"){v=true}else{u=true}break;case"false":if(r==="boolean"){v=false}else{u=true}break;default:u=true}}else{u=true}}}}if(u){return new a5.ContractException("for argument "+s+', invalid default value for data type "'+r+'"')}else{return v}}});a5.Package("a5").Extends("AspectAttribute").Class("PropertyMutatorAttribute",function(j){j.PropertyMutatorAttribute=function(){j.superclass(this)};j.Override.before=function(n){if(n.args().length){var k=n.rules()[0].validate,m=false;if(k){if(k.indexOf(".")!==-1){m=true;var k=a5.GetNamespace(k);if(!k){return a5.AspectAttribute.FAILURE}}var p=m?(n.args()[0] instanceof k):(typeof n.args()[0]===k);if(!p){return a5.AspectAttribute.FAILURE}}n.scope()[n.rules()[0].property]=n.args()[0];return a5.AspectAttribute.SUCCESS}var o=n.scope()[n.rules()[0].property]||null;return o===null||o===undefined?a5.AspectAttribute.RETURN_NULL:o};j.Override.after=function(k){if(k.beforeArgs().length){return k.scope()}else{return a5.AspectAttribute.SUCCESS}}});a5.Package("a5").Static(function(j){j.DESTROYED="Destroyed"}).Prototype("Event",function(j){this.Properties(function(){this._a5_type=null;this._a5_data=null;this._a5_target=null;this._a5_currentTarget=null;this._a5_phase=1;this._a5_bubbles=false;this._a5_canceled=false;this._a5_cancelPending=false;this._a5_shouldRetain=false});j.Event=function(m,k,n){this._a5_type=m;this._a5_data=n||null;this._a5_bubbles=k!==false};j.cancel=function(k){if(k===true){this._a5_cancelPending=true}else{this._a5_canceled=true}};j.target=function(){return this._a5_target};j.currentTarget=function(){return this._a5_currentTarget};j.type=function(){return this._a5_type};j.data=function(){return this._a5_data};j.phase=function(){return this._a5_phase};j.bubbles=function(){return this._a5_bubbles};j.shouldRetain=function(k){if(typeof k==="boolean"){this._a5_shouldRetain=k;return this}return this._a5_shouldRetain};j.dealloc=function(){this._a5_target=this._a5_currentTarget=null}});a5.Package("a5").Static("EventPhase",function(j){j.CAPTURING=1;j.AT_TARGET=2;j.BUBBLING=3});a5.Package("a5").Extends(Error).Prototype("Error",function(k,j,m){m.FORCE_CAST_ERROR="_a5_forceCastError";this.Properties(function(){this.stack=[];this.message="";this.name=this.type=this.className()});k.Error=function(o,n){if(typeof o==="string"){this.message=o}else{n=o}if(n instanceof m){if(n.stack){this.stack=n.stack.split("\n")}this.line=n.lineNumber;this.url=n.fileName;if(n.message&&this.message===""){this.message=n.message}}};k.Override.toString=function(){return this.type+": "+this.message}});a5.Package("a5").Extends("Error").Prototype("AssertException",function(j){j.AssertException=function(){j.superclass(this,arguments);this.type="AssertException"}});a5.Package("a5").Extends("Error").Prototype("ContractException",function(j){j.ContractException=function(){j.superclass(this,arguments);this.type="ContractException"}});a5.Package("a5").Static(function(j){j.ADD="eventDispatcherAdd";j.REMOVE="eventDispatcherRemove"}).Prototype("EventDispatcher","abstract",function(m,j,k){this.Properties(function(){this._a5_autoPurge=false;this._a5_listeners={}});m.EventDispatcher=function(){};m.autoPurge=function(n){if(typeof n==="boolean"){this._a5_autoPurge=n;return this}return this._a5_autoPurge};m.addEventListener=function(p,q,n,o){this._a5_addEventListener(p,q,n,o)};m.addOneTimeEventListener=function(p,q,n,o){this._a5_addEventListener(p,q,n,o,true)};m.hasEventListener=function(u,n){var t=u.split("|"),v=this.cl(),s,q,p,r,o;for(s=0,q=t.length;s<q;s++){p=this._a5_getListenerArray(t[s]);if(p){for(r=0,o=p.length;r<o;r++){if(p[r].type==t[s]&&(typeof n==="function"?(p[r].method==n):true)){return true}}}}return false};m.removeEventListener=function(x,n,p,y,t){var w=x.split("|"),o=true,v,s,r,u,q;y=y||null;t=t||false;p=p===true;for(v=0,s=w.length;v<s;v++){r=this._a5_getListenerArray(w[v]);if(r){for(u=0,q=r.length;u<q;u++){if(r[u].method===n&&r[u].type===w[v]&&r[u].useCapture===p&&r[u].isOneTime===t){r.splice(u,1);q=r.length}}this.eListenersChange({type:w.length>1?w:w[0],method:n,useCapture:p,changeType:k.REMOVE})}}};m.removeAllListeners=function(){if(this._a5_listeners){this._a5_listeners={}}};m.getTotalListeners=function(o){if(typeof o==="string"){var n=this._a5_getListenerArray(o);if(n){return n.length}else{return 0}}else{var p=0;for(var q in this._a5_listeners){p+=this._a5_listeners[q].length}return p}};m.dispatchEvent=function(o,p,n){var q=this._a5_createEvent(o,p,n);q._a5_phase=a5.EventPhase.AT_TARGET;this._a5_dispatchEvent(q);if(!q.shouldRetain()){q.destroy()}q=null};m.eListenersChange=function(n){};m._a5_addEventListener=function(x,n,y,z,A){var B=z||null,w=x.split("|"),t=A||false,p=y===true,o=true,v,s,r,u,q;if(w.length!=0&&n!=undefined){for(v=0,s=w.length;v<s;v++){r=this._a5_getListenerArray(w[v],true);for(u=0,q=r.length;u<q;u++){if(r[u].method===n&&r[u].type===w[v]&&r[u].useCapture===p&&r[u].scope===B&&r[u].isOneTime===t){o=false;break}}if(o){r.push({type:w[v],method:n,scope:B,useCapture:p===true,isOneTime:t})}}this.eListenersChange({type:w.length>1?w:w[0],method:n,changeType:k.ADD})}else{throw"invalid listener: type- "+x+", method- "+n}};m._a5_createEvent=function(o,p,n){var q=(typeof o==="string")?new a5.Event(o,n):o;if(q instanceof a5.Event||q.doesExtend&&q.doesExtend(a5.Error)){q._a5_target=this;if(p){q._a5_data=p}return q}throw"Invalid event type."};m._a5_dispatchEvent=function(s){s._a5_currentTarget=this;if(this._a5_listeners){var t=this._a5_getListenerArray(s.type()),p,n,o,r,q;if(t){for(p=0,n=t.length;p<n;p++){o=t?t[p]:null;if(s._a5_canceled||!o){return}r=(s.phase()===a5.EventPhase.CAPTURING&&o.useCapture)||(s.phase()!==a5.EventPhase.CAPTURING&&!o.useCapture),q=typeof o.method==="function"&&(o.scope&&o.scope.namespace?o.scope._a5_initialized:true);if(r&&q){o.method.call(o.scope,s)}if(o.isOneTime===true||(!q&&this._a5_autoPurge)){t.splice(p,1);p--;n--}}}}};m._a5_getListenerArray=function(o,n){if(this._a5_listeners[o]===undefined){if(n===true){this._a5_listeners[o]=[];return this._a5_listeners[o]}return null}return this._a5_listeners[o]};m.dealloc=function(){this.dispatchEvent(new a5.Event(a5.Event.DESTROYED));this.removeAllListeners();this._a5_listeners=null}});a5.SetNamespace("a5.ErrorDefinitions",{100:'invalid namespace "{namespace}", namespaces must contain only letters, numbers, or periods.',101:"TrackWindowStrays must be called prior to GetWindowStrays.",200:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in superclass.',201:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',202:'Invalid attempt to override method "{prop}" in class "{namespace}", method not defined in superclass.',203:'Invalid attempt to override method "{prop}" in class "{namespace}", method marked as Final in superclass.',204:'Interface "{objNM}" cannot extend the non interface class "{clsNM}"',205:'Mixin "{nm}" doesn not specify a constructor.',206:"Class definitions not found for the following expected {classPlural}: \n {clsString}",207:"Error creating new class instance: cannot find object {className}.",208:"Cannot instantiate class {nm} , interfaces must be associated by the Implements directive.",209:"Error creating class instance {nm} ({errorStr})",210:"Superclass called on an object without a superclass.",211:'Constructor not defined on class "{nm}"',212:'invalid scope argument passed to superclass constructor on class "{nm}".',213:'Cannot implement "{implNM}" on class "{objNM}", class is not an interface.',214:'Invalid implementation of interface "{implNM}" , on class "{objNM}".',215:'Destroy called on core object "{nm}"',216:'Cannot directly instantiate class "{nm}", class marked as abstract.',217:'Cannot create new instance of class "{nm}", class marked as singleton already exists.',218:'Constructor not defined on class "{clsName}"',219:'Class "{currClass}" requires "{checkedClass}"',220:'Invalid attempt to define new method "{prop}" in class "{namespace}", without calling override, method exists in mixin.',300:'Invalid attribute definition: "Attributes" call must take a function as its last parameter.',301:"Invalid attribute definition: No attributes were defined.",302:"Attribute error: Attributes call accepts only arrays as attribute annotations.",303:"Attribute error: First parameter must be a reference to a class that extends a5.Attribute.",304:"Attribute error: invalid parameter specified for Attribute, params must be key/value pair objects.",305:"Attribute error: no parameters passed to Attribute call.",308:'Error processing attribute "{prop}", "{method}" must return a value.',400:'Mixin "{mixinNM}" requires mixing object "{instNM}" to extend class "{clsNM}" .',401:'Mixin "{nm}" requires owner class to mix "{cls}".',402:'Mixin "{nm}" already mixed into ancestor chain.',403:'Invalid mixin: Method "{method}" defined by more than one specified mixin.',404:'Invalid mixin: Mixin "{mixin}" does not exist.',601:"Invalid implementation of Contract on interace {intNM} in class {implNM} for method {method}."})})(this);